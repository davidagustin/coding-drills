import type { Problem } from '../types';

/**
 * Python problems for coding drills
 * Covers list methods, string methods, dictionary methods, set methods, and built-in functions
 */

export const pythonProblems: Problem[] = [
  // ============================================================
  // LIST METHODS - List Comprehensions (15+ problems)
  // ============================================================
  {
    id: 'py-list-001',
    category: 'list',
    difficulty: 'easy',
    title: 'Double Each Number',
    text: 'Double each number in the list using a list comprehension',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: [2, 4, 6, 8, 10],
    sample: '[x * 2 for x in nums]',
    hints: ['Use a list comprehension with the pattern [expression for item in iterable]'],
    validPatterns: [
      /\[\s*\w+\s*\*\s*2\s+for\s+\w+\s+in\s+nums\s*\]/,
      /\[\s*2\s*\*\s*\w+\s+for\s+\w+\s+in\s+nums\s*\]/,
      /list\s*\(\s*map\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*\*\s*2/,
    ],
    tags: ['list-comprehension', 'basic'],
  },
  {
    id: 'py-list-002',
    category: 'list',
    difficulty: 'easy',
    title: 'Square Each Number',
    text: 'Square each number in the list',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: [1, 4, 9, 16, 25],
    sample: '[x ** 2 for x in nums]',
    hints: ['Use ** for exponentiation in Python'],
    validPatterns: [
      /\[\s*\w+\s*\*\*\s*2\s+for\s+\w+\s+in\s+nums\s*\]/,
      /\[\s*pow\s*\(\s*\w+\s*,\s*2\s*\)\s+for\s+\w+\s+in\s+nums\s*\]/,
      /list\s*\(\s*map\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*\*\*\s*2/,
    ],
    tags: ['list-comprehension', 'math'],
  },
  {
    id: 'py-list-003',
    category: 'list',
    difficulty: 'easy',
    title: 'Filter Even Numbers',
    text: 'Filter the list to only include even numbers',
    setup: 'nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]',
    setupCode: 'nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]',
    expected: [2, 4, 6, 8, 10],
    sample: '[x for x in nums if x % 2 == 0]',
    hints: ['Use a conditional in the list comprehension: [x for x in iterable if condition]'],
    validPatterns: [
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*%\s*2\s*==\s*0\s*\]/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+not\s+\w+\s*%\s*2\s*\]/,
      /list\s*\(\s*filter\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*%\s*2\s*==\s*0/,
    ],
    tags: ['list-comprehension', 'filter'],
  },
  {
    id: 'py-list-004',
    category: 'list',
    difficulty: 'easy',
    title: 'Filter Odd Numbers',
    text: 'Filter the list to only include odd numbers',
    setup: 'nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]',
    setupCode: 'nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]',
    expected: [1, 3, 5, 7, 9],
    sample: '[x for x in nums if x % 2 != 0]',
    hints: ['Odd numbers have a remainder of 1 when divided by 2'],
    validPatterns: [
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*%\s*2\s*!=\s*0\s*\]/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*%\s*2\s*==\s*1\s*\]/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*%\s*2\s*\]/,
      /list\s*\(\s*filter\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*%\s*2/,
    ],
    tags: ['list-comprehension', 'filter'],
  },
  {
    id: 'py-list-005',
    category: 'list',
    difficulty: 'easy',
    title: 'Filter Numbers Greater Than 5',
    text: 'Filter the list to only include numbers greater than 5',
    setup: 'nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]',
    setupCode: 'nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]',
    expected: [6, 7, 8, 9, 10],
    sample: '[x for x in nums if x > 5]',
    hints: ['Use a comparison operator in the condition'],
    validPatterns: [
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*>\s*5\s*\]/,
      /list\s*\(\s*filter\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*>\s*5/,
    ],
    tags: ['list-comprehension', 'filter'],
  },
  {
    id: 'py-list-006',
    category: 'list',
    difficulty: 'medium',
    title: 'Double Even Numbers Only',
    text: 'Double only the even numbers in the list, keeping the result as a list of doubled values',
    setup: 'nums = [1, 2, 3, 4, 5, 6]',
    setupCode: 'nums = [1, 2, 3, 4, 5, 6]',
    expected: [4, 8, 12],
    sample: '[x * 2 for x in nums if x % 2 == 0]',
    hints: ['Combine transformation and filtering in one comprehension'],
    validPatterns: [
      /\[\s*\w+\s*\*\s*2\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*%\s*2\s*==\s*0\s*\]/,
      /\[\s*2\s*\*\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*%\s*2\s*==\s*0\s*\]/,
    ],
    tags: ['list-comprehension', 'filter', 'transform'],
  },
  {
    id: 'py-list-007',
    category: 'list',
    difficulty: 'easy',
    title: 'Convert to Uppercase',
    text: 'Convert each string in the list to uppercase',
    setup: 'words = ["hello", "world", "python"]',
    setupCode: 'words = ["hello", "world", "python"]',
    expected: ['HELLO', 'WORLD', 'PYTHON'],
    sample: '[w.upper() for w in words]',
    hints: ['Use the upper() string method'],
    validPatterns: [
      /\[\s*\w+\.upper\s*\(\s*\)\s+for\s+\w+\s+in\s+words\s*\]/,
      /list\s*\(\s*map\s*\(\s*lambda\s+\w+\s*:\s*\w+\.upper\s*\(\s*\)/,
      /list\s*\(\s*map\s*\(\s*str\.upper/,
    ],
    tags: ['list-comprehension', 'string'],
  },
  {
    id: 'py-list-008',
    category: 'list',
    difficulty: 'medium',
    title: 'Map with Lambda',
    text: 'Use map() and lambda to triple each number in the list',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: [3, 6, 9, 12, 15],
    sample: 'list(map(lambda x: x * 3, nums))',
    hints: ['Use map() with a lambda function and convert to list'],
    validPatterns: [
      /list\s*\(\s*map\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*\*\s*3\s*,\s*nums\s*\)\s*\)/,
      /list\s*\(\s*map\s*\(\s*lambda\s+\w+\s*:\s*3\s*\*\s*\w+\s*,\s*nums\s*\)\s*\)/,
      /\[\s*\w+\s*\*\s*3\s+for\s+\w+\s+in\s+nums\s*\]/,
    ],
    tags: ['map', 'lambda'],
  },
  {
    id: 'py-list-009',
    category: 'list',
    difficulty: 'easy',
    title: 'Sort List Ascending',
    text: 'Sort the list in ascending order (return a new sorted list)',
    setup: 'nums = [5, 2, 8, 1, 9, 3]',
    setupCode: 'nums = [5, 2, 8, 1, 9, 3]',
    expected: [1, 2, 3, 5, 8, 9],
    sample: 'sorted(nums)',
    hints: ['Use the sorted() built-in function'],
    validPatterns: [/sorted\s*\(\s*nums\s*\)/, /sorted\s*\(\s*nums\s*,\s*reverse\s*=\s*False\s*\)/],
    tags: ['sorting', 'built-in'],
  },
  {
    id: 'py-list-010',
    category: 'list',
    difficulty: 'easy',
    title: 'Sort List Descending',
    text: 'Sort the list in descending order (return a new sorted list)',
    setup: 'nums = [5, 2, 8, 1, 9, 3]',
    setupCode: 'nums = [5, 2, 8, 1, 9, 3]',
    expected: [9, 8, 5, 3, 2, 1],
    sample: 'sorted(nums, reverse=True)',
    hints: ['Use the reverse parameter of sorted()'],
    validPatterns: [
      /sorted\s*\(\s*nums\s*,\s*reverse\s*=\s*True\s*\)/,
      /sorted\s*\(\s*nums\s*\)\s*\[\s*::\s*-1\s*\]/,
      /list\s*\(\s*reversed\s*\(\s*sorted\s*\(\s*nums\s*\)\s*\)\s*\)/,
    ],
    tags: ['sorting', 'built-in'],
  },
  {
    id: 'py-list-011',
    category: 'list',
    difficulty: 'easy',
    title: 'Reverse a List',
    text: 'Reverse the order of elements in the list (return a new list)',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: [5, 4, 3, 2, 1],
    sample: 'list(reversed(nums))',
    hints: ['Use reversed() or slice notation [::-1]'],
    validPatterns: [/list\s*\(\s*reversed\s*\(\s*nums\s*\)\s*\)/, /nums\s*\[\s*::\s*-1\s*\]/],
    tags: ['reverse', 'built-in'],
  },
  {
    id: 'py-list-012',
    category: 'list',
    difficulty: 'easy',
    title: 'Sum of List',
    text: 'Calculate the sum of all numbers in the list',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: 15,
    sample: 'sum(nums)',
    hints: ['Use the sum() built-in function'],
    validPatterns: [/sum\s*\(\s*nums\s*\)/],
    tags: ['aggregation', 'built-in'],
  },
  {
    id: 'py-list-013',
    category: 'list',
    difficulty: 'easy',
    title: 'Find Maximum',
    text: 'Find the maximum value in the list',
    setup: 'nums = [3, 7, 2, 9, 4, 1]',
    setupCode: 'nums = [3, 7, 2, 9, 4, 1]',
    expected: 9,
    sample: 'max(nums)',
    hints: ['Use the max() built-in function'],
    validPatterns: [/max\s*\(\s*nums\s*\)/, /sorted\s*\(\s*nums\s*\)\s*\[\s*-1\s*\]/],
    tags: ['aggregation', 'built-in'],
  },
  {
    id: 'py-list-014',
    category: 'list',
    difficulty: 'easy',
    title: 'Find Minimum',
    text: 'Find the minimum value in the list',
    setup: 'nums = [3, 7, 2, 9, 4, 1]',
    setupCode: 'nums = [3, 7, 2, 9, 4, 1]',
    expected: 1,
    sample: 'min(nums)',
    hints: ['Use the min() built-in function'],
    validPatterns: [/min\s*\(\s*nums\s*\)/, /sorted\s*\(\s*nums\s*\)\s*\[\s*0\s*\]/],
    tags: ['aggregation', 'built-in'],
  },
  {
    id: 'py-list-015',
    category: 'list',
    difficulty: 'easy',
    title: 'List Length',
    text: 'Find the length of the list',
    setup: 'nums = [1, 2, 3, 4, 5, 6, 7]',
    setupCode: 'nums = [1, 2, 3, 4, 5, 6, 7]',
    expected: 7,
    sample: 'len(nums)',
    hints: ['Use the len() built-in function'],
    validPatterns: [/len\s*\(\s*nums\s*\)/],
    tags: ['built-in'],
  },
  {
    id: 'py-list-016',
    category: 'list',
    difficulty: 'medium',
    title: 'Check Any Positive',
    text: 'Check if any number in the list is positive',
    setup: 'nums = [-1, -2, 3, -4, -5]',
    setupCode: 'nums = [-1, -2, 3, -4, -5]',
    expected: true,
    sample: 'any(x > 0 for x in nums)',
    hints: ['Use any() with a generator expression'],
    validPatterns: [
      /any\s*\(\s*\w+\s*>\s*0\s+for\s+\w+\s+in\s+nums\s*\)/,
      /any\s*\(\s*\[\s*\w+\s*>\s*0\s+for\s+\w+\s+in\s+nums\s*\]\s*\)/,
    ],
    tags: ['any', 'generator'],
  },
  {
    id: 'py-list-017',
    category: 'list',
    difficulty: 'medium',
    title: 'Check All Positive',
    text: 'Check if all numbers in the list are positive',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: true,
    sample: 'all(x > 0 for x in nums)',
    hints: ['Use all() with a generator expression'],
    validPatterns: [
      /all\s*\(\s*\w+\s*>\s*0\s+for\s+\w+\s+in\s+nums\s*\)/,
      /all\s*\(\s*\[\s*\w+\s*>\s*0\s+for\s+\w+\s+in\s+nums\s*\]\s*\)/,
    ],
    tags: ['all', 'generator'],
  },
  {
    id: 'py-list-018',
    category: 'list',
    difficulty: 'medium',
    title: 'Zip Two Lists',
    text: 'Combine two lists into a list of tuples using zip. The result should be a list containing tuples like [("Alice", 25), ("Bob", 30), ("Charlie", 35)].',
    setup: 'names = ["Alice", "Bob", "Charlie"]\nages = [25, 30, 35]',
    setupCode: 'names = ["Alice", "Bob", "Charlie"]\nages = [25, 30, 35]',
    expected: [
      ['Alice', 25],
      ['Bob', 30],
      ['Charlie', 35],
    ],
    sample: 'list(zip(names, ages))',
    hints: [
      'Use zip() to combine iterables element by element',
      'zip() returns tuples, which are displayed similar to lists in output',
    ],
    validPatterns: [
      /list\s*\(\s*zip\s*\(\s*names\s*,\s*ages\s*\)\s*\)/,
      /\[\s*\(\s*\w+\s*,\s*\w+\s*\)\s+for\s+\w+\s*,\s*\w+\s+in\s+zip\s*\(\s*names\s*,\s*ages\s*\)\s*\]/,
      /\[\s*tuple\s*\(\s*\[\s*\w+\s*,\s*\w+\s*\]\s*\)\s+for\s+\w+\s*,\s*\w+\s+in\s+zip/,
    ],
    tags: ['zip', 'tuple'],
  },
  {
    id: 'py-list-019',
    category: 'list',
    difficulty: 'medium',
    title: 'Enumerate with Index',
    text: 'Create a list of tuples with (index, value) pairs using enumerate. The result should be [(0, "apple"), (1, "banana"), (2, "cherry")].',
    setup: 'fruits = ["apple", "banana", "cherry"]',
    setupCode: 'fruits = ["apple", "banana", "cherry"]',
    expected: [
      [0, 'apple'],
      [1, 'banana'],
      [2, 'cherry'],
    ],
    sample: 'list(enumerate(fruits))',
    hints: [
      'Use enumerate() to get index and value pairs',
      'enumerate() yields tuples of (index, element)',
    ],
    validPatterns: [
      /list\s*\(\s*enumerate\s*\(\s*fruits\s*\)\s*\)/,
      /\[\s*\(\s*i\s*,\s*\w+\s*\)\s+for\s+i\s*,\s*\w+\s+in\s+enumerate\s*\(\s*fruits\s*\)\s*\]/,
      /\[\s*\(\s*\w+\s*,\s*\w+\s*\)\s+for\s+\w+\s*,\s*\w+\s+in\s+enumerate\s*\(\s*fruits\s*\)\s*\]/,
    ],
    tags: ['enumerate'],
  },
  {
    id: 'py-list-020',
    category: 'list',
    difficulty: 'easy',
    title: 'Count Occurrences',
    text: 'Count how many times 3 appears in the list',
    setup: 'nums = [1, 3, 2, 3, 4, 3, 5]',
    setupCode: 'nums = [1, 3, 2, 3, 4, 3, 5]',
    expected: 3,
    sample: 'nums.count(3)',
    hints: ['Use the count() method on lists'],
    validPatterns: [
      /nums\.count\s*\(\s*3\s*\)/,
      /sum\s*\(\s*1\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*==\s*3\s*\)/,
      /len\s*\(\s*\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*==\s*3\s*\]\s*\)/,
    ],
    tags: ['count', 'list-method'],
  },
  {
    id: 'py-list-021',
    category: 'list',
    difficulty: 'easy',
    title: 'Find Index',
    text: 'Find the index of the first occurrence of "banana"',
    setup: 'fruits = ["apple", "banana", "cherry", "banana"]',
    setupCode: 'fruits = ["apple", "banana", "cherry", "banana"]',
    expected: 1,
    sample: 'fruits.index("banana")',
    hints: ['Use the index() method on lists'],
    validPatterns: [/fruits\.index\s*\(\s*["']banana["']\s*\)/],
    tags: ['index', 'list-method'],
  },
  {
    id: 'py-list-022',
    category: 'list',
    difficulty: 'medium',
    title: 'Flatten Nested List',
    text: 'Flatten a 2D list into a 1D list',
    setup: 'matrix = [[1, 2], [3, 4], [5, 6]]',
    setupCode: 'matrix = [[1, 2], [3, 4], [5, 6]]',
    expected: [1, 2, 3, 4, 5, 6],
    sample: '[x for row in matrix for x in row]',
    hints: ['Use a nested list comprehension'],
    validPatterns: [
      /\[\s*\w+\s+for\s+\w+\s+in\s+matrix\s+for\s+\w+\s+in\s+\w+\s*\]/,
      /sum\s*\(\s*matrix\s*,\s*\[\s*\]\s*\)/,
    ],
    tags: ['list-comprehension', 'nested'],
  },
  {
    id: 'py-list-023',
    category: 'list',
    difficulty: 'medium',
    title: 'Sum with Map',
    text: 'Use map and sum to calculate the sum of squared values',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: 55,
    sample: 'sum(map(lambda x: x ** 2, nums))',
    hints: ['Combine map() with sum()'],
    validPatterns: [
      /sum\s*\(\s*map\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*\*\*\s*2\s*,\s*nums\s*\)\s*\)/,
      /sum\s*\(\s*\w+\s*\*\*\s*2\s+for\s+\w+\s+in\s+nums\s*\)/,
      /sum\s*\(\s*\[\s*\w+\s*\*\*\s*2\s+for\s+\w+\s+in\s+nums\s*\]\s*\)/,
    ],
    tags: ['map', 'sum', 'lambda'],
  },

  // ============================================================
  // STRING METHODS (15+ problems)
  // ============================================================
  {
    id: 'py-str-001',
    category: 'string',
    difficulty: 'easy',
    title: 'Split String',
    text: 'Split the sentence into a list of words',
    setup: 'sentence = "hello world python"',
    setupCode: 'sentence = "hello world python"',
    expected: ['hello', 'world', 'python'],
    sample: 'sentence.split()',
    hints: ['Use the split() method on strings'],
    validPatterns: [
      /sentence\.split\s*\(\s*\)/,
      /sentence\.split\s*\(\s*["']\s*["']\s*\)/,
      /sentence\.split\s*\(\s*" "\s*\)/,
    ],
    tags: ['split', 'string-method'],
  },
  {
    id: 'py-str-002',
    category: 'string',
    difficulty: 'easy',
    title: 'Split by Comma',
    text: 'Split the CSV string into a list of values',
    setup: 'csv = "apple,banana,cherry"',
    setupCode: 'csv = "apple,banana,cherry"',
    expected: ['apple', 'banana', 'cherry'],
    sample: 'csv.split(",")',
    hints: ['Pass the delimiter to split()'],
    validPatterns: [/csv\.split\s*\(\s*["'],["']\s*\)/],
    tags: ['split', 'string-method'],
  },
  {
    id: 'py-str-003',
    category: 'string',
    difficulty: 'easy',
    title: 'Join List into String',
    text: 'Join the list of words with spaces',
    setup: 'words = ["hello", "world", "python"]',
    setupCode: 'words = ["hello", "world", "python"]',
    expected: 'hello world python',
    sample: '" ".join(words)',
    hints: ['Use the join() method with a space separator'],
    validPatterns: [/["']\s["']\.join\s*\(\s*words\s*\)/, /" "\.join\s*\(\s*words\s*\)/],
    tags: ['join', 'string-method'],
  },
  {
    id: 'py-str-004',
    category: 'string',
    difficulty: 'easy',
    title: 'Join with Comma',
    text: 'Join the list of items with commas',
    setup: 'items = ["apple", "banana", "cherry"]',
    setupCode: 'items = ["apple", "banana", "cherry"]',
    expected: 'apple,banana,cherry',
    sample: '",".join(items)',
    hints: ['Use comma as the separator in join()'],
    validPatterns: [/["'],["']\.join\s*\(\s*items\s*\)/],
    tags: ['join', 'string-method'],
  },
  {
    id: 'py-str-005',
    category: 'string',
    difficulty: 'easy',
    title: 'Strip Whitespace',
    text: 'Remove leading and trailing whitespace from the string',
    setup: 'text = "  hello world  "',
    setupCode: 'text = "  hello world  "',
    expected: 'hello world',
    sample: 'text.strip()',
    hints: ['Use the strip() method'],
    validPatterns: [/text\.strip\s*\(\s*\)/],
    tags: ['strip', 'string-method'],
  },
  {
    id: 'py-str-006',
    category: 'string',
    difficulty: 'easy',
    title: 'Upper Case',
    text: 'Convert the string to uppercase',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: 'HELLO WORLD',
    sample: 'text.upper()',
    hints: ['Use the upper() method'],
    validPatterns: [/text\.upper\s*\(\s*\)/],
    tags: ['upper', 'string-method'],
  },
  {
    id: 'py-str-007',
    category: 'string',
    difficulty: 'easy',
    title: 'Lower Case',
    text: 'Convert the string to lowercase',
    setup: 'text = "HELLO WORLD"',
    setupCode: 'text = "HELLO WORLD"',
    expected: 'hello world',
    sample: 'text.lower()',
    hints: ['Use the lower() method'],
    validPatterns: [/text\.lower\s*\(\s*\)/],
    tags: ['lower', 'string-method'],
  },
  {
    id: 'py-str-008',
    category: 'string',
    difficulty: 'easy',
    title: 'Title Case',
    text: 'Convert the string to title case',
    setup: 'text = "hello world python"',
    setupCode: 'text = "hello world python"',
    expected: 'Hello World Python',
    sample: 'text.title()',
    hints: ['Use the title() method'],
    validPatterns: [/text\.title\s*\(\s*\)/],
    tags: ['title', 'string-method'],
  },
  {
    id: 'py-str-009',
    category: 'string',
    difficulty: 'easy',
    title: 'Capitalize',
    text: 'Capitalize the first character of the string',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: 'Hello world',
    sample: 'text.capitalize()',
    hints: ['Use the capitalize() method'],
    validPatterns: [/text\.capitalize\s*\(\s*\)/],
    tags: ['capitalize', 'string-method'],
  },
  {
    id: 'py-str-010',
    category: 'string',
    difficulty: 'easy',
    title: 'Replace Substring',
    text: 'Replace "world" with "Python" in the string',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: 'hello Python',
    sample: 'text.replace("world", "Python")',
    hints: ['Use the replace() method'],
    validPatterns: [/text\.replace\s*\(\s*["']world["']\s*,\s*["']Python["']\s*\)/],
    tags: ['replace', 'string-method'],
  },
  {
    id: 'py-str-011',
    category: 'string',
    difficulty: 'easy',
    title: 'Find Substring',
    text: 'Find the index of "world" in the string',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: 6,
    sample: 'text.find("world")',
    hints: ['Use the find() method'],
    validPatterns: [
      /text\.find\s*\(\s*["']world["']\s*\)/,
      /text\.index\s*\(\s*["']world["']\s*\)/,
    ],
    tags: ['find', 'string-method'],
  },
  {
    id: 'py-str-012',
    category: 'string',
    difficulty: 'easy',
    title: 'Count Substring',
    text: 'Count how many times "l" appears in the string',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: 3,
    sample: 'text.count("l")',
    hints: ['Use the count() method'],
    validPatterns: [/text\.count\s*\(\s*["']l["']\s*\)/],
    tags: ['count', 'string-method'],
  },
  {
    id: 'py-str-013',
    category: 'string',
    difficulty: 'easy',
    title: 'Starts With',
    text: 'Check if the string starts with "hello"',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: true,
    sample: 'text.startswith("hello")',
    hints: ['Use the startswith() method'],
    validPatterns: [/text\.startswith\s*\(\s*["']hello["']\s*\)/],
    tags: ['startswith', 'string-method'],
  },
  {
    id: 'py-str-014',
    category: 'string',
    difficulty: 'easy',
    title: 'Ends With',
    text: 'Check if the string ends with "world"',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: true,
    sample: 'text.endswith("world")',
    hints: ['Use the endswith() method'],
    validPatterns: [/text\.endswith\s*\(\s*["']world["']\s*\)/],
    tags: ['endswith', 'string-method'],
  },
  {
    id: 'py-str-015',
    category: 'string',
    difficulty: 'easy',
    title: 'Is Digit',
    text: 'Check if the string contains only digits',
    setup: 'text = "12345"',
    setupCode: 'text = "12345"',
    expected: true,
    sample: 'text.isdigit()',
    hints: ['Use the isdigit() method'],
    validPatterns: [/text\.isdigit\s*\(\s*\)/, /text\.isnumeric\s*\(\s*\)/],
    tags: ['isdigit', 'string-method'],
  },
  {
    id: 'py-str-016',
    category: 'string',
    difficulty: 'easy',
    title: 'Is Alpha',
    text: 'Check if the string contains only alphabetic characters',
    setup: 'text = "hello"',
    setupCode: 'text = "hello"',
    expected: true,
    sample: 'text.isalpha()',
    hints: ['Use the isalpha() method'],
    validPatterns: [/text\.isalpha\s*\(\s*\)/],
    tags: ['isalpha', 'string-method'],
  },
  {
    id: 'py-str-017',
    category: 'string',
    difficulty: 'easy',
    title: 'Is Alphanumeric',
    text: 'Check if the string contains only alphanumeric characters',
    setup: 'text = "hello123"',
    setupCode: 'text = "hello123"',
    expected: true,
    sample: 'text.isalnum()',
    hints: ['Use the isalnum() method'],
    validPatterns: [/text\.isalnum\s*\(\s*\)/],
    tags: ['isalnum', 'string-method'],
  },
  {
    id: 'py-str-018',
    category: 'string',
    difficulty: 'medium',
    title: 'F-String Formatting',
    text: 'Create a formatted string with the name and age using f-string',
    setup: 'name = "Alice"\nage = 30',
    setupCode: 'name = "Alice"\nage = 30',
    expected: 'Alice is 30 years old',
    sample: 'f"{name} is {age} years old"',
    hints: ['Use f-string syntax: f"text {variable}"'],
    validPatterns: [
      /f["']\{name\}\s+is\s+\{age\}\s+years\s+old["']/,
      /f["']{name}\s+is\s+{age}\s+years\s+old["']/,
      /["']\s*\{\}\s*is\s*\{\}\s*years\s*old["']\.format\s*\(\s*name\s*,\s*age\s*\)/,
    ],
    tags: ['f-string', 'formatting'],
  },
  {
    id: 'py-str-019',
    category: 'string',
    difficulty: 'easy',
    title: 'String Slicing - First Three',
    text: 'Get the first 3 characters of the string',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: 'hel',
    sample: 'text[:3]',
    hints: ['Use slice notation text[:n] to get first n characters'],
    validPatterns: [/text\s*\[\s*:\s*3\s*\]/, /text\s*\[\s*0\s*:\s*3\s*\]/],
    tags: ['slicing', 'string'],
  },
  {
    id: 'py-str-020',
    category: 'string',
    difficulty: 'easy',
    title: 'String Slicing - Last Three',
    text: 'Get the last 3 characters of the string',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: 'rld',
    sample: 'text[-3:]',
    hints: ['Use negative indexing with slices'],
    validPatterns: [/text\s*\[\s*-3\s*:\s*\]/],
    tags: ['slicing', 'string'],
  },
  {
    id: 'py-str-021',
    category: 'string',
    difficulty: 'medium',
    title: 'Reverse String',
    text: 'Reverse the string using slicing',
    setup: 'text = "hello"',
    setupCode: 'text = "hello"',
    expected: 'olleh',
    sample: 'text[::-1]',
    hints: ['Use slice with step -1: text[::-1]'],
    validPatterns: [
      /text\s*\[\s*::\s*-1\s*\]/,
      /["']["']\.join\s*\(\s*reversed\s*\(\s*text\s*\)\s*\)/,
    ],
    tags: ['slicing', 'reverse'],
  },

  // ============================================================
  // DICTIONARY METHODS (10+ problems)
  // ============================================================
  {
    id: 'py-dict-001',
    category: 'dict',
    difficulty: 'easy',
    title: 'Get Dictionary Keys',
    text: 'Get all keys from the dictionary as a list',
    setup: 'person = {"name": "Alice", "age": 30, "city": "NYC"}',
    setupCode: 'person = {"name": "Alice", "age": 30, "city": "NYC"}',
    expected: ['name', 'age', 'city'],
    sample: 'list(person.keys())',
    hints: ['Use the keys() method and convert to list'],
    validPatterns: [
      /list\s*\(\s*person\.keys\s*\(\s*\)\s*\)/,
      /\[\s*k\s+for\s+k\s+in\s+person\s*\]/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+person\.keys\s*\(\s*\)\s*\]/,
    ],
    tags: ['keys', 'dict-method'],
  },
  {
    id: 'py-dict-002',
    category: 'dict',
    difficulty: 'easy',
    title: 'Get Dictionary Values',
    text: 'Get all values from the dictionary as a list',
    setup: 'person = {"name": "Alice", "age": 30, "city": "NYC"}',
    setupCode: 'person = {"name": "Alice", "age": 30, "city": "NYC"}',
    expected: ['Alice', 30, 'NYC'],
    sample: 'list(person.values())',
    hints: ['Use the values() method and convert to list'],
    validPatterns: [
      /list\s*\(\s*person\.values\s*\(\s*\)\s*\)/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+person\.values\s*\(\s*\)\s*\]/,
    ],
    tags: ['values', 'dict-method'],
  },
  {
    id: 'py-dict-003',
    category: 'dict',
    difficulty: 'easy',
    title: 'Get Dictionary Items',
    text: 'Get all key-value pairs as a list of tuples. The result should be [("name", "Alice"), ("age", 30)].',
    setup: 'person = {"name": "Alice", "age": 30}',
    setupCode: 'person = {"name": "Alice", "age": 30}',
    expected: [
      ['name', 'Alice'],
      ['age', 30],
    ],
    sample: 'list(person.items())',
    hints: ['Use the items() method and convert to list', 'items() returns tuples of (key, value)'],
    validPatterns: [
      /list\s*\(\s*person\.items\s*\(\s*\)\s*\)/,
      /\[\s*\(\s*k\s*,\s*v\s*\)\s+for\s+k\s*,\s*v\s+in\s+person\.items\s*\(\s*\)\s*\]/,
      /\[\s*\(\s*\w+\s*,\s*\w+\s*\)\s+for\s+\w+\s*,\s*\w+\s+in\s+person\.items\s*\(\s*\)\s*\]/,
    ],
    tags: ['items', 'dict-method'],
  },
  {
    id: 'py-dict-004',
    category: 'dict',
    difficulty: 'easy',
    title: 'Get with Default',
    text: 'Get the value for key "country" with a default of "Unknown"',
    setup: 'person = {"name": "Alice", "age": 30}',
    setupCode: 'person = {"name": "Alice", "age": 30}',
    expected: 'Unknown',
    sample: 'person.get("country", "Unknown")',
    hints: ['Use the get() method with a default value'],
    validPatterns: [/person\.get\s*\(\s*["']country["']\s*,\s*["']Unknown["']\s*\)/],
    tags: ['get', 'dict-method'],
  },
  {
    id: 'py-dict-005',
    category: 'dict',
    difficulty: 'medium',
    title: 'Set Default Value',
    text: 'Get "score" from dict, setting it to 0 if not present (use setdefault)',
    setup: 'data = {"name": "Alice"}',
    setupCode: 'data = {"name": "Alice"}',
    expected: 0,
    sample: 'data.setdefault("score", 0)',
    hints: ['Use setdefault() to get or set a default value'],
    validPatterns: [/data\.setdefault\s*\(\s*["']score["']\s*,\s*0\s*\)/],
    tags: ['setdefault', 'dict-method'],
  },
  {
    id: 'py-dict-006',
    category: 'dict',
    difficulty: 'easy',
    title: 'Update Dictionary',
    text: 'Merge additional data into the original dictionary and return it',
    setup: 'original = {"a": 1, "b": 2}\nadditional = {"c": 3, "d": 4}',
    setupCode: 'original = {"a": 1, "b": 2}\nadditional = {"c": 3, "d": 4}',
    expected: { a: 1, b: 2, c: 3, d: 4 },
    sample: 'original.update(additional) or original',
    hints: ['Use the update() method to merge dictionaries'],
    validPatterns: [
      /original\.update\s*\(\s*additional\s*\)/,
      /\{\s*\*\*original\s*,\s*\*\*additional\s*\}/,
      /original\s*\|\s*additional/,
    ],
    tags: ['update', 'dict-method'],
  },
  {
    id: 'py-dict-007',
    category: 'dict',
    difficulty: 'medium',
    title: 'Dict Comprehension',
    text: 'Create a dictionary mapping each number to its square',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: { 1: 1, 2: 4, 3: 9, 4: 16, 5: 25 },
    sample: '{x: x**2 for x in nums}',
    hints: ['Use dict comprehension: {key: value for item in iterable}'],
    validPatterns: [
      /\{\s*\w+\s*:\s*\w+\s*\*\*\s*2\s+for\s+\w+\s+in\s+nums\s*\}/,
      /\{\s*\w+\s*:\s*pow\s*\(\s*\w+\s*,\s*2\s*\)\s+for\s+\w+\s+in\s+nums\s*\}/,
      /dict\s*\(\s*\[\s*\(\s*\w+\s*,\s*\w+\s*\*\*\s*2\s*\)\s+for\s+\w+\s+in\s+nums\s*\]\s*\)/,
    ],
    tags: ['dict-comprehension'],
  },
  {
    id: 'py-dict-008',
    category: 'dict',
    difficulty: 'medium',
    title: 'Filter Dict Comprehension',
    text: 'Create a new dictionary with only entries where value > 2',
    setup: 'scores = {"a": 1, "b": 3, "c": 2, "d": 4}',
    setupCode: 'scores = {"a": 1, "b": 3, "c": 2, "d": 4}',
    expected: { b: 3, d: 4 },
    sample: '{k: v for k, v in scores.items() if v > 2}',
    hints: ['Use dict comprehension with a condition'],
    validPatterns: [
      /\{\s*\w+\s*:\s*\w+\s+for\s+\w+\s*,\s*\w+\s+in\s+scores\.items\s*\(\s*\)\s+if\s+\w+\s*>\s*2\s*\}/,
    ],
    tags: ['dict-comprehension', 'filter'],
  },
  {
    id: 'py-dict-009',
    category: 'dict',
    difficulty: 'medium',
    title: 'Pop from Dictionary',
    text: 'Remove and return the value for key "age"',
    setup: 'person = {"name": "Alice", "age": 30, "city": "NYC"}',
    setupCode: 'person = {"name": "Alice", "age": 30, "city": "NYC"}',
    expected: 30,
    sample: 'person.pop("age")',
    hints: ['Use the pop() method to remove and return a value'],
    validPatterns: [/person\.pop\s*\(\s*["']age["']\s*\)/],
    tags: ['pop', 'dict-method'],
  },
  {
    id: 'py-dict-010',
    category: 'dict',
    difficulty: 'medium',
    title: 'Create Dict from Keys',
    text: 'Create a dictionary with the given keys, all with value 0',
    setup: 'keys = ["a", "b", "c", "d"]',
    setupCode: 'keys = ["a", "b", "c", "d"]',
    expected: { a: 0, b: 0, c: 0, d: 0 },
    sample: 'dict.fromkeys(keys, 0)',
    hints: ['Use dict.fromkeys() to create a dictionary with default values'],
    validPatterns: [
      /dict\.fromkeys\s*\(\s*keys\s*,\s*0\s*\)/,
      /\{\s*\w+\s*:\s*0\s+for\s+\w+\s+in\s+keys\s*\}/,
    ],
    tags: ['fromkeys', 'dict-method'],
  },
  {
    id: 'py-dict-011',
    category: 'dict',
    difficulty: 'medium',
    title: 'Invert Dictionary',
    text: 'Swap keys and values in the dictionary',
    setup: 'original = {"a": 1, "b": 2, "c": 3}',
    setupCode: 'original = {"a": 1, "b": 2, "c": 3}',
    expected: { 1: 'a', 2: 'b', 3: 'c' },
    sample: '{v: k for k, v in original.items()}',
    hints: ['Use dict comprehension to swap keys and values'],
    validPatterns: [
      /\{\s*\w+\s*:\s*\w+\s+for\s+\w+\s*,\s*\w+\s+in\s+original\.items\s*\(\s*\)\s*\}/,
      /dict\s*\(\s*\[\s*\(\s*\w+\s*,\s*\w+\s*\)\s+for\s+\w+\s*,\s*\w+\s+in\s+original\.items\s*\(\s*\)\s*\]\s*\)/,
    ],
    tags: ['dict-comprehension', 'invert'],
  },

  // ============================================================
  // SET METHODS (5+ problems)
  // ============================================================
  {
    id: 'py-set-001',
    category: 'set',
    difficulty: 'easy',
    title: 'Create Set from List',
    text: 'Remove duplicates from the list by converting to a set and back to list',
    setup: 'nums = [1, 2, 2, 3, 3, 3, 4, 4, 5]',
    setupCode: 'nums = [1, 2, 2, 3, 3, 3, 4, 4, 5]',
    expected: [1, 2, 3, 4, 5],
    sample: 'list(set(nums))',
    hints: ['Convert to set to remove duplicates, then back to list'],
    validPatterns: [
      /list\s*\(\s*set\s*\(\s*nums\s*\)\s*\)/,
      /sorted\s*\(\s*set\s*\(\s*nums\s*\)\s*\)/,
    ],
    tags: ['set', 'conversion'],
  },
  {
    id: 'py-set-002',
    category: 'set',
    difficulty: 'easy',
    title: 'Set Union',
    text: 'Combine two sets to get all unique elements',
    setup: 'set1 = {1, 2, 3}\nset2 = {3, 4, 5}',
    setupCode: 'set1 = {1, 2, 3}\nset2 = {3, 4, 5}',
    expected: [1, 2, 3, 4, 5],
    sample: 'set1.union(set2)',
    hints: ['Use the union() method or | operator'],
    validPatterns: [
      /set1\.union\s*\(\s*set2\s*\)/,
      /set1\s*\|\s*set2/,
      /set2\.union\s*\(\s*set1\s*\)/,
      /set2\s*\|\s*set1/,
    ],
    tags: ['union', 'set-method'],
  },
  {
    id: 'py-set-003',
    category: 'set',
    difficulty: 'easy',
    title: 'Set Intersection',
    text: 'Find elements that exist in both sets',
    setup: 'set1 = {1, 2, 3, 4}\nset2 = {3, 4, 5, 6}',
    setupCode: 'set1 = {1, 2, 3, 4}\nset2 = {3, 4, 5, 6}',
    expected: [3, 4],
    sample: 'set1.intersection(set2)',
    hints: ['Use the intersection() method or & operator'],
    validPatterns: [
      /set1\.intersection\s*\(\s*set2\s*\)/,
      /set1\s*&\s*set2/,
      /set2\.intersection\s*\(\s*set1\s*\)/,
      /set2\s*&\s*set1/,
    ],
    tags: ['intersection', 'set-method'],
  },
  {
    id: 'py-set-004',
    category: 'set',
    difficulty: 'easy',
    title: 'Set Difference',
    text: 'Find elements in set1 that are not in set2',
    setup: 'set1 = {1, 2, 3, 4, 5}\nset2 = {4, 5, 6, 7}',
    setupCode: 'set1 = {1, 2, 3, 4, 5}\nset2 = {4, 5, 6, 7}',
    expected: [1, 2, 3],
    sample: 'set1.difference(set2)',
    hints: ['Use the difference() method or - operator'],
    validPatterns: [/set1\.difference\s*\(\s*set2\s*\)/, /set1\s*-\s*set2/],
    tags: ['difference', 'set-method'],
  },
  {
    id: 'py-set-005',
    category: 'set',
    difficulty: 'medium',
    title: 'Set Comprehension',
    text: 'Create a set of squares from the numbers using set comprehension',
    setup: 'nums = [1, 2, 2, 3, 3, 4]',
    setupCode: 'nums = [1, 2, 2, 3, 3, 4]',
    expected: [1, 4, 9, 16],
    sample: '{x**2 for x in nums}',
    hints: ['Use set comprehension: {expression for item in iterable}'],
    validPatterns: [
      /\{\s*\w+\s*\*\*\s*2\s+for\s+\w+\s+in\s+nums\s*\}/,
      /set\s*\(\s*\[\s*\w+\s*\*\*\s*2\s+for\s+\w+\s+in\s+nums\s*\]\s*\)/,
    ],
    tags: ['set-comprehension'],
  },
  {
    id: 'py-set-006',
    category: 'set',
    difficulty: 'medium',
    title: 'Check Subset',
    text: 'Check if set1 is a subset of set2',
    setup: 'set1 = {1, 2}\nset2 = {1, 2, 3, 4, 5}',
    setupCode: 'set1 = {1, 2}\nset2 = {1, 2, 3, 4, 5}',
    expected: true,
    sample: 'set1.issubset(set2)',
    hints: ['Use the issubset() method or <= operator'],
    validPatterns: [/set1\.issubset\s*\(\s*set2\s*\)/, /set1\s*<=\s*set2/],
    tags: ['issubset', 'set-method'],
  },
  {
    id: 'py-set-007',
    category: 'set',
    difficulty: 'medium',
    title: 'Check Superset',
    text: 'Check if set1 is a superset of set2',
    setup: 'set1 = {1, 2, 3, 4, 5}\nset2 = {2, 3}',
    setupCode: 'set1 = {1, 2, 3, 4, 5}\nset2 = {2, 3}',
    expected: true,
    sample: 'set1.issuperset(set2)',
    hints: ['Use the issuperset() method or >= operator'],
    validPatterns: [/set1\.issuperset\s*\(\s*set2\s*\)/, /set1\s*>=\s*set2/],
    tags: ['issuperset', 'set-method'],
  },

  // ============================================================
  // OTHER BUILT-INS (5+ problems)
  // ============================================================
  {
    id: 'py-builtin-001',
    category: 'builtin',
    difficulty: 'easy',
    title: 'Range to List',
    text: 'Create a list of numbers from 0 to 9 using range',
    setup: '# Use range to generate numbers',
    setupCode: '# Use range to generate numbers',
    expected: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
    sample: 'list(range(10))',
    hints: ['Use range() and convert to list'],
    validPatterns: [
      /list\s*\(\s*range\s*\(\s*10\s*\)\s*\)/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+range\s*\(\s*10\s*\)\s*\]/,
    ],
    tags: ['range', 'built-in'],
  },
  {
    id: 'py-builtin-002',
    category: 'builtin',
    difficulty: 'easy',
    title: 'Range with Start and Stop',
    text: 'Create a list of numbers from 5 to 14 using range',
    setup: '# Use range with start and stop',
    setupCode: '# Use range with start and stop',
    expected: [5, 6, 7, 8, 9, 10, 11, 12, 13, 14],
    sample: 'list(range(5, 15))',
    hints: ['Use range(start, stop) where stop is exclusive'],
    validPatterns: [
      /list\s*\(\s*range\s*\(\s*5\s*,\s*15\s*\)\s*\)/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+range\s*\(\s*5\s*,\s*15\s*\)\s*\]/,
    ],
    tags: ['range', 'built-in'],
  },
  {
    id: 'py-builtin-003',
    category: 'builtin',
    difficulty: 'easy',
    title: 'Range with Step',
    text: 'Create a list of even numbers from 0 to 18 using range',
    setup: '# Use range with step',
    setupCode: '# Use range with step',
    expected: [0, 2, 4, 6, 8, 10, 12, 14, 16, 18],
    sample: 'list(range(0, 20, 2))',
    hints: ['Use range(start, stop, step)'],
    validPatterns: [
      /list\s*\(\s*range\s*\(\s*0\s*,\s*20\s*,\s*2\s*\)\s*\)/,
      /list\s*\(\s*range\s*\(\s*0\s*,\s*19\s*,\s*2\s*\)\s*\)/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+range\s*\(\s*0\s*,\s*20\s*,\s*2\s*\)\s*\]/,
    ],
    tags: ['range', 'built-in'],
  },
  {
    id: 'py-builtin-004',
    category: 'builtin',
    difficulty: 'easy',
    title: 'Convert String to Int',
    text: 'Convert the string to an integer',
    setup: 'num_str = "42"',
    setupCode: 'num_str = "42"',
    expected: 42,
    sample: 'int(num_str)',
    hints: ['Use the int() built-in function'],
    validPatterns: [/int\s*\(\s*num_str\s*\)/],
    tags: ['type-conversion', 'built-in'],
  },
  {
    id: 'py-builtin-005',
    category: 'builtin',
    difficulty: 'easy',
    title: 'Convert Int to String',
    text: 'Convert the integer to a string',
    setup: 'num = 42',
    setupCode: 'num = 42',
    expected: '42',
    sample: 'str(num)',
    hints: ['Use the str() built-in function'],
    validPatterns: [/str\s*\(\s*num\s*\)/, /f["']\{num\}["']/],
    tags: ['type-conversion', 'built-in'],
  },
  {
    id: 'py-builtin-006',
    category: 'builtin',
    difficulty: 'easy',
    title: 'Convert String to List',
    text: 'Convert the string to a list of characters',
    setup: 'text = "hello"',
    setupCode: 'text = "hello"',
    expected: ['h', 'e', 'l', 'l', 'o'],
    sample: 'list(text)',
    hints: ['Use the list() built-in function'],
    validPatterns: [/list\s*\(\s*text\s*\)/, /\[\s*\w+\s+for\s+\w+\s+in\s+text\s*\]/],
    tags: ['type-conversion', 'built-in'],
  },
  {
    id: 'py-builtin-007',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Lambda Function',
    text: 'Create a lambda function that doubles a number and apply it to 5',
    setup: '# Create and use a lambda function',
    setupCode: '# Create and use a lambda function',
    expected: 10,
    sample: '(lambda x: x * 2)(5)',
    hints: ['Use lambda syntax: lambda args: expression'],
    validPatterns: [
      /\(\s*lambda\s+\w+\s*:\s*\w+\s*\*\s*2\s*\)\s*\(\s*5\s*\)/,
      /\(\s*lambda\s+\w+\s*:\s*2\s*\*\s*\w+\s*\)\s*\(\s*5\s*\)/,
    ],
    tags: ['lambda', 'built-in'],
  },
  {
    id: 'py-builtin-008',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Reduce Sum',
    text: 'Use reduce from functools to sum all numbers in the list',
    setup: 'from functools import reduce\nnums = [1, 2, 3, 4, 5]',
    setupCode: 'from functools import reduce\nnums = [1, 2, 3, 4, 5]',
    expected: 15,
    sample: 'reduce(lambda a, b: a + b, nums)',
    hints: ['Import reduce from functools and use with a lambda'],
    validPatterns: [/reduce\s*\(\s*lambda\s+\w+\s*,\s*\w+\s*:\s*\w+\s*\+\s*\w+\s*,\s*nums\s*\)/],
    tags: ['reduce', 'functools'],
  },
  {
    id: 'py-builtin-009',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Reduce Product',
    text: 'Use reduce to calculate the product of all numbers in the list',
    setup: 'from functools import reduce\nnums = [1, 2, 3, 4, 5]',
    setupCode: 'from functools import reduce\nnums = [1, 2, 3, 4, 5]',
    expected: 120,
    sample: 'reduce(lambda a, b: a * b, nums)',
    hints: ['Use reduce with multiplication'],
    validPatterns: [/reduce\s*\(\s*lambda\s+\w+\s*,\s*\w+\s*:\s*\w+\s*\*\s*\w+\s*,\s*nums\s*\)/],
    tags: ['reduce', 'functools'],
  },
  {
    id: 'py-builtin-010',
    category: 'builtin',
    difficulty: 'easy',
    title: 'Absolute Value',
    text: 'Get the absolute value of the number',
    setup: 'num = -42',
    setupCode: 'num = -42',
    expected: 42,
    sample: 'abs(num)',
    hints: ['Use the abs() built-in function'],
    validPatterns: [/abs\s*\(\s*num\s*\)/],
    tags: ['abs', 'built-in'],
  },
  {
    id: 'py-builtin-011',
    category: 'builtin',
    difficulty: 'easy',
    title: 'Round Number',
    text: 'Round the float to 2 decimal places',
    setup: 'num = 3.14159',
    setupCode: 'num = 3.14159',
    expected: 3.14,
    sample: 'round(num, 2)',
    hints: ['Use the round() built-in function with precision'],
    validPatterns: [/round\s*\(\s*num\s*,\s*2\s*\)/],
    tags: ['round', 'built-in'],
  },
  {
    id: 'py-builtin-012',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Filter with Lambda',
    text: 'Use filter() with lambda to get only positive numbers',
    setup: 'nums = [-2, -1, 0, 1, 2, 3]',
    setupCode: 'nums = [-2, -1, 0, 1, 2, 3]',
    expected: [1, 2, 3],
    sample: 'list(filter(lambda x: x > 0, nums))',
    hints: ['Use filter() with a lambda function'],
    validPatterns: [
      /list\s*\(\s*filter\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*>\s*0\s*,\s*nums\s*\)\s*\)/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*>\s*0\s*\]/,
    ],
    tags: ['filter', 'lambda'],
  },
  {
    id: 'py-builtin-013',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Sort by Key',
    text: 'Sort the list of tuples by the second element (age)',
    setup: 'people = [("Alice", 30), ("Bob", 25), ("Charlie", 35)]',
    setupCode: 'people = [("Alice", 30), ("Bob", 25), ("Charlie", 35)]',
    expected: [
      ['Bob', 25],
      ['Alice', 30],
      ['Charlie', 35],
    ],
    sample: 'sorted(people, key=lambda x: x[1])',
    hints: ['Use sorted() with a key function'],
    validPatterns: [
      /sorted\s*\(\s*people\s*,\s*key\s*=\s*lambda\s+\w+\s*:\s*\w+\s*\[\s*1\s*\]\s*\)/,
    ],
    tags: ['sorted', 'key', 'lambda'],
  },
  {
    id: 'py-builtin-014',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Sort by String Length',
    text: 'Sort the list of words by their length',
    setup: 'words = ["python", "is", "awesome", "coding"]',
    setupCode: 'words = ["python", "is", "awesome", "coding"]',
    expected: ['is', 'python', 'coding', 'awesome'],
    sample: 'sorted(words, key=len)',
    hints: ['Use len as the key function'],
    validPatterns: [
      /sorted\s*\(\s*words\s*,\s*key\s*=\s*len\s*\)/,
      /sorted\s*\(\s*words\s*,\s*key\s*=\s*lambda\s+\w+\s*:\s*len\s*\(\s*\w+\s*\)\s*\)/,
    ],
    tags: ['sorted', 'key'],
  },
  {
    id: 'py-builtin-015',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Boolean Conversion',
    text: 'Convert the list to a boolean value',
    setup: 'items = [1, 2, 3]',
    setupCode: 'items = [1, 2, 3]',
    expected: true,
    sample: 'bool(items)',
    hints: ['Use bool() - non-empty lists are truthy'],
    validPatterns: [/bool\s*\(\s*items\s*\)/],
    tags: ['bool', 'type-conversion'],
  },

  // ============================================================
  // ADDITIONAL LIST PROBLEMS
  // ============================================================
  {
    id: 'py-list-024',
    category: 'list',
    difficulty: 'medium',
    title: 'Append to List',
    text: 'Append 6 to the list and return the list',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: [1, 2, 3, 4, 5, 6],
    sample: 'nums.append(6) or nums',
    hints: ['Use append() to add an element to the end'],
    validPatterns: [
      /nums\.append\s*\(\s*6\s*\)/,
      /nums\s*\+\s*\[\s*6\s*\]/,
      /\[\s*\*nums\s*,\s*6\s*\]/,
    ],
    tags: ['append', 'list-method'],
  },
  {
    id: 'py-list-025',
    category: 'list',
    difficulty: 'medium',
    title: 'Extend List',
    text: 'Extend nums with more_nums and return the combined list',
    setup: 'nums = [1, 2, 3]\nmore_nums = [4, 5, 6]',
    setupCode: 'nums = [1, 2, 3]\nmore_nums = [4, 5, 6]',
    expected: [1, 2, 3, 4, 5, 6],
    sample: 'nums.extend(more_nums) or nums',
    hints: ['Use extend() to add all elements from another list'],
    validPatterns: [
      /nums\.extend\s*\(\s*more_nums\s*\)/,
      /nums\s*\+\s*more_nums/,
      /\[\s*\*nums\s*,\s*\*more_nums\s*\]/,
    ],
    tags: ['extend', 'list-method'],
  },
  {
    id: 'py-list-026',
    category: 'list',
    difficulty: 'medium',
    title: 'Insert at Index',
    text: 'Insert 10 at index 2 and return the list',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: [1, 2, 10, 3, 4, 5],
    sample: 'nums.insert(2, 10) or nums',
    hints: ['Use insert(index, element) to insert at a specific position'],
    validPatterns: [/nums\.insert\s*\(\s*2\s*,\s*10\s*\)/],
    tags: ['insert', 'list-method'],
  },
  {
    id: 'py-list-027',
    category: 'list',
    difficulty: 'medium',
    title: 'Pop Last Element',
    text: 'Remove and return the last element from the list',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: 5,
    sample: 'nums.pop()',
    hints: ['Use pop() without arguments to remove the last element'],
    validPatterns: [/nums\.pop\s*\(\s*\)/, /nums\s*\[\s*-1\s*\]/],
    tags: ['pop', 'list-method'],
  },
  {
    id: 'py-list-028',
    category: 'list',
    difficulty: 'medium',
    title: 'Pop at Index',
    text: 'Remove and return the element at index 2',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: 3,
    sample: 'nums.pop(2)',
    hints: ['Use pop(index) to remove and return element at specific index'],
    validPatterns: [/nums\.pop\s*\(\s*2\s*\)/],
    tags: ['pop', 'list-method'],
  },
  {
    id: 'py-list-029',
    category: 'list',
    difficulty: 'medium',
    title: 'Remove by Value',
    text: 'Remove the first occurrence of 3 from the list and return the list',
    setup: 'nums = [1, 2, 3, 4, 3, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 3, 5]',
    expected: [1, 2, 4, 3, 5],
    sample: 'nums.remove(3) or nums',
    hints: ['Use remove() to remove the first occurrence of a value'],
    validPatterns: [/nums\.remove\s*\(\s*3\s*\)/],
    tags: ['remove', 'list-method'],
  },
  {
    id: 'py-list-030',
    category: 'list',
    difficulty: 'hard',
    title: 'List Slicing Middle',
    text: 'Get elements from index 2 to 5 (exclusive)',
    setup: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    setupCode: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    expected: [2, 3, 4],
    sample: 'nums[2:5]',
    hints: ['Use slice notation: list[start:stop]'],
    validPatterns: [/nums\s*\[\s*2\s*:\s*5\s*\]/],
    tags: ['slicing', 'list'],
  },
  {
    id: 'py-list-031',
    category: 'list',
    difficulty: 'hard',
    title: 'Every Other Element',
    text: 'Get every other element from the list starting from index 0',
    setup: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    setupCode: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    expected: [0, 2, 4, 6, 8],
    sample: 'nums[::2]',
    hints: ['Use slice with step: list[::step]'],
    validPatterns: [
      /nums\s*\[\s*::\s*2\s*\]/,
      /nums\s*\[\s*0\s*:\s*:\s*2\s*\]/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+nums\.index\s*\(\s*\w+\s*\)\s*%\s*2\s*==\s*0\s*\]/,
    ],
    tags: ['slicing', 'list'],
  },
  {
    id: 'py-list-032',
    category: 'list',
    difficulty: 'hard',
    title: 'Nested List Comprehension',
    text: 'Create a multiplication table (3x3) using nested list comprehension',
    setup: '# Create 3x3 multiplication table',
    setupCode: '# Create 3x3 multiplication table',
    expected: [
      [1, 2, 3],
      [2, 4, 6],
      [3, 6, 9],
    ],
    sample: '[[i * j for j in range(1, 4)] for i in range(1, 4)]',
    hints: ['Use nested list comprehensions: [[expr for inner] for outer]'],
    validPatterns: [
      /\[\s*\[\s*\w+\s*\*\s*\w+\s+for\s+\w+\s+in\s+range\s*\(\s*1\s*,\s*4\s*\)\s*\]\s+for\s+\w+\s+in\s+range\s*\(\s*1\s*,\s*4\s*\)\s*\]/,
    ],
    tags: ['list-comprehension', 'nested', 'advanced'],
  },

  // ============================================================
  // ADDITIONAL STRING PROBLEMS
  // ============================================================
  {
    id: 'py-str-022',
    category: 'string',
    difficulty: 'medium',
    title: 'F-String Expression',
    text: 'Create a formatted string showing "The sum of 5 and 3 is 8" using f-string with calculation',
    setup: 'a = 5\nb = 3',
    setupCode: 'a = 5\nb = 3',
    expected: 'The sum of 5 and 3 is 8',
    sample: 'f"The sum of {a} and {b} is {a + b}"',
    hints: ['F-strings can contain expressions inside curly braces'],
    validPatterns: [
      /f["']The sum of \{a\} and \{b\} is \{a\s*\+\s*b\}["']/,
      /f["']The sum of \{a\} and \{b\} is \{\s*a\s*\+\s*b\s*\}["']/,
    ],
    tags: ['f-string', 'formatting', 'expressions'],
  },
  {
    id: 'py-str-023',
    category: 'string',
    difficulty: 'medium',
    title: 'String Center',
    text: 'Center the text in a string of width 20, padded with asterisks',
    setup: 'text = "Python"',
    setupCode: 'text = "Python"',
    expected: '*******Python*******',
    sample: 'text.center(20, "*")',
    hints: ['Use the center() method with width and fill character'],
    validPatterns: [/text\.center\s*\(\s*20\s*,\s*["']\*["']\s*\)/],
    tags: ['center', 'string-method', 'padding'],
  },
  {
    id: 'py-str-024',
    category: 'string',
    difficulty: 'easy',
    title: 'Check Whitespace Only',
    text: 'Check if the string contains only whitespace characters',
    setup: 'text = "   \\t\\n"',
    setupCode: 'text = "   \\t\\n"',
    expected: true,
    sample: 'text.isspace()',
    hints: ['Use the isspace() method'],
    validPatterns: [/text\.isspace\s*\(\s*\)/],
    tags: ['isspace', 'string-method'],
  },
  {
    id: 'py-str-025',
    category: 'string',
    difficulty: 'medium',
    title: 'Partition String',
    text: 'Split the email at "@" using partition, return the username part (before @)',
    setup: 'email = "user@example.com"',
    setupCode: 'email = "user@example.com"',
    expected: 'user',
    sample: 'email.partition("@")[0]',
    hints: [
      'Use partition() which returns (before, separator, after)',
      'Index [0] gets the part before the separator',
    ],
    validPatterns: [
      /email\.partition\s*\(\s*["']@["']\s*\)\s*\[\s*0\s*\]/,
      /email\.split\s*\(\s*["']@["']\s*\)\s*\[\s*0\s*\]/,
    ],
    tags: ['partition', 'string-method'],
  },
  {
    id: 'py-str-026',
    category: 'string',
    difficulty: 'medium',
    title: 'Swapcase',
    text: 'Swap the case of all characters in the string',
    setup: 'text = "Hello World"',
    setupCode: 'text = "Hello World"',
    expected: 'hELLO wORLD',
    sample: 'text.swapcase()',
    hints: ['Use the swapcase() method'],
    validPatterns: [/text\.swapcase\s*\(\s*\)/],
    tags: ['swapcase', 'string-method'],
  },

  // ============================================================
  // ADVANCED DICTIONARY PROBLEMS
  // ============================================================
  {
    id: 'py-dict-012',
    category: 'dict',
    difficulty: 'medium',
    title: 'Merge Dictionaries (Python 3.9+)',
    text: 'Merge dict1 and dict2 using the | operator (creates new dict)',
    setup: 'dict1 = {"a": 1, "b": 2}\ndict2 = {"b": 3, "c": 4}',
    setupCode: 'dict1 = {"a": 1, "b": 2}\ndict2 = {"b": 3, "c": 4}',
    expected: { a: 1, b: 3, c: 4 },
    sample: 'dict1 | dict2',
    hints: [
      'Use the | operator to merge dictionaries (Python 3.9+)',
      'Later values override earlier ones',
    ],
    validPatterns: [/dict1\s*\|\s*dict2/, /\{\s*\*\*dict1\s*,\s*\*\*dict2\s*\}/],
    tags: ['merge', 'dict-operator'],
  },
  {
    id: 'py-dict-013',
    category: 'dict',
    difficulty: 'hard',
    title: 'Count Word Frequencies',
    text: 'Count the frequency of each word in the list',
    setup: 'words = ["apple", "banana", "apple", "cherry", "banana", "apple"]',
    setupCode: 'words = ["apple", "banana", "apple", "cherry", "banana", "apple"]',
    expected: { apple: 3, banana: 2, cherry: 1 },
    sample: '{word: words.count(word) for word in set(words)}',
    hints: ['Use dict comprehension with set to get unique words', 'Or use collections.Counter'],
    validPatterns: [
      /\{\s*\w+\s*:\s*words\.count\s*\(\s*\w+\s*\)\s+for\s+\w+\s+in\s+set\s*\(\s*words\s*\)\s*\}/,
      /Counter\s*\(\s*words\s*\)/,
    ],
    tags: ['dict-comprehension', 'counting'],
  },
  {
    id: 'py-dict-014',
    category: 'dict',
    difficulty: 'hard',
    title: 'Group by Length',
    text: 'Group words by their length into a dictionary',
    setup: 'words = ["hi", "hello", "hey", "world", "a"]',
    setupCode: 'words = ["hi", "hello", "hey", "world", "a"]',
    expected: { 1: ['a'], 2: ['hi'], 3: ['hey'], 5: ['hello', 'world'] },
    sample:
      '{length: [w for w in words if len(w) == length] for length in set(len(w) for w in words)}',
    hints: ['Group by extracting unique lengths first', 'Then filter words matching each length'],
    validPatterns: [
      /\{\s*\w+\s*:\s*\[\s*\w+\s+for\s+\w+\s+in\s+words\s+if\s+len\s*\(\s*\w+\s*\)\s*==\s*\w+\s*\]\s+for\s+\w+\s+in/,
    ],
    tags: ['dict-comprehension', 'grouping', 'advanced'],
  },

  // ============================================================
  // ADVANCED BUILT-IN PROBLEMS
  // ============================================================
  {
    id: 'py-builtin-016',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Check Type',
    text: 'Check if the variable is an instance of list',
    setup: 'data = [1, 2, 3]',
    setupCode: 'data = [1, 2, 3]',
    expected: true,
    sample: 'isinstance(data, list)',
    hints: ['Use isinstance() to check if an object is of a certain type'],
    validPatterns: [/isinstance\s*\(\s*data\s*,\s*list\s*\)/, /type\s*\(\s*data\s*\)\s*==\s*list/],
    tags: ['isinstance', 'type-checking'],
  },
  {
    id: 'py-builtin-017',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Chained Comparison',
    text: 'Check if x is between 1 and 10 (inclusive) using chained comparison',
    setup: 'x = 5',
    setupCode: 'x = 5',
    expected: true,
    sample: '1 <= x <= 10',
    hints: ['Python supports chained comparisons'],
    validPatterns: [/1\s*<=\s*x\s*<=\s*10/, /x\s*>=\s*1\s*and\s*x\s*<=\s*10/],
    tags: ['comparison', 'pythonic'],
  },
  {
    id: 'py-builtin-018',
    category: 'builtin',
    difficulty: 'hard',
    title: 'Ternary Expression',
    text: 'Use a conditional expression to return "even" if num is even, "odd" otherwise',
    setup: 'num = 7',
    setupCode: 'num = 7',
    expected: 'odd',
    sample: '"even" if num % 2 == 0 else "odd"',
    hints: ['Use Python ternary syntax: value_if_true if condition else value_if_false'],
    validPatterns: [
      /["']even["']\s+if\s+num\s*%\s*2\s*==\s*0\s+else\s+["']odd["']/,
      /["']odd["']\s+if\s+num\s*%\s*2\s*!=?\s*0?\s+else\s+["']even["']/,
      /["']odd["']\s+if\s+num\s*%\s*2\s+else\s+["']even["']/,
    ],
    tags: ['ternary', 'conditional'],
  },
  {
    id: 'py-builtin-019',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Unpack with Star',
    text: 'Unpack the list to get first, middle elements, and last using star expression',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: [2, 3, 4],
    sample: 'first, *middle, last = nums; middle',
    hints: ['Use * to capture multiple elements during unpacking'],
    validPatterns: [/\w+\s*,\s*\*\s*\w+\s*,\s*\w+\s*=\s*nums/],
    tags: ['unpacking', 'star-expression'],
  },
  {
    id: 'py-builtin-020',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Walrus Operator',
    text: 'Use the walrus operator to assign and check length in one expression (return True if length > 3)',
    setup: 'text = "hello"',
    setupCode: 'text = "hello"',
    expected: true,
    sample: '(n := len(text)) > 3',
    hints: ['Use := (walrus operator) to assign within an expression', 'Available in Python 3.8+'],
    validPatterns: [
      /\(\s*\w+\s*:=\s*len\s*\(\s*text\s*\)\s*\)\s*>\s*3/,
      /len\s*\(\s*text\s*\)\s*>\s*3/,
    ],
    tags: ['walrus', 'assignment-expression'],
  },

  // ============================================================
  // SET ADVANCED PROBLEMS
  // ============================================================
  {
    id: 'py-set-008',
    category: 'set',
    difficulty: 'medium',
    title: 'Symmetric Difference',
    text: 'Find elements that are in either set but not in both',
    setup: 'set1 = {1, 2, 3, 4}\nset2 = {3, 4, 5, 6}',
    setupCode: 'set1 = {1, 2, 3, 4}\nset2 = {3, 4, 5, 6}',
    expected: [1, 2, 5, 6],
    sample: 'set1.symmetric_difference(set2)',
    hints: ['Use symmetric_difference() or ^ operator'],
    validPatterns: [
      /set1\.symmetric_difference\s*\(\s*set2\s*\)/,
      /set1\s*\^\s*set2/,
      /\(\s*set1\s*-\s*set2\s*\)\s*\|\s*\(\s*set2\s*-\s*set1\s*\)/,
    ],
    tags: ['symmetric_difference', 'set-method'],
  },
  {
    id: 'py-set-009',
    category: 'set',
    difficulty: 'medium',
    title: 'Check Disjoint',
    text: 'Check if the two sets have no common elements',
    setup: 'set1 = {1, 2, 3}\nset2 = {4, 5, 6}',
    setupCode: 'set1 = {1, 2, 3}\nset2 = {4, 5, 6}',
    expected: true,
    sample: 'set1.isdisjoint(set2)',
    hints: ['Use the isdisjoint() method'],
    validPatterns: [
      /set1\.isdisjoint\s*\(\s*set2\s*\)/,
      /len\s*\(\s*set1\s*&\s*set2\s*\)\s*==\s*0/,
      /not\s+set1\s*&\s*set2/,
    ],
    tags: ['isdisjoint', 'set-method'],
  },

  // ============================================================
  // TUPLE PROBLEMS
  // ============================================================
  {
    id: 'py-tuple-001',
    category: 'tuple',
    difficulty: 'easy',
    title: 'Create Tuple',
    text: 'Create a tuple containing the numbers 1, 2, 3',
    setup: '# Create a tuple',
    setupCode: '# Create a tuple',
    expected: [1, 2, 3],
    sample: '(1, 2, 3)',
    hints: ['Use parentheses to create a tuple: (item1, item2, ...)'],
    validPatterns: [/\(\s*1\s*,\s*2\s*,\s*3\s*\)/, /tuple\s*\(\s*\[\s*1\s*,\s*2\s*,\s*3\s*\]\s*\)/],
    tags: ['tuple', 'creation'],
  },
  {
    id: 'py-tuple-002',
    category: 'tuple',
    difficulty: 'easy',
    title: 'Tuple Index',
    text: 'Find the index of "banana" in the tuple',
    setup: 'fruits = ("apple", "banana", "cherry")',
    setupCode: 'fruits = ("apple", "banana", "cherry")',
    expected: 1,
    sample: 'fruits.index("banana")',
    hints: ['Tuples have an index() method like lists'],
    validPatterns: [/fruits\.index\s*\(\s*["']banana["']\s*\)/],
    tags: ['tuple', 'index'],
  },
  {
    id: 'py-tuple-003',
    category: 'tuple',
    difficulty: 'easy',
    title: 'Tuple Count',
    text: 'Count how many times 1 appears in the tuple',
    setup: 'nums = (1, 2, 1, 3, 1, 4)',
    setupCode: 'nums = (1, 2, 1, 3, 1, 4)',
    expected: 3,
    sample: 'nums.count(1)',
    hints: ['Tuples have a count() method like lists'],
    validPatterns: [/nums\.count\s*\(\s*1\s*\)/],
    tags: ['tuple', 'count'],
  },
  {
    id: 'py-tuple-004',
    category: 'tuple',
    difficulty: 'medium',
    title: 'Tuple Unpacking',
    text: 'Unpack the tuple into variables x, y, z and return their sum',
    setup: 'point = (10, 20, 30)',
    setupCode: 'point = (10, 20, 30)',
    expected: 60,
    sample: 'x, y, z = point; x + y + z',
    hints: ['Use tuple unpacking: a, b, c = tuple'],
    validPatterns: [/\w+\s*,\s*\w+\s*,\s*\w+\s*=\s*point/, /sum\s*\(\s*point\s*\)/],
    tags: ['tuple', 'unpacking'],
  },

  // ============================================================
  // GENERATOR PROBLEMS
  // ============================================================
  {
    id: 'py-gen-001',
    category: 'generator',
    difficulty: 'medium',
    title: 'Generator Expression Sum',
    text: 'Use a generator expression to sum squares of numbers from 1 to 5',
    setup: '# Sum of squares using generator',
    setupCode: '# Sum of squares using generator',
    expected: 55,
    sample: 'sum(x**2 for x in range(1, 6))',
    hints: [
      'Generator expressions use parentheses: (expr for x in iterable)',
      'More memory efficient than list comprehensions',
    ],
    validPatterns: [
      /sum\s*\(\s*\w+\s*\*\*\s*2\s+for\s+\w+\s+in\s+range\s*\(\s*1\s*,\s*6\s*\)\s*\)/,
      /sum\s*\(\s*\[\s*\w+\s*\*\*\s*2\s+for\s+\w+\s+in\s+range\s*\(\s*1\s*,\s*6\s*\)\s*\]\s*\)/,
    ],
    tags: ['generator', 'sum'],
  },
  {
    id: 'py-gen-002',
    category: 'generator',
    difficulty: 'medium',
    title: 'Generator with Condition',
    text: 'Use a generator expression to find the maximum of even numbers',
    setup: 'nums = [1, 4, 2, 8, 5, 7, 6]',
    setupCode: 'nums = [1, 4, 2, 8, 5, 7, 6]',
    expected: 8,
    sample: 'max(x for x in nums if x % 2 == 0)',
    hints: ['Generator expressions can include conditions'],
    validPatterns: [/max\s*\(\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*%\s*2\s*==\s*0\s*\)/],
    tags: ['generator', 'max', 'filter'],
  },

  // ============================================================
  // LIST COMPREHENSIONS - Complex Filtering & Nested
  // ============================================================
  {
    id: 'py-list-033',
    category: 'list',
    difficulty: 'easy',
    title: 'Filter Strings by Length',
    text: 'Keep only words with more than 4 characters',
    setup: 'words = ["cat", "elephant", "dog", "butterfly", "ant"]',
    setupCode: 'words = ["cat", "elephant", "dog", "butterfly", "ant"]',
    expected: ['elephant', 'butterfly'],
    sample: '[w for w in words if len(w) > 4]',
    hints: ['Use len() in the condition of your list comprehension'],
    validPatterns: [/\[\s*\w+\s+for\s+\w+\s+in\s+words\s+if\s+len\s*\(\s*\w+\s*\)\s*>\s*4\s*\]/],
    tags: ['list-comprehension', 'filter', 'string'],
  },
  {
    id: 'py-list-034',
    category: 'list',
    difficulty: 'medium',
    title: 'Filter with Multiple Conditions',
    text: 'Keep only numbers that are even AND greater than 5',
    setup: 'nums = [1, 2, 6, 7, 8, 3, 10, 4, 12]',
    setupCode: 'nums = [1, 2, 6, 7, 8, 3, 10, 4, 12]',
    expected: [6, 8, 10, 12],
    sample: '[x for x in nums if x % 2 == 0 and x > 5]',
    hints: ['Combine conditions with "and" in the if clause'],
    validPatterns: [
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*%\s*2\s*==\s*0\s+and\s+\w+\s*>\s*5\s*\]/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*>\s*5\s+and\s+\w+\s*%\s*2\s*==\s*0\s*\]/,
    ],
    tags: ['list-comprehension', 'filter', 'multiple-conditions'],
  },
  {
    id: 'py-list-035',
    category: 'list',
    difficulty: 'medium',
    title: 'Nested Comprehension - Pairs',
    text: 'Create all pairs (i, j) where i is from [1,2] and j is from [3,4]',
    setup: '# Create pairs from two ranges',
    setupCode: '# Create pairs from two ranges',
    expected: [
      [1, 3],
      [1, 4],
      [2, 3],
      [2, 4],
    ],
    sample: '[(i, j) for i in [1, 2] for j in [3, 4]]',
    hints: [
      'Use two for clauses in the list comprehension',
      'The first for is the outer loop, the second is the inner loop',
    ],
    validPatterns: [
      /\[\s*\(\s*\w+\s*,\s*\w+\s*\)\s+for\s+\w+\s+in\s+\[\s*1\s*,\s*2\s*\]\s+for\s+\w+\s+in\s+\[\s*3\s*,\s*4\s*\]\s*\]/,
    ],
    tags: ['list-comprehension', 'nested', 'pairs'],
  },
  {
    id: 'py-list-036',
    category: 'list',
    difficulty: 'hard',
    title: 'Transpose Matrix',
    text: 'Transpose the 3x3 matrix (swap rows and columns)',
    setup: 'matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]',
    setupCode: 'matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]',
    expected: [
      [1, 4, 7],
      [2, 5, 8],
      [3, 6, 9],
    ],
    sample: '[[row[i] for row in matrix] for i in range(3)]',
    hints: [
      'Use nested list comprehension',
      'Outer loop iterates over column indices',
      'Inner loop collects elements from each row at that index',
    ],
    validPatterns: [
      /\[\s*\[\s*\w+\s*\[\s*\w+\s*\]\s+for\s+\w+\s+in\s+matrix\s*\]\s+for\s+\w+\s+in\s+range\s*\(\s*3\s*\)\s*\]/,
      /list\s*\(\s*map\s*\(\s*list\s*,\s*zip\s*\(\s*\*matrix\s*\)\s*\)\s*\)/,
      /\[\s*list\s*\(\s*\w+\s*\)\s+for\s+\w+\s+in\s+zip\s*\(\s*\*matrix\s*\)\s*\]/,
    ],
    tags: ['list-comprehension', 'nested', 'matrix', 'advanced'],
  },
  {
    id: 'py-list-037',
    category: 'list',
    difficulty: 'hard',
    title: 'Conditional Expression in Comprehension',
    text: 'Replace negative numbers with 0, keep positive numbers unchanged',
    setup: 'nums = [-5, 3, -2, 8, -1, 6]',
    setupCode: 'nums = [-5, 3, -2, 8, -1, 6]',
    expected: [0, 3, 0, 8, 0, 6],
    sample: '[x if x > 0 else 0 for x in nums]',
    hints: [
      'Use conditional expression: value_if_true if condition else value_if_false',
      'This goes BEFORE the for clause',
    ],
    validPatterns: [
      /\[\s*\w+\s+if\s+\w+\s*>\s*0\s+else\s+0\s+for\s+\w+\s+in\s+nums\s*\]/,
      /\[\s*max\s*\(\s*0\s*,\s*\w+\s*\)\s+for\s+\w+\s+in\s+nums\s*\]/,
      /\[\s*max\s*\(\s*\w+\s*,\s*0\s*\)\s+for\s+\w+\s+in\s+nums\s*\]/,
    ],
    tags: ['list-comprehension', 'conditional', 'ternary'],
  },

  // ============================================================
  // DICTIONARY METHODS - setdefault, pop, update, items, fromkeys
  // ============================================================
  {
    id: 'py-dict-015',
    category: 'dict',
    difficulty: 'easy',
    title: 'Iterate Over Items',
    text: 'Create a list of formatted strings "key: value" from the dictionary',
    setup: 'data = {"name": "Alice", "age": 30}',
    setupCode: 'data = {"name": "Alice", "age": 30}',
    expected: ['name: Alice', 'age: 30'],
    sample: '[f"{k}: {v}" for k, v in data.items()]',
    hints: ['Use items() to get key-value pairs', 'Unpack into k, v in the for clause'],
    validPatterns: [
      /\[\s*f["']\{\w+\}:\s*\{\w+\}["']\s+for\s+\w+\s*,\s*\w+\s+in\s+data\.items\s*\(\s*\)\s*\]/,
      /\[\s*\w+\s*\+\s*["']:\s*["']\s*\+\s*str\s*\(\s*\w+\s*\)\s+for\s+\w+\s*,\s*\w+\s+in\s+data\.items\s*\(\s*\)\s*\]/,
    ],
    tags: ['dict-method', 'items', 'iteration'],
  },
  {
    id: 'py-dict-016',
    category: 'dict',
    difficulty: 'medium',
    title: 'Pop with Default',
    text: 'Remove and return the value for "country", returning "USA" if key not found',
    setup: 'person = {"name": "Alice", "age": 30}',
    setupCode: 'person = {"name": "Alice", "age": 30}',
    expected: 'USA',
    sample: 'person.pop("country", "USA")',
    hints: ['pop() accepts a default value as second argument'],
    validPatterns: [/person\.pop\s*\(\s*["']country["']\s*,\s*["']USA["']\s*\)/],
    tags: ['dict-method', 'pop', 'default'],
  },
  {
    id: 'py-dict-017',
    category: 'dict',
    difficulty: 'medium',
    title: 'Update Multiple Values',
    text: 'Update the dictionary with new city and add a country field',
    setup: 'person = {"name": "Alice", "city": "NYC"}',
    setupCode: 'person = {"name": "Alice", "city": "NYC"}',
    expected: { name: 'Alice', city: 'Boston', country: 'USA' },
    sample: 'person.update({"city": "Boston", "country": "USA"}) or person',
    hints: ['update() can take a dictionary or keyword arguments'],
    validPatterns: [
      /person\.update\s*\(\s*\{.*["']city["'].*["']Boston["'].*\}\s*\)/,
      /person\.update\s*\(\s*city\s*=\s*["']Boston["'].*country\s*=\s*["']USA["']\s*\)/,
    ],
    tags: ['dict-method', 'update'],
  },
  {
    id: 'py-dict-018',
    category: 'dict',
    difficulty: 'easy',
    title: 'Create Dict with Default Value',
    text: 'Create a dictionary with keys "a", "b", "c" all set to empty list []',
    setup: 'keys = ["a", "b", "c"]',
    setupCode: 'keys = ["a", "b", "c"]',
    expected: { a: [], b: [], c: [] },
    sample: '{k: [] for k in keys}',
    hints: [
      'dict.fromkeys() shares the same mutable object',
      'Use dict comprehension for independent lists',
    ],
    validPatterns: [/\{\s*\w+\s*:\s*\[\s*\]\s+for\s+\w+\s+in\s+keys\s*\}/],
    tags: ['dict-comprehension', 'initialization'],
  },
  {
    id: 'py-dict-019',
    category: 'dict',
    difficulty: 'medium',
    title: 'Setdefault for Grouping',
    text: 'Use setdefault to group words by their first letter, return the dict',
    setup: 'words = ["apple", "ant", "banana", "cherry"]\ngroups = {}',
    setupCode: 'words = ["apple", "ant", "banana", "cherry"]\ngroups = {}',
    expected: { a: ['apple', 'ant'], b: ['banana'], c: ['cherry'] },
    sample: '[groups.setdefault(w[0], []).append(w) for w in words]; groups',
    hints: [
      'setdefault returns the value if key exists, or sets and returns default',
      'The returned list can be appended to directly',
    ],
    validPatterns: [
      /setdefault\s*\(\s*\w+\s*\[\s*0\s*\]\s*,\s*\[\s*\]\s*\)\.append/,
      /groups\[.*\].*=.*groups\.get\(.*,\s*\[\s*\]\)/,
    ],
    tags: ['dict-method', 'setdefault', 'grouping'],
  },

  // ============================================================
  // SET OPERATIONS - symmetric_difference, issubset, issuperset
  // ============================================================
  {
    id: 'py-set-010',
    category: 'set',
    difficulty: 'easy',
    title: 'Proper Subset Check',
    text: 'Check if set1 is a proper subset of set2 (subset but not equal)',
    setup: 'set1 = {1, 2}\nset2 = {1, 2, 3, 4}',
    setupCode: 'set1 = {1, 2}\nset2 = {1, 2, 3, 4}',
    expected: true,
    sample: 'set1 < set2',
    hints: ['Use < operator for proper subset (not equal)', 'Or combine issubset with !='],
    validPatterns: [/set1\s*<\s*set2/, /set1\.issubset\s*\(\s*set2\s*\)\s*and\s*set1\s*!=\s*set2/],
    tags: ['set-method', 'subset', 'comparison'],
  },
  {
    id: 'py-set-011',
    category: 'set',
    difficulty: 'medium',
    title: 'Symmetric Difference Update',
    text: 'Get elements in either set but not both, sorted as a list',
    setup: 'a = {1, 2, 3, 4, 5}\nb = {4, 5, 6, 7, 8}',
    setupCode: 'a = {1, 2, 3, 4, 5}\nb = {4, 5, 6, 7, 8}',
    expected: [1, 2, 3, 6, 7, 8],
    sample: 'sorted(a.symmetric_difference(b))',
    hints: [
      'symmetric_difference returns elements in either but not both',
      'Use sorted() to get a list',
    ],
    validPatterns: [
      /sorted\s*\(\s*a\.symmetric_difference\s*\(\s*b\s*\)\s*\)/,
      /sorted\s*\(\s*a\s*\^\s*b\s*\)/,
    ],
    tags: ['set-method', 'symmetric_difference'],
  },
  {
    id: 'py-set-012',
    category: 'set',
    difficulty: 'medium',
    title: 'Check Superset with Operator',
    text: 'Check if all_skills contains all required_skills using operator',
    setup:
      'all_skills = {"python", "java", "sql", "docker", "git"}\nrequired_skills = {"python", "sql"}',
    setupCode:
      'all_skills = {"python", "java", "sql", "docker", "git"}\nrequired_skills = {"python", "sql"}',
    expected: true,
    sample: 'all_skills >= required_skills',
    hints: ['Use >= for superset check', 'Or use issuperset() method'],
    validPatterns: [
      /all_skills\s*>=\s*required_skills/,
      /all_skills\.issuperset\s*\(\s*required_skills\s*\)/,
      /required_skills\s*<=\s*all_skills/,
      /required_skills\.issubset\s*\(\s*all_skills\s*\)/,
    ],
    tags: ['set-method', 'issuperset', 'comparison'],
  },

  // ============================================================
  // STRING METHODS - format, f-strings, zfill, center, partition
  // ============================================================
  {
    id: 'py-str-027',
    category: 'string',
    difficulty: 'easy',
    title: 'Zero Padding',
    text: 'Pad the number string with zeros to make it 5 characters wide',
    setup: 'num_str = "42"',
    setupCode: 'num_str = "42"',
    expected: '00042',
    sample: 'num_str.zfill(5)',
    hints: ['Use zfill() to pad with leading zeros'],
    validPatterns: [/num_str\.zfill\s*\(\s*5\s*\)/, /num_str\.rjust\s*\(\s*5\s*,\s*["']0["']\s*\)/],
    tags: ['string-method', 'zfill', 'padding'],
  },
  {
    id: 'py-str-028',
    category: 'string',
    difficulty: 'easy',
    title: 'Left and Right Padding',
    text: 'Right-justify the text in a field of width 10, padded with dashes',
    setup: 'text = "Python"',
    setupCode: 'text = "Python"',
    expected: '----Python',
    sample: 'text.rjust(10, "-")',
    hints: ['Use rjust() with width and fill character'],
    validPatterns: [/text\.rjust\s*\(\s*10\s*,\s*["']-["']\s*\)/],
    tags: ['string-method', 'rjust', 'padding'],
  },
  {
    id: 'py-str-029',
    category: 'string',
    difficulty: 'medium',
    title: 'Format String with Named Placeholders',
    text: 'Format the template string with the given values',
    setup: 'template = "{name} scored {score} points"',
    setupCode: 'template = "{name} scored {score} points"',
    expected: 'Alice scored 95 points',
    sample: 'template.format(name="Alice", score=95)',
    hints: ['Use format() with keyword arguments matching placeholder names'],
    validPatterns: [
      /template\.format\s*\(\s*name\s*=\s*["']Alice["']\s*,\s*score\s*=\s*95\s*\)/,
      /template\.format\s*\(\s*score\s*=\s*95\s*,\s*name\s*=\s*["']Alice["']\s*\)/,
    ],
    tags: ['string-method', 'format', 'named-placeholders'],
  },
  {
    id: 'py-str-030',
    category: 'string',
    difficulty: 'medium',
    title: 'F-String Number Formatting',
    text: 'Format the price as currency with 2 decimal places: "$1234.50"',
    setup: 'price = 1234.5',
    setupCode: 'price = 1234.5',
    expected: '$1234.50',
    sample: 'f"${price:.2f}"',
    hints: ['Use :.2f format specifier for 2 decimal places', 'The $ is just a literal character'],
    validPatterns: [/f["']\$\{price:\.2f\}["']/, /["']\$\{:\.2f\}["']\.format\s*\(\s*price\s*\)/],
    tags: ['f-string', 'formatting', 'numbers'],
  },
  {
    id: 'py-str-031',
    category: 'string',
    difficulty: 'medium',
    title: 'Partition and Unpack',
    text: 'Split the URL at "://" and return the protocol (e.g., "https")',
    setup: 'url = "https://www.example.com"',
    setupCode: 'url = "https://www.example.com"',
    expected: 'https',
    sample: 'url.partition("://")[0]',
    hints: [
      'partition() returns (before, separator, after)',
      'Index 0 gets the part before separator',
    ],
    validPatterns: [
      /url\.partition\s*\(\s*["'][:/]{3}["']\s*\)\s*\[\s*0\s*\]/,
      /url\.split\s*\(\s*["'][:/]{3}["']\s*\)\s*\[\s*0\s*\]/,
    ],
    tags: ['string-method', 'partition', 'url'],
  },

  // ============================================================
  // ITERTOOLS - chain, combinations, permutations, groupby
  // ============================================================
  {
    id: 'py-itertools-001',
    category: 'itertools',
    difficulty: 'easy',
    title: 'Chain Multiple Iterables',
    text: 'Combine three lists into one using itertools.chain',
    setup: 'from itertools import chain\na = [1, 2]\nb = [3, 4]\nc = [5, 6]',
    setupCode: 'from itertools import chain\na = [1, 2]\nb = [3, 4]\nc = [5, 6]',
    expected: [1, 2, 3, 4, 5, 6],
    sample: 'list(chain(a, b, c))',
    hints: ['chain() takes multiple iterables and yields items from each in order'],
    validPatterns: [/list\s*\(\s*chain\s*\(\s*a\s*,\s*b\s*,\s*c\s*\)\s*\)/],
    tags: ['itertools', 'chain'],
  },
  {
    id: 'py-itertools-002',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Combinations of Two',
    text: 'Get all 2-element combinations from the list',
    setup: 'from itertools import combinations\nitems = ["a", "b", "c"]',
    setupCode: 'from itertools import combinations\nitems = ["a", "b", "c"]',
    expected: [
      ['a', 'b'],
      ['a', 'c'],
      ['b', 'c'],
    ],
    sample: 'list(combinations(items, 2))',
    hints: [
      'combinations(iterable, r) gives r-length tuples in sorted order',
      'No repeated elements',
    ],
    validPatterns: [/list\s*\(\s*combinations\s*\(\s*items\s*,\s*2\s*\)\s*\)/],
    tags: ['itertools', 'combinations'],
  },
  {
    id: 'py-itertools-003',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Permutations of Two',
    text: 'Get all 2-element permutations from the list',
    setup: 'from itertools import permutations\nitems = ["a", "b", "c"]',
    setupCode: 'from itertools import permutations\nitems = ["a", "b", "c"]',
    expected: [
      ['a', 'b'],
      ['a', 'c'],
      ['b', 'a'],
      ['b', 'c'],
      ['c', 'a'],
      ['c', 'b'],
    ],
    sample: 'list(permutations(items, 2))',
    hints: [
      'permutations(iterable, r) gives r-length tuples, all orderings',
      'Order matters in permutations',
    ],
    validPatterns: [/list\s*\(\s*permutations\s*\(\s*items\s*,\s*2\s*\)\s*\)/],
    tags: ['itertools', 'permutations'],
  },
  {
    id: 'py-itertools-004',
    category: 'itertools',
    difficulty: 'hard',
    title: 'Group Consecutive Elements',
    text: 'Group consecutive identical characters, return list of (char, count) tuples',
    setup: 'from itertools import groupby\ntext = "aaabbcccc"',
    setupCode: 'from itertools import groupby\ntext = "aaabbcccc"',
    expected: [
      ['a', 3],
      ['b', 2],
      ['c', 4],
    ],
    sample: '[(k, len(list(g))) for k, g in groupby(text)]',
    hints: [
      'groupby() groups consecutive identical elements',
      'Returns (key, group_iterator) pairs',
      'Convert group to list and count with len()',
    ],
    validPatterns: [
      /\[\s*\(\s*\w+\s*,\s*len\s*\(\s*list\s*\(\s*\w+\s*\)\s*\)\s*\)\s+for\s+\w+\s*,\s*\w+\s+in\s+groupby\s*\(\s*text\s*\)\s*\]/,
      /\[\s*\(\s*\w+\s*,\s*sum\s*\(\s*1\s+for\s+_\s+in\s+\w+\s*\)\s*\)\s+for\s+\w+\s*,\s*\w+\s+in\s+groupby\s*\(\s*text\s*\)\s*\]/,
    ],
    tags: ['itertools', 'groupby', 'advanced'],
  },
  {
    id: 'py-itertools-005',
    category: 'itertools',
    difficulty: 'hard',
    title: 'Product of Iterables',
    text: 'Get cartesian product of colors and sizes',
    setup: 'from itertools import product\ncolors = ["red", "blue"]\nsizes = ["S", "M", "L"]',
    setupCode: 'from itertools import product\ncolors = ["red", "blue"]\nsizes = ["S", "M", "L"]',
    expected: [
      ['red', 'S'],
      ['red', 'M'],
      ['red', 'L'],
      ['blue', 'S'],
      ['blue', 'M'],
      ['blue', 'L'],
    ],
    sample: 'list(product(colors, sizes))',
    hints: ['product() returns cartesian product of iterables', 'Equivalent to nested for loops'],
    validPatterns: [
      /list\s*\(\s*product\s*\(\s*colors\s*,\s*sizes\s*\)\s*\)/,
      /\[\s*\(\s*\w+\s*,\s*\w+\s*\)\s+for\s+\w+\s+in\s+colors\s+for\s+\w+\s+in\s+sizes\s*\]/,
    ],
    tags: ['itertools', 'product', 'cartesian'],
  },
  // ============================================================
  // FUNCTIONAL PROGRAMMING - functools, operator, lambdas, higher-order functions
  // ============================================================
  // EASY (8 problems)
  {
    id: 'py-func-001',
    category: 'functional',
    difficulty: 'easy',
    title: 'Simple Lambda Square',
    text: 'Create a lambda function that squares a number and apply it to 7',
    setup: '# Create and call a lambda',
    setupCode: '# Create and call a lambda',
    expected: 49,
    sample: '(lambda x: x ** 2)(7)',
    hints: [
      'Lambda syntax: lambda arguments: expression',
      'You can immediately call a lambda by wrapping it in parentheses',
    ],
    validPatterns: [
      /\(\s*lambda\s+\w+\s*:\s*\w+\s*\*\*\s*2\s*\)\s*\(\s*7\s*\)/,
      /\(\s*lambda\s+\w+\s*:\s*\w+\s*\*\s*\w+\s*\)\s*\(\s*7\s*\)/,
    ],
    tags: ['lambda', 'basic', 'functional'],
  },
  {
    id: 'py-func-002',
    category: 'functional',
    difficulty: 'easy',
    title: 'Map with Lambda Add 10',
    text: 'Use map() with a lambda to add 10 to each number',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: [11, 12, 13, 14, 15],
    sample: 'list(map(lambda x: x + 10, nums))',
    hints: ['map() applies a function to each element', 'Convert the result to a list'],
    validPatterns: [
      /list\s*\(\s*map\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*\+\s*10\s*,\s*nums\s*\)\s*\)/,
      /\[\s*\w+\s*\+\s*10\s+for\s+\w+\s+in\s+nums\s*\]/,
    ],
    tags: ['map', 'lambda', 'functional'],
  },
  {
    id: 'py-func-003',
    category: 'functional',
    difficulty: 'easy',
    title: 'Filter with Lambda Positive',
    text: 'Use filter() with a lambda to get only positive numbers',
    setup: 'nums = [-3, -1, 0, 2, 5, -4, 8]',
    setupCode: 'nums = [-3, -1, 0, 2, 5, -4, 8]',
    expected: [2, 5, 8],
    sample: 'list(filter(lambda x: x > 0, nums))',
    hints: [
      'filter() keeps elements where the function returns True',
      'Positive numbers are greater than 0',
    ],
    validPatterns: [
      /list\s*\(\s*filter\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*>\s*0\s*,\s*nums\s*\)\s*\)/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*>\s*0\s*\]/,
    ],
    tags: ['filter', 'lambda', 'functional'],
  },
  {
    id: 'py-func-004',
    category: 'functional',
    difficulty: 'easy',
    title: 'Reduce Sum',
    text: 'Use functools.reduce to sum all numbers in the list',
    setup: 'from functools import reduce\nnums = [1, 2, 3, 4, 5]',
    setupCode: 'from functools import reduce\nnums = [1, 2, 3, 4, 5]',
    expected: 15,
    sample: 'reduce(lambda a, b: a + b, nums)',
    hints: [
      'reduce() applies a function cumulatively to items',
      'The lambda takes two arguments: accumulator and current value',
    ],
    validPatterns: [
      /reduce\s*\(\s*lambda\s+\w+\s*,\s*\w+\s*:\s*\w+\s*\+\s*\w+\s*,\s*nums\s*\)/,
      /reduce\s*\(\s*operator\.add\s*,\s*nums\s*\)/,
    ],
    tags: ['reduce', 'functools', 'lambda', 'functional'],
  },
  {
    id: 'py-func-005',
    category: 'functional',
    difficulty: 'easy',
    title: 'Operator Module Add',
    text: 'Use operator.add to sum two numbers (3 and 5)',
    setup: 'import operator',
    setupCode: 'import operator',
    expected: 8,
    sample: 'operator.add(3, 5)',
    hints: [
      'operator module provides function equivalents of operators',
      'operator.add(a, b) is equivalent to a + b',
    ],
    validPatterns: [/operator\.add\s*\(\s*3\s*,\s*5\s*\)/],
    tags: ['operator', 'functional', 'basic'],
  },
  {
    id: 'py-func-006',
    category: 'functional',
    difficulty: 'easy',
    title: 'Zip Two Lists',
    text: 'Zip names and scores together into a list of tuples',
    setup: 'names = ["Alice", "Bob", "Charlie"]\nscores = [85, 92, 78]',
    setupCode: 'names = ["Alice", "Bob", "Charlie"]\nscores = [85, 92, 78]',
    expected: [
      ['Alice', 85],
      ['Bob', 92],
      ['Charlie', 78],
    ],
    sample: 'list(zip(names, scores))',
    hints: ['zip() pairs elements from multiple iterables', 'Convert to list to see all pairs'],
    validPatterns: [
      /list\s*\(\s*zip\s*\(\s*names\s*,\s*scores\s*\)\s*\)/,
      /\[\s*\(\s*\w+\s*,\s*\w+\s*\)\s+for\s+\w+\s*,\s*\w+\s+in\s+zip\s*\(\s*names\s*,\s*scores\s*\)\s*\]/,
    ],
    tags: ['zip', 'functional', 'basic'],
  },
  {
    id: 'py-func-007',
    category: 'functional',
    difficulty: 'easy',
    title: 'Generator Expression Sum',
    text: 'Use a generator expression to sum squares of numbers 1-5',
    setup: '# Use a generator expression inside sum()',
    setupCode: '# Use a generator expression inside sum()',
    expected: 55,
    sample: 'sum(x**2 for x in range(1, 6))',
    hints: [
      'Generator expressions use parentheses, not brackets',
      'They are memory efficient for large sequences',
      'sum() can directly consume a generator',
    ],
    validPatterns: [
      /sum\s*\(\s*\w+\s*\*\*\s*2\s+for\s+\w+\s+in\s+range\s*\(\s*1\s*,\s*6\s*\)\s*\)/,
      /sum\s*\(\s*\w+\s*\*\s*\w+\s+for\s+\w+\s+in\s+range\s*\(\s*1\s*,\s*6\s*\)\s*\)/,
    ],
    tags: ['generator', 'functional', 'memory-efficient'],
  },
  {
    id: 'py-func-008',
    category: 'functional',
    difficulty: 'easy',
    title: 'Operator Itemgetter',
    text: 'Use operator.itemgetter to extract the second element from each tuple',
    setup: 'from operator import itemgetter\ndata = [(1, "a"), (2, "b"), (3, "c")]',
    setupCode: 'from operator import itemgetter\ndata = [(1, "a"), (2, "b"), (3, "c")]',
    expected: ['a', 'b', 'c'],
    sample: 'list(map(itemgetter(1), data))',
    hints: [
      'itemgetter(n) creates a function that gets the nth item',
      'Use with map() to apply to each element',
    ],
    validPatterns: [
      /list\s*\(\s*map\s*\(\s*itemgetter\s*\(\s*1\s*\)\s*,\s*data\s*\)\s*\)/,
      /\[\s*\w+\s*\[\s*1\s*\]\s+for\s+\w+\s+in\s+data\s*\]/,
    ],
    tags: ['operator', 'itemgetter', 'functional'],
  },
  // MEDIUM (12 problems)
  {
    id: 'py-func-009',
    category: 'functional',
    difficulty: 'medium',
    title: 'Partial Function Double',
    text: 'Use functools.partial to create a doubling function from mul',
    setup: 'from functools import partial\nfrom operator import mul\n# Create double using partial',
    setupCode: 'from functools import partial\nfrom operator import mul',
    expected: 14,
    sample: 'partial(mul, 2)(7)',
    hints: [
      'partial() freezes some arguments of a function',
      'partial(mul, 2) creates a function that multiplies by 2',
    ],
    validPatterns: [
      /partial\s*\(\s*mul\s*,\s*2\s*\)\s*\(\s*7\s*\)/,
      /partial\s*\(\s*mul\s*,\s*2\s*\)/,
    ],
    tags: ['partial', 'functools', 'functional'],
  },
  {
    id: 'py-func-010',
    category: 'functional',
    difficulty: 'medium',
    title: 'Reduce with Initial Value',
    text: 'Use reduce with an initial value of 100 to subtract all numbers',
    setup: 'from functools import reduce\nnums = [10, 5, 3]',
    setupCode: 'from functools import reduce\nnums = [10, 5, 3]',
    expected: 82,
    sample: 'reduce(lambda a, b: a - b, nums, 100)',
    hints: [
      'reduce() accepts an optional third argument as initial value',
      'The initial value becomes the first accumulator value',
    ],
    validPatterns: [
      /reduce\s*\(\s*lambda\s+\w+\s*,\s*\w+\s*:\s*\w+\s*-\s*\w+\s*,\s*nums\s*,\s*100\s*\)/,
      /reduce\s*\(\s*operator\.sub\s*,\s*nums\s*,\s*100\s*\)/,
    ],
    tags: ['reduce', 'functools', 'functional'],
  },
  {
    id: 'py-func-011',
    category: 'functional',
    difficulty: 'medium',
    title: 'Map Multiple Iterables',
    text: 'Use map() with a lambda to add corresponding elements from two lists',
    setup: 'list1 = [1, 2, 3]\nlist2 = [10, 20, 30]',
    setupCode: 'list1 = [1, 2, 3]\nlist2 = [10, 20, 30]',
    expected: [11, 22, 33],
    sample: 'list(map(lambda a, b: a + b, list1, list2))',
    hints: [
      'map() can take multiple iterables',
      'The lambda should accept as many arguments as iterables',
    ],
    validPatterns: [
      /list\s*\(\s*map\s*\(\s*lambda\s+\w+\s*,\s*\w+\s*:\s*\w+\s*\+\s*\w+\s*,\s*list1\s*,\s*list2\s*\)\s*\)/,
      /list\s*\(\s*map\s*\(\s*operator\.add\s*,\s*list1\s*,\s*list2\s*\)\s*\)/,
      /\[\s*\w+\s*\+\s*\w+\s+for\s+\w+\s*,\s*\w+\s+in\s+zip\s*\(\s*list1\s*,\s*list2\s*\)\s*\]/,
    ],
    tags: ['map', 'lambda', 'functional', 'multiple-iterables'],
  },
  {
    id: 'py-func-012',
    category: 'functional',
    difficulty: 'medium',
    title: 'Starmap Apply Tuples',
    text: 'Use itertools.starmap to apply pow to list of (base, exp) tuples',
    setup: 'from itertools import starmap\npairs = [(2, 3), (3, 2), (10, 2)]',
    setupCode: 'from itertools import starmap\npairs = [(2, 3), (3, 2), (10, 2)]',
    expected: [8, 9, 100],
    sample: 'list(starmap(pow, pairs))',
    hints: [
      'starmap() unpacks each tuple as arguments to the function',
      'Similar to map() but for pre-packaged argument tuples',
    ],
    validPatterns: [
      /list\s*\(\s*starmap\s*\(\s*pow\s*,\s*pairs\s*\)\s*\)/,
      /\[\s*pow\s*\(\s*\*\s*\w+\s*\)\s+for\s+\w+\s+in\s+pairs\s*\]/,
      /\[\s*\w+\s*\*\*\s*\w+\s+for\s+\w+\s*,\s*\w+\s+in\s+pairs\s*\]/,
    ],
    tags: ['starmap', 'itertools', 'functional'],
  },
  {
    id: 'py-func-013',
    category: 'functional',
    difficulty: 'medium',
    title: 'Closure Counter',
    text: 'Create a closure that counts how many times it has been called. Call it 3 times and return the count.',
    setup:
      'def make_counter():\n    count = [0]\n    def counter():\n        count[0] += 1\n        return count[0]\n    return counter\n\nc = make_counter()',
    setupCode:
      'def make_counter():\n    count = [0]\n    def counter():\n        count[0] += 1\n        return count[0]\n    return counter\n\nc = make_counter()',
    expected: 3,
    sample: 'c(); c(); c()',
    hints: [
      'Call the closure function three times',
      'Each call increments and returns the count',
      'The last call returns 3',
    ],
    validPatterns: [
      /c\s*\(\s*\)\s*;\s*c\s*\(\s*\)\s*;\s*c\s*\(\s*\)/,
      /\[c\s*\(\s*\)\s+for\s+_\s+in\s+range\s*\(\s*3\s*\)\s*\]\s*\[\s*-1\s*\]/,
    ],
    tags: ['closure', 'functional', 'state'],
  },
  {
    id: 'py-func-014',
    category: 'functional',
    difficulty: 'medium',
    title: 'Reduce Product',
    text: 'Use reduce with operator.mul to calculate the product of all numbers',
    setup: 'from functools import reduce\nimport operator\nnums = [1, 2, 3, 4, 5]',
    setupCode: 'from functools import reduce\nimport operator\nnums = [1, 2, 3, 4, 5]',
    expected: 120,
    sample: 'reduce(operator.mul, nums)',
    hints: [
      'operator.mul is a function that multiplies two numbers',
      'reduce() will apply it cumulatively: 1*2*3*4*5',
    ],
    validPatterns: [
      /reduce\s*\(\s*operator\.mul\s*,\s*nums\s*\)/,
      /reduce\s*\(\s*lambda\s+\w+\s*,\s*\w+\s*:\s*\w+\s*\*\s*\w+\s*,\s*nums\s*\)/,
    ],
    tags: ['reduce', 'operator', 'functools', 'functional'],
  },
  {
    id: 'py-func-015',
    category: 'functional',
    difficulty: 'medium',
    title: 'Filter Map Chain',
    text: 'Filter even numbers then double them using functional chaining',
    setup: 'nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]',
    setupCode: 'nums = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]',
    expected: [4, 8, 12, 16, 20],
    sample: 'list(map(lambda x: x * 2, filter(lambda x: x % 2 == 0, nums)))',
    hints: [
      'Chain filter() and map() together',
      'filter() first, then map() on the result',
      'Or use a single list comprehension',
    ],
    validPatterns: [
      /list\s*\(\s*map\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*\*\s*2\s*,\s*filter\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*%\s*2\s*==\s*0\s*,\s*nums\s*\)\s*\)\s*\)/,
      /\[\s*\w+\s*\*\s*2\s+for\s+\w+\s+in\s+nums\s+if\s+\w+\s*%\s*2\s*==\s*0\s*\]/,
    ],
    tags: ['filter', 'map', 'functional', 'chaining'],
  },
  {
    id: 'py-func-016',
    category: 'functional',
    difficulty: 'medium',
    title: 'Zip with Index Enumerate Style',
    text: 'Use zip with range to create indexed pairs (like enumerate)',
    setup: 'letters = ["a", "b", "c", "d"]',
    setupCode: 'letters = ["a", "b", "c", "d"]',
    expected: [
      [0, 'a'],
      [1, 'b'],
      [2, 'c'],
      [3, 'd'],
    ],
    sample: 'list(zip(range(len(letters)), letters))',
    hints: [
      'zip() can pair indices from range() with elements',
      'This is similar to what enumerate() does',
    ],
    validPatterns: [
      /list\s*\(\s*zip\s*\(\s*range\s*\(\s*len\s*\(\s*letters\s*\)\s*\)\s*,\s*letters\s*\)\s*\)/,
      /list\s*\(\s*enumerate\s*\(\s*letters\s*\)\s*\)/,
      /\[\s*\(\s*\w+\s*,\s*\w+\s*\)\s+for\s+\w+\s*,\s*\w+\s+in\s+enumerate\s*\(\s*letters\s*\)\s*\]/,
    ],
    tags: ['zip', 'range', 'functional', 'enumerate'],
  },
  {
    id: 'py-func-017',
    category: 'functional',
    difficulty: 'medium',
    title: 'Operator Attrgetter',
    text: 'Use operator.attrgetter to extract the "name" attribute from objects',
    setup:
      'from operator import attrgetter\nfrom collections import namedtuple\nPerson = namedtuple("Person", ["name", "age"])\npeople = [Person("Alice", 30), Person("Bob", 25), Person("Charlie", 35)]',
    setupCode:
      'from operator import attrgetter\nfrom collections import namedtuple\nPerson = namedtuple("Person", ["name", "age"])\npeople = [Person("Alice", 30), Person("Bob", 25), Person("Charlie", 35)]',
    expected: ['Alice', 'Bob', 'Charlie'],
    sample: 'list(map(attrgetter("name"), people))',
    hints: [
      'attrgetter("attr") creates a function that gets the named attribute',
      'Useful for extracting attributes from objects in map/sorted',
    ],
    validPatterns: [
      /list\s*\(\s*map\s*\(\s*attrgetter\s*\(\s*["']name["']\s*\)\s*,\s*people\s*\)\s*\)/,
      /\[\s*\w+\.name\s+for\s+\w+\s+in\s+people\s*\]/,
    ],
    tags: ['operator', 'attrgetter', 'functional'],
  },
  {
    id: 'py-func-018',
    category: 'functional',
    difficulty: 'medium',
    title: 'Itertools Tee Duplicate',
    text: 'Use itertools.tee to create two independent iterators from one',
    setup: 'from itertools import tee\nnums = iter([1, 2, 3])\niter1, iter2 = tee(nums, 2)',
    setupCode: 'from itertools import tee\nnums = iter([1, 2, 3])\niter1, iter2 = tee(nums, 2)',
    expected: [
      [1, 2, 3],
      [1, 2, 3],
    ],
    sample: '[list(iter1), list(iter2)]',
    hints: [
      'tee() creates independent iterators from one source',
      'Both iterators can be consumed independently',
    ],
    validPatterns: [
      /\[\s*list\s*\(\s*iter1\s*\)\s*,\s*list\s*\(\s*iter2\s*\)\s*\]/,
      /list\s*\(\s*iter1\s*\)\s*,\s*list\s*\(\s*iter2\s*\)/,
    ],
    tags: ['tee', 'itertools', 'functional'],
  },
  {
    id: 'py-func-019',
    category: 'functional',
    difficulty: 'medium',
    title: 'Compose Functions',
    text: 'Create a composed function that first doubles, then adds 1 (applied in that order)',
    setup: 'double = lambda x: x * 2\nadd_one = lambda x: x + 1\n# Apply double then add_one to 5',
    setupCode: 'double = lambda x: x * 2\nadd_one = lambda x: x + 1',
    expected: 11,
    sample: 'add_one(double(5))',
    hints: [
      'Function composition applies functions right to left',
      'double(5) = 10, then add_one(10) = 11',
    ],
    validPatterns: [
      /add_one\s*\(\s*double\s*\(\s*5\s*\)\s*\)/,
      /\(\s*lambda\s+\w+\s*:\s*add_one\s*\(\s*double\s*\(\s*\w+\s*\)\s*\)\s*\)\s*\(\s*5\s*\)/,
    ],
    tags: ['composition', 'lambda', 'functional'],
  },
  {
    id: 'py-func-020',
    category: 'functional',
    difficulty: 'medium',
    title: 'Sorted with Key Function',
    text: 'Sort strings by their length using a key function',
    setup: 'words = ["python", "is", "awesome", "and", "functional"]',
    setupCode: 'words = ["python", "is", "awesome", "and", "functional"]',
    expected: ['is', 'and', 'python', 'awesome', 'functional'],
    sample: 'sorted(words, key=len)',
    hints: [
      'sorted() accepts a key parameter for custom sorting',
      'len function returns string length',
    ],
    validPatterns: [
      /sorted\s*\(\s*words\s*,\s*key\s*=\s*len\s*\)/,
      /sorted\s*\(\s*words\s*,\s*key\s*=\s*lambda\s+\w+\s*:\s*len\s*\(\s*\w+\s*\)\s*\)/,
    ],
    tags: ['sorted', 'key', 'functional'],
  },
  // HARD (5 problems)
  {
    id: 'py-func-021',
    category: 'functional',
    difficulty: 'hard',
    title: 'LRU Cache Fibonacci',
    text: 'Calculate fibonacci(30) using lru_cache decorated function',
    setup:
      'from functools import lru_cache\n\n@lru_cache(maxsize=None)\ndef fib(n):\n    if n < 2:\n        return n\n    return fib(n - 1) + fib(n - 2)',
    setupCode:
      'from functools import lru_cache\n\n@lru_cache(maxsize=None)\ndef fib(n):\n    if n < 2:\n        return n\n    return fib(n - 1) + fib(n - 2)',
    expected: 832040,
    sample: 'fib(30)',
    hints: [
      'lru_cache memoizes function results',
      'Without caching, fibonacci(30) would be extremely slow',
      'Just call fib(30)',
    ],
    validPatterns: [/fib\s*\(\s*30\s*\)/],
    tags: ['lru_cache', 'functools', 'memoization', 'functional'],
  },
  {
    id: 'py-func-022',
    category: 'functional',
    difficulty: 'hard',
    title: 'Decorator with Wraps',
    text: 'Create a decorator that logs function calls while preserving function metadata',
    setup:
      'from functools import wraps\n\ndef logger(func):\n    @wraps(func)\n    def wrapper(*args, **kwargs):\n        print(f"Calling {func.__name__}")\n        return func(*args, **kwargs)\n    return wrapper\n\n@logger\ndef greet(name):\n    """Greet someone by name."""\n    return f"Hello, {name}!"\n\n# Return the docstring of greet',
    setupCode:
      'from functools import wraps\n\ndef logger(func):\n    @wraps(func)\n    def wrapper(*args, **kwargs):\n        print(f"Calling {func.__name__}")\n        return func(*args, **kwargs)\n    return wrapper\n\n@logger\ndef greet(name):\n    """Greet someone by name."""\n    return f"Hello, {name}!"',
    expected: 'Greet someone by name.',
    sample: 'greet.__doc__',
    hints: [
      '@wraps preserves the original function metadata',
      'Without @wraps, __doc__ would be None',
      'Access __doc__ attribute to get the docstring',
    ],
    validPatterns: [/greet\.__doc__/, /getattr\s*\(\s*greet\s*,\s*["']__doc__["']\s*\)/],
    tags: ['wraps', 'decorator', 'functools', 'functional'],
  },
  {
    id: 'py-func-023',
    category: 'functional',
    difficulty: 'hard',
    title: 'Complex Reduce Nested',
    text: 'Use reduce to flatten a nested list one level deep',
    setup: 'from functools import reduce\nimport operator\nnested = [[1, 2], [3, 4], [5, 6]]',
    setupCode: 'from functools import reduce\nimport operator\nnested = [[1, 2], [3, 4], [5, 6]]',
    expected: [1, 2, 3, 4, 5, 6],
    sample: 'reduce(operator.add, nested)',
    hints: [
      'Adding lists concatenates them',
      'reduce(operator.add, [[1,2], [3,4]]) = [1,2] + [3,4]',
      'Or use reduce with lambda a, b: a + b',
    ],
    validPatterns: [
      /reduce\s*\(\s*operator\.add\s*,\s*nested\s*\)/,
      /reduce\s*\(\s*lambda\s+\w+\s*,\s*\w+\s*:\s*\w+\s*\+\s*\w+\s*,\s*nested\s*\)/,
      /reduce\s*\(\s*operator\.concat\s*,\s*nested\s*\)/,
      /\[\s*\w+\s+for\s+\w+\s+in\s+nested\s+for\s+\w+\s+in\s+\w+\s*\]/,
    ],
    tags: ['reduce', 'flatten', 'functools', 'functional'],
  },
  {
    id: 'py-func-024',
    category: 'functional',
    difficulty: 'hard',
    title: 'Partial with Multiple Args',
    text: 'Create a partial function for string formatting with a fixed template',
    setup:
      'from functools import partial\n\ndef format_greeting(greeting, name, punctuation):\n    return f"{greeting}, {name}{punctuation}"\n\n# Create hello_to that fixes greeting="Hello" and punctuation="!"',
    setupCode:
      'from functools import partial\n\ndef format_greeting(greeting, name, punctuation):\n    return f"{greeting}, {name}{punctuation}"',
    expected: 'Hello, World!',
    sample: 'partial(format_greeting, "Hello", punctuation="!")(name="World")',
    hints: [
      'partial() can fix both positional and keyword arguments',
      'The remaining args can be filled in when calling',
      'Use keyword arguments for non-sequential parameter binding',
    ],
    validPatterns: [
      /partial\s*\(\s*format_greeting\s*,\s*["']Hello["']\s*,\s*punctuation\s*=\s*["']!["']\s*\)\s*\(\s*name\s*=\s*["']World["']\s*\)/,
      /partial\s*\(\s*format_greeting\s*,\s*["']Hello["']\s*,\s*punctuation\s*=\s*["']!["']\s*\)\s*\(\s*["']World["']\s*\)/,
    ],
    tags: ['partial', 'functools', 'functional', 'advanced'],
  },
  {
    id: 'py-func-025',
    category: 'functional',
    difficulty: 'hard',
    title: 'Higher Order Function Pipeline',
    text: 'Create and apply a pipeline that processes a number through multiple transformations',
    setup:
      'from functools import reduce\n\ndef pipeline(*funcs):\n    def inner(value):\n        return reduce(lambda acc, f: f(acc), funcs, value)\n    return inner\n\n# Create a pipeline: double -> add 10 -> square, and apply to 3',
    setupCode:
      'from functools import reduce\n\ndef pipeline(*funcs):\n    def inner(value):\n        return reduce(lambda acc, f: f(acc), funcs, value)\n    return inner',
    expected: 256,
    sample: 'pipeline(lambda x: x * 2, lambda x: x + 10, lambda x: x ** 2)(3)',
    hints: [
      'pipeline() creates a function that applies functions in order',
      '3 -> double -> 6 -> add 10 -> 16 -> square -> 256',
      'The functions are applied left to right',
    ],
    validPatterns: [
      /pipeline\s*\(\s*lambda\s+\w+\s*:\s*\w+\s*\*\s*2\s*,\s*lambda\s+\w+\s*:\s*\w+\s*\+\s*10\s*,\s*lambda\s+\w+\s*:\s*\w+\s*\*\*\s*2\s*\)\s*\(\s*3\s*\)/,
      /pipeline\s*\([^)]+\)\s*\(\s*3\s*\)/,
    ],
    tags: ['pipeline', 'reduce', 'higher-order', 'functional', 'advanced'],
  },

  // ============================================================
  // ADVANCED LIST OPERATIONS (25 problems)
  // Covers: slicing patterns, list multiplication, unpacking, bisect, heapq, deque, flattening, zip_longest
  // ============================================================

  // --- SLICING PATTERNS (5 problems: 3 easy, 2 medium) ---
  {
    id: 'py-list-038',
    category: 'list',
    difficulty: 'easy',
    title: 'Get Every Other Element',
    text: 'Extract every other element from the list using slice step',
    setup: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    setupCode: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    expected: [0, 2, 4, 6, 8],
    sample: 'nums[::2]',
    hints: [
      'Use slice notation with a step: list[start:stop:step]',
      'Omitting start and stop means the entire list',
    ],
    validPatterns: [
      /nums\s*\[\s*::\s*2\s*\]/,
      /nums\s*\[\s*0\s*:\s*:\s*2\s*\]/,
      /nums\s*\[\s*0\s*:\s*10\s*:\s*2\s*\]/,
    ],
    tags: ['slicing', 'step', 'basic'],
  },
  {
    id: 'py-list-039',
    category: 'list',
    difficulty: 'easy',
    title: 'Get Every Third Element Starting from Index 1',
    text: 'Extract every third element starting from index 1',
    setup: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    setupCode: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    expected: [1, 4, 7],
    sample: 'nums[1::3]',
    hints: ['Specify start index before the first colon', 'Step of 3 means every third element'],
    validPatterns: [/nums\s*\[\s*1\s*::\s*3\s*\]/, /nums\s*\[\s*1\s*:\s*10\s*:\s*3\s*\]/],
    tags: ['slicing', 'step', 'basic'],
  },
  {
    id: 'py-list-040',
    category: 'list',
    difficulty: 'easy',
    title: 'Get Last Three Elements Using Negative Index',
    text: 'Extract the last three elements using negative indexing',
    setup: 'nums = [10, 20, 30, 40, 50, 60, 70]',
    setupCode: 'nums = [10, 20, 30, 40, 50, 60, 70]',
    expected: [50, 60, 70],
    sample: 'nums[-3:]',
    hints: [
      'Negative indices count from the end',
      '-1 is the last element, -3 is third from the end',
    ],
    validPatterns: [/nums\s*\[\s*-3\s*:\s*\]/, /nums\s*\[\s*-3\s*:\s*None\s*\]/],
    tags: ['slicing', 'negative-index', 'basic'],
  },
  {
    id: 'py-list-041',
    category: 'list',
    difficulty: 'medium',
    title: 'Reverse with Negative Step',
    text: 'Get elements from index 6 down to index 2 (inclusive) in reverse',
    setup: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    setupCode: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    expected: [6, 5, 4, 3, 2],
    sample: 'nums[6:1:-1]',
    hints: [
      'Negative step reverses direction',
      'When step is negative, start should be greater than stop',
      'Stop is exclusive, so use index 1 to include index 2',
    ],
    validPatterns: [/nums\s*\[\s*6\s*:\s*1\s*:\s*-1\s*\]/],
    tags: ['slicing', 'negative-step', 'intermediate'],
  },
  {
    id: 'py-list-042',
    category: 'list',
    difficulty: 'medium',
    title: 'Get Every Other Element in Reverse',
    text: 'Extract every other element from the list in reverse order',
    setup: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    setupCode: 'nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]',
    expected: [9, 7, 5, 3, 1],
    sample: 'nums[::-2]',
    hints: [
      'Combine negative step with a larger magnitude',
      'Step of -2 goes backwards taking every other element',
    ],
    validPatterns: [/nums\s*\[\s*::\s*-2\s*\]/, /nums\s*\[\s*-1\s*::\s*-2\s*\]/],
    tags: ['slicing', 'negative-step', 'intermediate'],
  },

  // --- LIST MULTIPLICATION AND REPETITION (2 problems: 2 easy) ---
  {
    id: 'py-list-043',
    category: 'list',
    difficulty: 'easy',
    title: 'Repeat List Elements',
    text: 'Create a new list by repeating the original list 3 times',
    setup: 'pattern = [1, 2, 3]',
    setupCode: 'pattern = [1, 2, 3]',
    expected: [1, 2, 3, 1, 2, 3, 1, 2, 3],
    sample: 'pattern * 3',
    hints: ['Lists support the * operator for repetition', 'This creates a shallow copy repeated'],
    validPatterns: [/pattern\s*\*\s*3/, /3\s*\*\s*pattern/],
    tags: ['list-multiplication', 'repetition', 'basic'],
  },
  {
    id: 'py-list-044',
    category: 'list',
    difficulty: 'easy',
    title: 'Initialize List with Default Value',
    text: 'Create a list of 5 zeros',
    setup: '# Create a list of 5 zeros',
    setupCode: '# Create a list of 5 zeros',
    expected: [0, 0, 0, 0, 0],
    sample: '[0] * 5',
    hints: [
      'Use list multiplication to initialize with default values',
      'Multiply a single-element list by the desired length',
    ],
    validPatterns: [/\[\s*0\s*\]\s*\*\s*5/, /5\s*\*\s*\[\s*0\s*\]/],
    tags: ['list-multiplication', 'initialization', 'basic'],
  },

  // --- LIST UNPACKING (3 problems: 3 medium) ---
  {
    id: 'py-list-045',
    category: 'list',
    difficulty: 'medium',
    title: 'Head and Tail Unpacking',
    text: 'Unpack the first element as head and remaining elements as tail',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: { head: 1, tail: [2, 3, 4, 5] },
    sample: 'head, *tail = nums; {"head": head, "tail": tail}',
    hints: [
      'Use the * operator to capture multiple elements',
      'Place * before the variable that should collect remaining items',
    ],
    validPatterns: [/\w+\s*,\s*\*\s*\w+\s*=\s*nums/],
    tags: ['unpacking', 'starred-expression', 'intermediate'],
  },
  {
    id: 'py-list-046',
    category: 'list',
    difficulty: 'medium',
    title: 'First, Middle, Last Unpacking',
    text: 'Unpack first element, middle elements, and last element separately',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: { first: 1, middle: [2, 3, 4], last: 5 },
    sample: 'first, *middle, last = nums; {"first": first, "middle": middle, "last": last}',
    hints: [
      'The starred variable captures everything between named positions',
      'You can only have one starred variable in an unpacking',
    ],
    validPatterns: [/\w+\s*,\s*\*\s*\w+\s*,\s*\w+\s*=\s*nums/],
    tags: ['unpacking', 'starred-expression', 'intermediate'],
  },
  {
    id: 'py-list-047',
    category: 'list',
    difficulty: 'medium',
    title: 'Merge Lists with Unpacking',
    text: 'Merge three lists into one using the unpacking operator',
    setup: 'a = [1, 2]\nb = [3, 4]\nc = [5, 6]',
    setupCode: 'a = [1, 2]\nb = [3, 4]\nc = [5, 6]',
    expected: [1, 2, 3, 4, 5, 6],
    sample: '[*a, *b, *c]',
    hints: [
      'Use * to unpack each list inside a new list literal',
      'This is cleaner than using + for concatenation',
    ],
    validPatterns: [/\[\s*\*\s*a\s*,\s*\*\s*b\s*,\s*\*\s*c\s*\]/, /a\s*\+\s*b\s*\+\s*c/],
    tags: ['unpacking', 'merge', 'intermediate'],
  },

  // --- BISECT MODULE (3 problems: 2 medium, 1 hard) ---
  {
    id: 'py-list-048',
    category: 'list',
    difficulty: 'medium',
    title: 'Find Insertion Point with bisect_left',
    text: 'Find the leftmost insertion point for value 25 in a sorted list',
    setup: 'import bisect\nsorted_nums = [10, 20, 30, 30, 40, 50]',
    setupCode: 'import bisect\nsorted_nums = [10, 20, 30, 30, 40, 50]',
    expected: 2,
    sample: 'bisect.bisect_left(sorted_nums, 25)',
    hints: [
      'bisect_left finds the leftmost position where value could be inserted',
      'The list must be sorted',
    ],
    validPatterns: [
      /bisect\.bisect_left\s*\(\s*sorted_nums\s*,\s*25\s*\)/,
      /bisect_left\s*\(\s*sorted_nums\s*,\s*25\s*\)/,
    ],
    tags: ['bisect', 'binary-search', 'intermediate'],
  },
  {
    id: 'py-list-049',
    category: 'list',
    difficulty: 'medium',
    title: 'Find Insertion Point with bisect_right',
    text: 'Find the rightmost insertion point for value 30 (after existing 30s)',
    setup: 'import bisect\nsorted_nums = [10, 20, 30, 30, 40, 50]',
    setupCode: 'import bisect\nsorted_nums = [10, 20, 30, 30, 40, 50]',
    expected: 4,
    sample: 'bisect.bisect_right(sorted_nums, 30)',
    hints: [
      'bisect_right (or bisect) finds position after any existing equal values',
      'Returns index where new element would go to maintain sorted order',
    ],
    validPatterns: [
      /bisect\.bisect_right\s*\(\s*sorted_nums\s*,\s*30\s*\)/,
      /bisect\.bisect\s*\(\s*sorted_nums\s*,\s*30\s*\)/,
      /bisect_right\s*\(\s*sorted_nums\s*,\s*30\s*\)/,
    ],
    tags: ['bisect', 'binary-search', 'intermediate'],
  },
  {
    id: 'py-list-050',
    category: 'list',
    difficulty: 'hard',
    title: 'Insert While Maintaining Sort Order',
    text: 'Insert 25 into the sorted list maintaining sorted order, return the modified list',
    setup: 'import bisect\nsorted_nums = [10, 20, 30, 40, 50]',
    setupCode: 'import bisect\nsorted_nums = [10, 20, 30, 40, 50]',
    expected: [10, 20, 25, 30, 40, 50],
    sample: 'bisect.insort(sorted_nums, 25); sorted_nums',
    hints: [
      'bisect.insort inserts an element in sorted order',
      'This modifies the list in place',
      'It uses bisect_right internally',
    ],
    validPatterns: [
      /bisect\.insort\s*\(\s*sorted_nums\s*,\s*25\s*\)/,
      /bisect\.insort_right\s*\(\s*sorted_nums\s*,\s*25\s*\)/,
      /bisect\.insort_left\s*\(\s*sorted_nums\s*,\s*25\s*\)/,
    ],
    tags: ['bisect', 'insort', 'advanced'],
  },

  // --- HEAPQ MODULE (5 problems: 2 easy, 3 medium) ---
  {
    id: 'py-list-051',
    category: 'list',
    difficulty: 'medium',
    title: 'Create a Min Heap',
    text: 'Convert the list into a min heap in-place',
    setup: 'import heapq\nnums = [5, 3, 8, 1, 9, 2]',
    setupCode: 'import heapq\nnums = [5, 3, 8, 1, 9, 2]',
    expected: [1, 3, 2, 5, 9, 8],
    sample: 'heapq.heapify(nums); nums',
    hints: [
      'heapify transforms a list into a heap in-place',
      'The smallest element is always at index 0',
    ],
    validPatterns: [/heapq\.heapify\s*\(\s*nums\s*\)/, /heapify\s*\(\s*nums\s*\)/],
    tags: ['heapq', 'heap', 'intermediate'],
  },
  {
    id: 'py-list-052',
    category: 'list',
    difficulty: 'medium',
    title: 'Push to Heap',
    text: 'Push value 0 onto the heap and return the heap',
    setup: 'import heapq\nheap = [1, 3, 2, 5, 9, 8]',
    setupCode: 'import heapq\nheap = [1, 3, 2, 5, 9, 8]',
    expected: [0, 3, 1, 5, 9, 8, 2],
    sample: 'heapq.heappush(heap, 0); heap',
    hints: [
      'heappush adds an element while maintaining heap property',
      'New smallest element will bubble to the top',
    ],
    validPatterns: [
      /heapq\.heappush\s*\(\s*heap\s*,\s*0\s*\)/,
      /heappush\s*\(\s*heap\s*,\s*0\s*\)/,
    ],
    tags: ['heapq', 'heappush', 'intermediate'],
  },
  {
    id: 'py-list-053',
    category: 'list',
    difficulty: 'medium',
    title: 'Pop from Heap',
    text: 'Pop and return the smallest element from the heap',
    setup: 'import heapq\nheap = [1, 3, 2, 5, 9, 8]',
    setupCode: 'import heapq\nheap = [1, 3, 2, 5, 9, 8]',
    expected: 1,
    sample: 'heapq.heappop(heap)',
    hints: [
      'heappop removes and returns the smallest element',
      'Heap property is maintained after pop',
    ],
    validPatterns: [/heapq\.heappop\s*\(\s*heap\s*\)/, /heappop\s*\(\s*heap\s*\)/],
    tags: ['heapq', 'heappop', 'intermediate'],
  },
  {
    id: 'py-list-054',
    category: 'list',
    difficulty: 'easy',
    title: 'Get N Largest Elements',
    text: 'Get the 3 largest elements from the list',
    setup: 'import heapq\nnums = [1, 8, 2, 23, 7, 4, 18, 23, 42, 37, 2]',
    setupCode: 'import heapq\nnums = [1, 8, 2, 23, 7, 4, 18, 23, 42, 37, 2]',
    expected: [42, 37, 23],
    sample: 'heapq.nlargest(3, nums)',
    hints: [
      'nlargest returns the n largest elements in descending order',
      'More efficient than sorting for small n',
    ],
    validPatterns: [
      /heapq\.nlargest\s*\(\s*3\s*,\s*nums\s*\)/,
      /nlargest\s*\(\s*3\s*,\s*nums\s*\)/,
      /sorted\s*\(\s*nums\s*,\s*reverse\s*=\s*True\s*\)\s*\[\s*:\s*3\s*\]/,
    ],
    tags: ['heapq', 'nlargest', 'basic'],
  },
  {
    id: 'py-list-055',
    category: 'list',
    difficulty: 'easy',
    title: 'Get N Smallest Elements',
    text: 'Get the 3 smallest elements from the list',
    setup: 'import heapq\nnums = [1, 8, 2, 23, 7, 4, 18, 23, 42, 37, 2]',
    setupCode: 'import heapq\nnums = [1, 8, 2, 23, 7, 4, 18, 23, 42, 37, 2]',
    expected: [1, 2, 2],
    sample: 'heapq.nsmallest(3, nums)',
    hints: [
      'nsmallest returns the n smallest elements in ascending order',
      'Uses a heap internally for efficiency',
    ],
    validPatterns: [
      /heapq\.nsmallest\s*\(\s*3\s*,\s*nums\s*\)/,
      /nsmallest\s*\(\s*3\s*,\s*nums\s*\)/,
      /sorted\s*\(\s*nums\s*\)\s*\[\s*:\s*3\s*\]/,
    ],
    tags: ['heapq', 'nsmallest', 'basic'],
  },

  // --- DEQUE OPERATIONS (3 problems: 2 medium, 1 hard) ---
  {
    id: 'py-list-056',
    category: 'list',
    difficulty: 'medium',
    title: 'Append to Both Ends',
    text: 'Append 0 to the left and 6 to the right of the deque',
    setup: 'from collections import deque\nd = deque([1, 2, 3, 4, 5])',
    setupCode: 'from collections import deque\nd = deque([1, 2, 3, 4, 5])',
    expected: [0, 1, 2, 3, 4, 5, 6],
    sample: 'd.appendleft(0); d.append(6); list(d)',
    hints: ['appendleft adds to the left end in O(1)', 'append adds to the right end in O(1)'],
    validPatterns: [
      /d\.appendleft\s*\(\s*0\s*\).*d\.append\s*\(\s*6\s*\)/,
      /d\.append\s*\(\s*6\s*\).*d\.appendleft\s*\(\s*0\s*\)/,
    ],
    tags: ['deque', 'appendleft', 'intermediate'],
  },
  {
    id: 'py-list-057',
    category: 'list',
    difficulty: 'medium',
    title: 'Pop from Both Ends',
    text: 'Pop elements from both ends and return them as a tuple (left, right)',
    setup: 'from collections import deque\nd = deque([1, 2, 3, 4, 5])',
    setupCode: 'from collections import deque\nd = deque([1, 2, 3, 4, 5])',
    expected: [1, 5],
    sample: '(d.popleft(), d.pop())',
    hints: [
      'popleft removes and returns the leftmost element',
      'pop removes and returns the rightmost element',
    ],
    validPatterns: [
      /\(\s*d\.popleft\s*\(\s*\)\s*,\s*d\.pop\s*\(\s*\)\s*\)/,
      /\[\s*d\.popleft\s*\(\s*\)\s*,\s*d\.pop\s*\(\s*\)\s*\]/,
    ],
    tags: ['deque', 'popleft', 'intermediate'],
  },
  {
    id: 'py-list-058',
    category: 'list',
    difficulty: 'hard',
    title: 'Rotate Deque',
    text: 'Rotate the deque 2 positions to the right',
    setup: 'from collections import deque\nd = deque([1, 2, 3, 4, 5])',
    setupCode: 'from collections import deque\nd = deque([1, 2, 3, 4, 5])',
    expected: [4, 5, 1, 2, 3],
    sample: 'd.rotate(2); list(d)',
    hints: [
      'rotate(n) rotates n steps to the right',
      'Negative n rotates to the left',
      'rotate() is more efficient than manual pop/append',
    ],
    validPatterns: [/d\.rotate\s*\(\s*2\s*\)/, /d\.rotate\s*\(\s*-3\s*\)/],
    tags: ['deque', 'rotate', 'advanced'],
  },

  // --- LIST FLATTENING PATTERNS (4 problems: 2 medium, 2 hard) ---
  {
    id: 'py-list-059',
    category: 'list',
    difficulty: 'medium',
    title: 'Flatten Nested List with Comprehension',
    text: 'Flatten a 2D list into a 1D list using list comprehension',
    setup: 'nested = [[1, 2, 3], [4, 5], [6, 7, 8, 9]]',
    setupCode: 'nested = [[1, 2, 3], [4, 5], [6, 7, 8, 9]]',
    expected: [1, 2, 3, 4, 5, 6, 7, 8, 9],
    sample: '[item for sublist in nested for item in sublist]',
    hints: [
      'Use nested for loops in the comprehension',
      'Outer loop iterates over sublists, inner loop over items',
    ],
    validPatterns: [
      /\[\s*\w+\s+for\s+\w+\s+in\s+nested\s+for\s+\w+\s+in\s+\w+\s*\]/,
      /sum\s*\(\s*nested\s*,\s*\[\s*\]\s*\)/,
    ],
    tags: ['flattening', 'list-comprehension', 'intermediate'],
  },
  {
    id: 'py-list-060',
    category: 'list',
    difficulty: 'medium',
    title: 'Flatten with itertools.chain',
    text: 'Flatten a 2D list using itertools.chain.from_iterable',
    setup: 'from itertools import chain\nnested = [[1, 2, 3], [4, 5], [6, 7, 8, 9]]',
    setupCode: 'from itertools import chain\nnested = [[1, 2, 3], [4, 5], [6, 7, 8, 9]]',
    expected: [1, 2, 3, 4, 5, 6, 7, 8, 9],
    sample: 'list(chain.from_iterable(nested))',
    hints: [
      'chain.from_iterable flattens one level of nesting',
      'More efficient than sum() for flattening',
    ],
    validPatterns: [
      /list\s*\(\s*chain\.from_iterable\s*\(\s*nested\s*\)\s*\)/,
      /list\s*\(\s*chain\s*\(\s*\*\s*nested\s*\)\s*\)/,
    ],
    tags: ['flattening', 'itertools', 'chain', 'intermediate'],
  },
  {
    id: 'py-list-061',
    category: 'list',
    difficulty: 'hard',
    title: 'Deep Flatten Recursive',
    text: 'Flatten an arbitrarily nested list structure',
    setup: 'nested = [1, [2, [3, 4], 5], [6, [7, [8, 9]]]]',
    setupCode: 'nested = [1, [2, [3, 4], 5], [6, [7, [8, 9]]]]',
    expected: [1, 2, 3, 4, 5, 6, 7, 8, 9],
    sample:
      'def flatten(lst): return [item for sublist in lst for item in (flatten(sublist) if isinstance(sublist, list) else [sublist])]\nflatten(nested)',
    hints: [
      'Use recursion to handle arbitrary nesting depth',
      'Check if each element is a list with isinstance()',
      'Base case: if not a list, return as single-element list',
    ],
    validPatterns: [/isinstance\s*\(\s*\w+\s*,\s*list\s*\)/, /def\s+\w+\s*\(\s*\w+\s*\)/],
    tags: ['flattening', 'recursion', 'advanced'],
  },
  {
    id: 'py-list-062',
    category: 'list',
    difficulty: 'hard',
    title: 'Flatten with Generator',
    text: 'Create a generator function that yields flattened elements from nested lists',
    setup: 'nested = [[1, 2], [3, [4, 5]], 6]',
    setupCode: 'nested = [[1, 2], [3, [4, 5]], 6]',
    expected: [1, 2, 3, 4, 5, 6],
    sample:
      'def flatten_gen(lst):\n    for item in lst:\n        if isinstance(item, list):\n            yield from flatten_gen(item)\n        else:\n            yield item\nlist(flatten_gen(nested))',
    hints: [
      'Use yield for generator functions',
      'yield from delegates to another generator',
      'Recursively yield from nested lists',
    ],
    validPatterns: [/yield\s+from/, /yield\s+\w+/, /def\s+\w+\s*\(\s*\w+\s*\)/],
    tags: ['flattening', 'generator', 'yield-from', 'advanced'],
  },

  // --- ZIP WITH ITERTOOLS (5 problems: 2 medium, 3 hard) ---
  {
    id: 'py-list-063',
    category: 'list',
    difficulty: 'medium',
    title: 'Zip with Fill Value',
    text: 'Zip two unequal lists, filling missing values with None',
    setup: 'from itertools import zip_longest\na = [1, 2, 3, 4, 5]\nb = ["a", "b", "c"]',
    setupCode: 'from itertools import zip_longest\na = [1, 2, 3, 4, 5]\nb = ["a", "b", "c"]',
    expected: [
      [1, 'a'],
      [2, 'b'],
      [3, 'c'],
      [4, null],
      [5, null],
    ],
    sample: 'list(zip_longest(a, b))',
    hints: [
      'zip_longest continues until the longest iterable is exhausted',
      'Default fill value is None',
    ],
    validPatterns: [
      /list\s*\(\s*zip_longest\s*\(\s*a\s*,\s*b\s*\)\s*\)/,
      /list\s*\(\s*zip_longest\s*\(\s*a\s*,\s*b\s*,\s*fillvalue\s*=\s*None\s*\)\s*\)/,
    ],
    tags: ['zip', 'zip_longest', 'itertools', 'intermediate'],
  },
  {
    id: 'py-list-064',
    category: 'list',
    difficulty: 'hard',
    title: 'Zip with Custom Fill Value',
    text: 'Zip two unequal lists, using 0 as the fill value for missing elements',
    setup: 'from itertools import zip_longest\nnums1 = [1, 2, 3]\nnums2 = [10, 20, 30, 40, 50]',
    setupCode: 'from itertools import zip_longest\nnums1 = [1, 2, 3]\nnums2 = [10, 20, 30, 40, 50]',
    expected: [
      [1, 10],
      [2, 20],
      [3, 30],
      [0, 40],
      [0, 50],
    ],
    sample: 'list(zip_longest(nums1, nums2, fillvalue=0))',
    hints: [
      'Use the fillvalue parameter to specify a custom fill',
      'The fill value applies to all shorter iterables',
    ],
    validPatterns: [
      /list\s*\(\s*zip_longest\s*\(\s*nums1\s*,\s*nums2\s*,\s*fillvalue\s*=\s*0\s*\)\s*\)/,
    ],
    tags: ['zip', 'zip_longest', 'fillvalue', 'advanced'],
  },
  {
    id: 'py-list-065',
    category: 'list',
    difficulty: 'hard',
    title: 'Transpose Matrix with Zip',
    text: 'Transpose a matrix (list of lists) using zip and unpacking',
    setup: 'matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]',
    setupCode: 'matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]',
    expected: [
      [1, 4, 7],
      [2, 5, 8],
      [3, 6, 9],
    ],
    sample: 'list(map(list, zip(*matrix)))',
    hints: [
      'Use * to unpack the rows as arguments to zip',
      'zip pairs up elements from each row',
      'Convert each tuple to a list',
    ],
    validPatterns: [
      /list\s*\(\s*map\s*\(\s*list\s*,\s*zip\s*\(\s*\*\s*matrix\s*\)\s*\)\s*\)/,
      /\[\s*list\s*\(\s*\w+\s*\)\s+for\s+\w+\s+in\s+zip\s*\(\s*\*\s*matrix\s*\)\s*\]/,
    ],
    tags: ['zip', 'transpose', 'unpacking', 'advanced'],
  },
  {
    id: 'py-list-066',
    category: 'list',
    difficulty: 'medium',
    title: 'Pairwise Iteration',
    text: 'Create pairs of consecutive elements from the list',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: [
      [1, 2],
      [2, 3],
      [3, 4],
      [4, 5],
    ],
    sample: 'list(zip(nums, nums[1:]))',
    hints: [
      'Zip the list with a shifted version of itself',
      'nums[1:] starts from the second element',
    ],
    validPatterns: [
      /list\s*\(\s*zip\s*\(\s*nums\s*,\s*nums\s*\[\s*1\s*:\s*\]\s*\)\s*\)/,
      /\[\s*\(\s*nums\s*\[\s*\w+\s*\]\s*,\s*nums\s*\[\s*\w+\s*\+\s*1\s*\]\s*\)\s+for/,
    ],
    tags: ['zip', 'pairwise', 'sliding-window', 'intermediate'],
  },
  {
    id: 'py-list-067',
    category: 'list',
    difficulty: 'hard',
    title: 'Group Into Chunks with Zip',
    text: 'Group list elements into chunks of 3 using zip and iter',
    setup: 'nums = [1, 2, 3, 4, 5, 6, 7, 8, 9]',
    setupCode: 'nums = [1, 2, 3, 4, 5, 6, 7, 8, 9]',
    expected: [
      [1, 2, 3],
      [4, 5, 6],
      [7, 8, 9],
    ],
    sample: 'list(zip(*[iter(nums)] * 3))',
    hints: [
      'iter(nums) creates an iterator that is shared',
      'Multiplying [iter(nums)] * 3 creates 3 references to the same iterator',
      'zip pulls from the same iterator 3 times per tuple',
    ],
    validPatterns: [
      /list\s*\(\s*zip\s*\(\s*\*\s*\[\s*iter\s*\(\s*nums\s*\)\s*\]\s*\*\s*3\s*\)\s*\)/,
      /\[\s*nums\s*\[\s*\w+\s*:\s*\w+\s*\+\s*3\s*\]\s+for\s+\w+\s+in\s+range\s*\(\s*0\s*,\s*len\s*\(\s*nums\s*\)\s*,\s*3\s*\)\s*\]/,
    ],
    tags: ['zip', 'chunking', 'iter', 'advanced'],
  },

  // ============================================================
  // STRING MANIPULATION - Advanced String Methods (25 problems)
  // ============================================================

  // --- EASY (8 problems) ---
  {
    id: 'py-str-032',
    category: 'string',
    difficulty: 'easy',
    title: 'F-String Basic Formatting',
    text: 'Use an f-string to format the greeting with the name variable',
    setup: 'name = "Alice"',
    setupCode: 'name = "Alice"',
    expected: 'Hello, Alice!',
    sample: 'f"Hello, {name}!"',
    hints: ['F-strings start with f before the quote', 'Use curly braces {} to embed variables'],
    validPatterns: [/f["']Hello,\s*\{name\}!["']/, /f["']Hello, \{name\}!["']/],
    tags: ['f-string', 'formatting', 'basic'],
  },
  {
    id: 'py-str-033',
    category: 'string',
    difficulty: 'easy',
    title: 'F-String Number Formatting',
    text: 'Format the price with 2 decimal places using an f-string',
    setup: 'price = 19.5',
    setupCode: 'price = 19.5',
    expected: '$19.50',
    sample: 'f"${price:.2f}"',
    hints: ['Use :.2f for 2 decimal places', 'Format specifiers go after the colon inside braces'],
    validPatterns: [/f["']\$\{price:\.2f\}["']/, /f["']\$\{price:0?\.2f\}["']/],
    tags: ['f-string', 'formatting', 'number'],
  },
  {
    id: 'py-str-034',
    category: 'string',
    difficulty: 'easy',
    title: 'String Format Method',
    text: 'Use the .format() method to insert values into the template',
    setup: 'template = "My name is {} and I am {} years old"',
    setupCode: 'template = "My name is {} and I am {} years old"',
    expected: 'My name is Bob and I am 25 years old',
    sample: 'template.format("Bob", 25)',
    hints: ['The format() method replaces {} placeholders', 'Arguments are inserted in order'],
    validPatterns: [/template\.format\s*\(\s*["']Bob["']\s*,\s*25\s*\)/],
    tags: ['format', 'string-method', 'basic'],
  },
  {
    id: 'py-str-035',
    category: 'string',
    difficulty: 'easy',
    title: 'Percent String Formatting',
    text: 'Use % formatting to create the message with name and score',
    setup: 'name = "Charlie"\nscore = 95',
    setupCode: 'name = "Charlie"\nscore = 95',
    expected: 'Charlie scored 95 points',
    sample: '"%s scored %d points" % (name, score)',
    hints: ['%s is for strings, %d is for integers', 'Use a tuple after % for multiple values'],
    validPatterns: [
      /["']%s scored %d points["']\s*%\s*\(\s*name\s*,\s*score\s*\)/,
      /f["']\{name\} scored \{score\} points["']/,
    ],
    tags: ['percent-formatting', 'legacy', 'basic'],
  },
  {
    id: 'py-str-036',
    category: 'string',
    difficulty: 'easy',
    title: 'String Encode to Bytes',
    text: 'Encode the string to bytes using UTF-8 encoding',
    setup: 'text = "Hello"',
    setupCode: 'text = "Hello"',
    expected: "b'Hello'",
    sample: 'text.encode("utf-8")',
    hints: ['Use the encode() method with encoding name', 'UTF-8 is the most common encoding'],
    validPatterns: [/text\.encode\s*\(\s*["']utf-?8["']?\s*\)/i, /text\.encode\s*\(\s*\)/],
    tags: ['encode', 'bytes', 'unicode'],
  },
  {
    id: 'py-str-037',
    category: 'string',
    difficulty: 'easy',
    title: 'Bytes Decode to String',
    text: 'Decode the bytes object back to a string',
    setup: 'data = b"Python"',
    setupCode: 'data = b"Python"',
    expected: 'Python',
    sample: 'data.decode("utf-8")',
    hints: ['Use the decode() method on bytes', 'Specify the same encoding used to encode'],
    validPatterns: [/data\.decode\s*\(\s*["']utf-?8["']?\s*\)/i, /data\.decode\s*\(\s*\)/],
    tags: ['decode', 'bytes', 'unicode'],
  },
  {
    id: 'py-str-038',
    category: 'string',
    difficulty: 'easy',
    title: 'String Expandtabs',
    text: 'Expand tabs in the string to 4 spaces',
    setup: 'text = "Name\\tAge\\tCity"',
    setupCode: 'text = "Name\\tAge\\tCity"',
    expected: 'Name    Age City',
    sample: 'text.expandtabs(4)',
    hints: [
      'Use expandtabs() with the tab size',
      'Tabs are replaced with spaces to align to tab stops',
    ],
    validPatterns: [/text\.expandtabs\s*\(\s*4\s*\)/],
    tags: ['expandtabs', 'string-method', 'whitespace'],
  },
  {
    id: 'py-str-039',
    category: 'string',
    difficulty: 'easy',
    title: 'String Center',
    text: 'Center the text within a width of 20 characters using dashes',
    setup: 'text = "Python"',
    setupCode: 'text = "Python"',
    expected: '-------Python-------',
    sample: 'text.center(20, "-")',
    hints: ['Use center(width, fillchar) method', 'Second argument is the fill character'],
    validPatterns: [/text\.center\s*\(\s*20\s*,\s*["']-["']\s*\)/],
    tags: ['center', 'string-method', 'alignment'],
  },

  // --- MEDIUM (12 problems) ---
  {
    id: 'py-str-040',
    category: 'string',
    difficulty: 'medium',
    title: 'F-String Padding and Alignment',
    text: 'Format the number right-aligned in a 10-character field with leading zeros',
    setup: 'num = 42',
    setupCode: 'num = 42',
    expected: '0000000042',
    sample: 'f"{num:0>10}"',
    hints: ['Use :0>10 for right-align with zeros, width 10', 'Format: {value:fill align width}'],
    validPatterns: [/f["']\{num:0>10\}["']/, /f["']\{num:010\}["']/, /f["']\{num:010d\}["']/],
    tags: ['f-string', 'formatting', 'alignment'],
  },
  {
    id: 'py-str-041',
    category: 'string',
    difficulty: 'medium',
    title: 'Regex Find All Matches',
    text: 'Find all email addresses in the text using regex',
    setup: 'import re\ntext = "Contact us at info@example.com or support@test.org"',
    setupCode: 'import re\ntext = "Contact us at info@example.com or support@test.org"',
    expected: ['info@example.com', 'support@test.org'],
    sample: 're.findall(r"[\\w.-]+@[\\w.-]+", text)',
    hints: ['Use re.findall() to get all matches', 'Email pattern: word chars + @ + word chars'],
    validPatterns: [/re\.findall\s*\(\s*r?["'][^"']*@[^"']*["']\s*,\s*text\s*\)/],
    tags: ['regex', 're-module', 'findall'],
  },
  {
    id: 'py-str-042',
    category: 'string',
    difficulty: 'medium',
    title: 'Regex Substitution',
    text: 'Replace all digits in the string with an asterisk',
    setup: 'import re\ntext = "Phone: 123-456-7890"',
    setupCode: 'import re\ntext = "Phone: 123-456-7890"',
    expected: 'Phone: ***-***-****',
    sample: 're.sub(r"\\d", "*", text)',
    hints: ['Use re.sub(pattern, replacement, string)', '\\d matches any digit'],
    validPatterns: [
      /re\.sub\s*\(\s*r?["']\\d["']\s*,\s*["']\*["']\s*,\s*text\s*\)/,
      /re\.sub\s*\(\s*r?["']\[0-9\]["']\s*,\s*["']\*["']\s*,\s*text\s*\)/,
    ],
    tags: ['regex', 're-module', 'sub'],
  },
  {
    id: 'py-str-043',
    category: 'string',
    difficulty: 'medium',
    title: 'Regex Split',
    text: 'Split the text on any whitespace sequence',
    setup: 'import re\ntext = "Hello   World\\n\\tPython"',
    setupCode: 'import re\ntext = "Hello   World\\n\\tPython"',
    expected: ['Hello', 'World', 'Python'],
    sample: 're.split(r"\\s+", text)',
    hints: ['Use re.split() with a pattern', '\\s+ matches one or more whitespace characters'],
    validPatterns: [/re\.split\s*\(\s*r?["']\\s\+["']\s*,\s*text\s*\)/],
    tags: ['regex', 're-module', 'split'],
  },
  {
    id: 'py-str-044',
    category: 'string',
    difficulty: 'medium',
    title: 'String Maketrans and Translate',
    text: 'Replace vowels with numbers: a->4, e->3, i->1, o->0',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: 'h3ll0 w0rld',
    sample: 'text.translate(str.maketrans("aeio", "4310"))',
    hints: [
      'Use str.maketrans() to create a translation table',
      'Then use translate() with the table',
    ],
    validPatterns: [
      /text\.translate\s*\(\s*str\.maketrans\s*\(\s*["']aeio["']\s*,\s*["']4310["']\s*\)\s*\)/,
      /text\.translate\s*\(\s*\{[^}]*\}\s*\)/,
    ],
    tags: ['maketrans', 'translate', 'string-method'],
  },
  {
    id: 'py-str-045',
    category: 'string',
    difficulty: 'medium',
    title: 'String Translate Delete Characters',
    text: 'Remove all vowels from the string using translate',
    setup: 'text = "Hello World"',
    setupCode: 'text = "Hello World"',
    expected: 'Hll Wrld',
    sample: 'text.translate(str.maketrans("", "", "aeiouAEIOU"))',
    hints: [
      'The third argument to maketrans specifies characters to delete',
      'Leave first two arguments as empty strings',
    ],
    validPatterns: [
      /text\.translate\s*\(\s*str\.maketrans\s*\(\s*["']["']\s*,\s*["']["']\s*,\s*["'][aeiouAEIOU]+["']\s*\)\s*\)/,
    ],
    tags: ['maketrans', 'translate', 'delete'],
  },
  {
    id: 'py-str-046',
    category: 'string',
    difficulty: 'medium',
    title: 'Textwrap Wrap',
    text: 'Wrap the text to lines of maximum 20 characters',
    setup: 'import textwrap\ntext = "The quick brown fox jumps over the lazy dog"',
    setupCode: 'import textwrap\ntext = "The quick brown fox jumps over the lazy dog"',
    expected: ['The quick brown fox', 'jumps over the lazy', 'dog'],
    sample: 'textwrap.wrap(text, 20)',
    hints: ['Use textwrap.wrap(text, width)', 'Returns a list of wrapped lines'],
    validPatterns: [
      /textwrap\.wrap\s*\(\s*text\s*,\s*20\s*\)/,
      /textwrap\.wrap\s*\(\s*text\s*,\s*width\s*=\s*20\s*\)/,
    ],
    tags: ['textwrap', 'wrap', 'formatting'],
  },
  {
    id: 'py-str-047',
    category: 'string',
    difficulty: 'medium',
    title: 'Textwrap Fill',
    text: 'Wrap and join the text into a single string with 25-char width',
    setup: 'import textwrap\ntext = "The quick brown fox jumps over the lazy dog"',
    setupCode: 'import textwrap\ntext = "The quick brown fox jumps over the lazy dog"',
    expected: 'The quick brown fox\njumps over the lazy dog',
    sample: 'textwrap.fill(text, 25)',
    hints: [
      'textwrap.fill() is like wrap() but returns a single string',
      'Lines are joined with newlines',
    ],
    validPatterns: [
      /textwrap\.fill\s*\(\s*text\s*,\s*25\s*\)/,
      /textwrap\.fill\s*\(\s*text\s*,\s*width\s*=\s*25\s*\)/,
    ],
    tags: ['textwrap', 'fill', 'formatting'],
  },
  {
    id: 'py-str-048',
    category: 'string',
    difficulty: 'medium',
    title: 'Textwrap Dedent',
    text: 'Remove common leading whitespace from the indented text',
    setup: 'import textwrap\ntext = "    Line 1\\n    Line 2\\n    Line 3"',
    setupCode: 'import textwrap\ntext = "    Line 1\\n    Line 2\\n    Line 3"',
    expected: 'Line 1\nLine 2\nLine 3',
    sample: 'textwrap.dedent(text)',
    hints: [
      'dedent() removes common leading whitespace',
      'Useful for cleaning up multi-line strings',
    ],
    validPatterns: [/textwrap\.dedent\s*\(\s*text\s*\)/],
    tags: ['textwrap', 'dedent', 'whitespace'],
  },
  {
    id: 'py-str-049',
    category: 'string',
    difficulty: 'medium',
    title: 'Difflib Get Close Matches',
    text: 'Find words similar to "appel" from the word list',
    setup: 'import difflib\nwords = ["apple", "ape", "apples", "peach", "banana"]',
    setupCode: 'import difflib\nwords = ["apple", "ape", "apples", "peach", "banana"]',
    expected: ['apple', 'apples', 'ape'],
    sample: 'difflib.get_close_matches("appel", words)',
    hints: [
      'Use difflib.get_close_matches(word, possibilities)',
      'Returns a list of close matches sorted by similarity',
    ],
    validPatterns: [/difflib\.get_close_matches\s*\(\s*["']appel["']\s*,\s*words\s*\)/],
    tags: ['difflib', 'fuzzy-match', 'similarity'],
  },
  {
    id: 'py-str-050',
    category: 'string',
    difficulty: 'medium',
    title: 'Regex Named Groups',
    text: 'Extract the year, month, and day from the date string using named groups',
    setup: 'import re\ndate = "2024-03-15"',
    setupCode: 'import re\ndate = "2024-03-15"',
    expected: { year: '2024', month: '03', day: '15' },
    sample: 're.match(r"(?P<year>\\d{4})-(?P<month>\\d{2})-(?P<day>\\d{2})", date).groupdict()',
    hints: ['Use (?P<name>pattern) for named groups', 'Call groupdict() on the match object'],
    validPatterns: [
      /re\.match\s*\([^)]*\?P<year>[^)]*\)\.groupdict\s*\(\s*\)/,
      /re\.search\s*\([^)]*\?P<year>[^)]*\)\.groupdict\s*\(\s*\)/,
    ],
    tags: ['regex', 're-module', 'named-groups'],
  },
  {
    id: 'py-str-051',
    category: 'string',
    difficulty: 'medium',
    title: 'Unicode Normalization',
    text: 'Normalize the string to NFC form (composed characters)',
    setup: 'import unicodedata\ntext = "cafe\\u0301"  # cafe with combining acute accent',
    setupCode: 'import unicodedata\ntext = "cafe\\u0301"  # cafe with combining acute accent',
    expected: 'cafe',
    sample: 'unicodedata.normalize("NFC", text)',
    hints: [
      'Use unicodedata.normalize() with form name',
      'NFC composes characters, NFD decomposes them',
    ],
    validPatterns: [/unicodedata\.normalize\s*\(\s*["']NFC["']\s*,\s*text\s*\)/],
    tags: ['unicode', 'normalization', 'unicodedata'],
  },

  // --- HARD (5 problems) ---
  {
    id: 'py-str-052',
    category: 'string',
    difficulty: 'hard',
    title: 'Regex Lookahead Password Validation',
    text: 'Check if password has at least one digit and one uppercase letter using lookaheads',
    setup: 'import re\npassword = "Secret123"',
    setupCode: 'import re\npassword = "Secret123"',
    expected: true,
    sample: 'bool(re.match(r"(?=.*\\d)(?=.*[A-Z]).+", password))',
    hints: [
      'Use (?=...) for positive lookahead',
      'Lookaheads check without consuming characters',
      'Chain multiple lookaheads for multiple conditions',
    ],
    validPatterns: [
      /bool\s*\(\s*re\.match\s*\(\s*r?["'].*\?=.*["']\s*,\s*password\s*\)\s*\)/,
      /re\.match\s*\(\s*r?["'].*\?=.*["']\s*,\s*password\s*\)\s*is\s+not\s+None/,
    ],
    tags: ['regex', 'lookahead', 'validation', 'advanced'],
  },
  {
    id: 'py-str-053',
    category: 'string',
    difficulty: 'hard',
    title: 'Difflib Unified Diff',
    text: 'Generate a unified diff between the two text versions',
    setup:
      'import difflib\nold = ["line1", "line2", "line3"]\nnew = ["line1", "line2 modified", "line3", "line4"]',
    setupCode:
      'import difflib\nold = ["line1", "line2", "line3"]\nnew = ["line1", "line2 modified", "line3", "line4"]',
    expected: '--- \\n+++ \\n@@ -1,3 +1,4 @@\\n line1\\n-line2\\n+line2 modified\\n line3\\n+line4',
    sample: '"\\n".join(difflib.unified_diff(old, new))',
    hints: [
      'Use difflib.unified_diff() for git-style diffs',
      'Returns a generator of diff lines',
      'Join with newlines for readable output',
    ],
    validPatterns: [
      /["']\\n["']\.join\s*\(\s*difflib\.unified_diff\s*\(\s*old\s*,\s*new\s*\)\s*\)/,
      /list\s*\(\s*difflib\.unified_diff\s*\(\s*old\s*,\s*new\s*\)\s*\)/,
    ],
    tags: ['difflib', 'unified-diff', 'comparison'],
  },
  {
    id: 'py-str-054',
    category: 'string',
    difficulty: 'hard',
    title: 'Complex Regex with Callbacks',
    text: 'Use re.sub with a function to double all numbers in the text',
    setup: 'import re\ntext = "I have 3 cats and 12 dogs"',
    setupCode: 'import re\ntext = "I have 3 cats and 12 dogs"',
    expected: 'I have 6 cats and 24 dogs',
    sample: 're.sub(r"\\d+", lambda m: str(int(m.group()) * 2), text)',
    hints: [
      're.sub() can take a function as the replacement',
      'The function receives a match object',
      'Use m.group() to get the matched text',
    ],
    validPatterns: [
      /re\.sub\s*\(\s*r?["']\\d\+["']\s*,\s*lambda\s+\w+\s*:\s*str\s*\(\s*int\s*\(\s*\w+\.group\s*\(\s*\)\s*\)\s*\*\s*2\s*\)\s*,\s*text\s*\)/,
    ],
    tags: ['regex', 'sub', 'callback', 'advanced'],
  },
  {
    id: 'py-str-055',
    category: 'string',
    difficulty: 'hard',
    title: 'Parse URL Components',
    text: 'Extract protocol, domain, and path from the URL using regex',
    setup: 'import re\nurl = "https://www.example.com/path/to/page"',
    setupCode: 'import re\nurl = "https://www.example.com/path/to/page"',
    expected: { protocol: 'https', domain: 'www.example.com', path: '/path/to/page' },
    sample:
      'm = re.match(r"(?P<protocol>\\w+)://(?P<domain>[^/]+)(?P<path>/.*)", url); m.groupdict()',
    hints: [
      'Use named groups for each URL component',
      '[^/]+ matches any character except forward slash',
      'groupdict() returns a dictionary of named groups',
    ],
    validPatterns: [
      /re\.match\s*\([^)]*\?P<protocol>[^)]*\)\.groupdict\s*\(\s*\)/,
      /re\.match\s*\([^)]*\?P<protocol>[^)]*\)/,
    ],
    tags: ['regex', 'url-parsing', 'named-groups', 'advanced'],
  },
  {
    id: 'py-str-056',
    category: 'string',
    difficulty: 'hard',
    title: 'Sequence Matcher Ratio',
    text: 'Calculate the similarity ratio between two strings using SequenceMatcher',
    setup: 'from difflib import SequenceMatcher\ns1 = "python programming"\ns2 = "python coding"',
    setupCode:
      'from difflib import SequenceMatcher\ns1 = "python programming"\ns2 = "python coding"',
    expected: 0.5806451612903226,
    sample: 'SequenceMatcher(None, s1, s2).ratio()',
    hints: [
      'Create a SequenceMatcher with (isjunk, a, b)',
      'Call ratio() to get similarity between 0 and 1',
      'Pass None for isjunk to not ignore any characters',
    ],
    validPatterns: [/SequenceMatcher\s*\(\s*None\s*,\s*s1\s*,\s*s2\s*\)\.ratio\s*\(\s*\)/],
    tags: ['difflib', 'sequence-matcher', 'similarity', 'advanced'],
  },

  // ============================================================
  // DICTIONARY AND DATA MANIPULATION - ADVANCED (25 problems)
  // ============================================================
  {
    id: 'py-dict-020',
    category: 'dict',
    difficulty: 'easy',
    title: 'Counter Basic Usage',
    text: 'Count occurrences of each character in the string using Counter',
    setup: 'from collections import Counter\ntext = "abracadabra"',
    setupCode: 'from collections import Counter\ntext = "abracadabra"',
    expected: { a: 5, b: 2, r: 2, c: 1, d: 1 },
    sample: 'dict(Counter(text))',
    hints: ['Counter counts hashable objects', 'It returns a Counter object (subclass of dict)'],
    validPatterns: [/Counter\s*\(\s*text\s*\)/, /dict\s*\(\s*Counter\s*\(\s*text\s*\)\s*\)/],
    tags: ['counter', 'collections'],
  },
  {
    id: 'py-dict-021',
    category: 'dict',
    difficulty: 'easy',
    title: 'Counter Most Common',
    text: 'Find the 2 most common elements in the list using Counter',
    setup: 'from collections import Counter\nnums = [1, 2, 2, 3, 3, 3, 4, 4, 4, 4]',
    setupCode: 'from collections import Counter\nnums = [1, 2, 2, 3, 3, 3, 4, 4, 4, 4]',
    expected: [
      [4, 4],
      [3, 3],
    ],
    sample: 'Counter(nums).most_common(2)',
    hints: ['most_common(n) returns the n most frequent elements'],
    validPatterns: [/Counter\s*\(\s*nums\s*\)\.most_common\s*\(\s*2\s*\)/],
    tags: ['counter', 'collections'],
  },
  {
    id: 'py-dict-022',
    category: 'dict',
    difficulty: 'easy',
    title: 'Merge with Pipe Operator',
    text: 'Merge base config with override config using | operator',
    setup: 'base = {"debug": False, "timeout": 30}\noverride = {"debug": True, "retries": 3}',
    setupCode: 'base = {"debug": False, "timeout": 30}\noverride = {"debug": True, "retries": 3}',
    expected: { debug: true, timeout: 30, retries: 3 },
    sample: 'base | override',
    hints: ['Use | to merge dictionaries (Python 3.9+)'],
    validPatterns: [/base\s*\|\s*override/],
    tags: ['merge', 'dict-operator'],
  },
  {
    id: 'py-dict-023',
    category: 'dict',
    difficulty: 'easy',
    title: 'Dictionary from Two Lists',
    text: 'Create a dictionary pairing names with ages',
    setup: 'names = ["Alice", "Bob", "Charlie"]\nages = [25, 30, 35]',
    setupCode: 'names = ["Alice", "Bob", "Charlie"]\nages = [25, 30, 35]',
    expected: { Alice: 25, Bob: 30, Charlie: 35 },
    sample: 'dict(zip(names, ages))',
    hints: ['Use zip() to pair corresponding elements'],
    validPatterns: [/dict\s*\(\s*zip\s*\(\s*names\s*,\s*ages\s*\)\s*\)/],
    tags: ['dict-comprehension', 'zip'],
  },
  {
    id: 'py-dict-024',
    category: 'dict',
    difficulty: 'easy',
    title: 'Check Key Existence',
    text: 'Check if "email" key exists in the dictionary',
    setup: 'user = {"name": "Alice", "age": 30}',
    setupCode: 'user = {"name": "Alice", "age": 30}',
    expected: false,
    sample: '"email" in user',
    hints: ['Use the "in" operator to check key existence'],
    validPatterns: [/["']email["']\s+in\s+user/],
    tags: ['membership', 'dict-method'],
  },
  {
    id: 'py-dict-025',
    category: 'dict',
    difficulty: 'easy',
    title: 'Clear Dictionary',
    text: 'Remove all items from the dictionary and return its length',
    setup: 'data = {"a": 1, "b": 2, "c": 3}\ndata.clear()',
    setupCode: 'data = {"a": 1, "b": 2, "c": 3}\ndata.clear()',
    expected: 0,
    sample: 'len(data)',
    hints: ['clear() removes all items in-place'],
    validPatterns: [/len\s*\(\s*data\s*\)/],
    tags: ['clear', 'dict-method'],
  },
  {
    id: 'py-dict-026',
    category: 'dict',
    difficulty: 'easy',
    title: 'Enumerate to Index Map',
    text: 'Create a dictionary mapping index to fruit using enumerate',
    setup: 'fruits = ["apple", "banana", "cherry"]',
    setupCode: 'fruits = ["apple", "banana", "cherry"]',
    expected: { 0: 'apple', 1: 'banana', 2: 'cherry' },
    sample: 'dict(enumerate(fruits))',
    hints: ['enumerate() returns index-value pairs'],
    validPatterns: [/dict\s*\(\s*enumerate\s*\(\s*fruits\s*\)\s*\)/],
    tags: ['dict-comprehension', 'enumerate'],
  },
  {
    id: 'py-dict-027',
    category: 'dict',
    difficulty: 'easy',
    title: 'Pop with Default',
    text: 'Remove and return "status" key with default "unknown" if not found',
    setup: 'data = {"name": "test", "value": 42}',
    setupCode: 'data = {"name": "test", "value": 42}',
    expected: 'unknown',
    sample: 'data.pop("status", "unknown")',
    hints: ['pop() can take a default value as second argument'],
    validPatterns: [/data\.pop\s*\(\s*["']status["']\s*,\s*["']unknown["']\s*\)/],
    tags: ['pop', 'dict-method'],
  },
  {
    id: 'py-dict-028',
    category: 'dict',
    difficulty: 'medium',
    title: 'defaultdict with List',
    text: 'Group names by their first letter using defaultdict(list)',
    setup:
      'from collections import defaultdict\nnames = ["Alice", "Bob", "Anna", "Charlie", "Amy"]\nresult = defaultdict(list)\nfor name in names:\n    result[name[0]].append(name)',
    setupCode:
      'from collections import defaultdict\nnames = ["Alice", "Bob", "Anna", "Charlie", "Amy"]\nresult = defaultdict(list)\nfor name in names:\n    result[name[0]].append(name)',
    expected: { A: ['Alice', 'Anna', 'Amy'], B: ['Bob'], C: ['Charlie'] },
    sample: 'dict(result)',
    hints: ['defaultdict(list) auto-creates empty lists'],
    validPatterns: [/dict\s*\(\s*result\s*\)/],
    tags: ['defaultdict', 'collections', 'grouping'],
  },
  {
    id: 'py-dict-029',
    category: 'dict',
    difficulty: 'medium',
    title: 'defaultdict with Int',
    text: 'Count word occurrences using defaultdict(int)',
    setup:
      'from collections import defaultdict\nwords = ["a", "b", "a", "c", "b", "a"]\ncounts = defaultdict(int)\nfor w in words:\n    counts[w] += 1',
    setupCode:
      'from collections import defaultdict\nwords = ["a", "b", "a", "c", "b", "a"]\ncounts = defaultdict(int)\nfor w in words:\n    counts[w] += 1',
    expected: { a: 3, b: 2, c: 1 },
    sample: 'dict(counts)',
    hints: ['defaultdict(int) initializes missing keys to 0'],
    validPatterns: [/dict\s*\(\s*counts\s*\)/],
    tags: ['defaultdict', 'collections', 'counting'],
  },
  {
    id: 'py-dict-030',
    category: 'dict',
    difficulty: 'medium',
    title: 'Nested Dictionary Access',
    text: 'Safely get a nested value with get() chaining',
    setup: 'data = {"user": {"profile": {"name": "Alice"}}}',
    setupCode: 'data = {"user": {"profile": {"name": "Alice"}}}',
    expected: 'Alice',
    sample: 'data.get("user", {}).get("profile", {}).get("name", "Unknown")',
    hints: ['Chain get() calls with empty dict defaults'],
    validPatterns: [/data\.get\s*\(.*\)\.get\s*\(.*\)\.get\s*\(/],
    tags: ['nested', 'safe-access'],
  },
  {
    id: 'py-dict-031',
    category: 'dict',
    difficulty: 'medium',
    title: 'Update Nested Dictionary',
    text: 'Update the nested name field to "Bob"',
    setup: 'data = {"user": {"profile": {"name": "Alice", "age": 30}}}',
    setupCode: 'data = {"user": {"profile": {"name": "Alice", "age": 30}}}',
    expected: { user: { profile: { name: 'Bob', age: 30 } } },
    sample: 'data["user"]["profile"]["name"] = "Bob"; data',
    hints: ['Access nested keys with chained brackets'],
    validPatterns: [/data\s*\[.*\]\s*\[.*\]\s*\[.*\]\s*=\s*["']Bob["']/],
    tags: ['nested', 'update'],
  },
  {
    id: 'py-dict-032',
    category: 'dict',
    difficulty: 'medium',
    title: 'Counter Arithmetic',
    text: 'Subtract inventory sold from inventory using Counter subtraction',
    setup:
      'from collections import Counter\ninventory = Counter({"apple": 10, "banana": 5, "cherry": 3})\nsold = Counter({"apple": 3, "banana": 2})',
    setupCode:
      'from collections import Counter\ninventory = Counter({"apple": 10, "banana": 5, "cherry": 3})\nsold = Counter({"apple": 3, "banana": 2})',
    expected: { apple: 7, banana: 3, cherry: 3 },
    sample: 'dict(inventory - sold)',
    hints: ['Counter supports arithmetic operations'],
    validPatterns: [/inventory\s*-\s*sold/],
    tags: ['counter', 'collections', 'arithmetic'],
  },
  {
    id: 'py-dict-033',
    category: 'dict',
    difficulty: 'medium',
    title: 'ChainMap for Config Layers',
    text: 'Create a layered config using ChainMap (user overrides defaults)',
    setup:
      'from collections import ChainMap\ndefaults = {"color": "blue", "size": "medium"}\nuser_prefs = {"color": "red"}',
    setupCode:
      'from collections import ChainMap\ndefaults = {"color": "blue", "size": "medium"}\nuser_prefs = {"color": "red"}',
    expected: { color: 'red', size: 'medium' },
    sample: 'dict(ChainMap(user_prefs, defaults))',
    hints: ['ChainMap searches maps in order'],
    validPatterns: [/ChainMap\s*\(\s*user_prefs\s*,\s*defaults\s*\)/],
    tags: ['chainmap', 'collections', 'config'],
  },
  {
    id: 'py-dict-034',
    category: 'dict',
    difficulty: 'medium',
    title: 'Dict Comprehension with Conditional Value',
    text: 'Create a dict with "pass" or "fail" based on score >= 60',
    setup: 'scores = {"Alice": 85, "Bob": 55, "Charlie": 72, "Diana": 45}',
    setupCode: 'scores = {"Alice": 85, "Bob": 55, "Charlie": 72, "Diana": 45}',
    expected: { Alice: 'pass', Bob: 'fail', Charlie: 'pass', Diana: 'fail' },
    sample: '{k: ("pass" if v >= 60 else "fail") for k, v in scores.items()}',
    hints: ['Use ternary expression in dict comprehension'],
    validPatterns: [
      /\{.*["']pass["'].*if.*else.*["']fail["'].*for.*in\s+scores\.items\s*\(\s*\)\s*\}/,
    ],
    tags: ['dict-comprehension', 'conditional'],
  },
  {
    id: 'py-dict-035',
    category: 'dict',
    difficulty: 'medium',
    title: 'In-Place Update with |=',
    text: 'Update the config dict in-place with new settings using |=',
    setup: 'config = {"debug": False, "timeout": 30}\nnew_settings = {"timeout": 60, "retries": 3}',
    setupCode:
      'config = {"debug": False, "timeout": 30}\nnew_settings = {"timeout": 60, "retries": 3}',
    expected: { debug: false, timeout: 60, retries: 3 },
    sample: 'config |= new_settings; config',
    hints: ['Use |= for in-place dictionary merge (Python 3.9+)'],
    validPatterns: [/config\s*\|=\s*new_settings/],
    tags: ['merge', 'dict-operator', 'in-place'],
  },
  {
    id: 'py-dict-036',
    category: 'dict',
    difficulty: 'medium',
    title: 'Flatten Nested Dict Values',
    text: 'Extract all leaf values from nested dict into a flat list',
    setup: 'nested = {"a": {"b": 1, "c": 2}, "d": {"e": 3}}',
    setupCode: 'nested = {"a": {"b": 1, "c": 2}, "d": {"e": 3}}',
    expected: [1, 2, 3],
    sample: '[v for inner in nested.values() for v in inner.values()]',
    hints: ['Use nested comprehension to flatten'],
    validPatterns: [/\[.*for.*in\s+nested\.values\s*\(\s*\)\s+for.*in.*\.values\s*\(\s*\)\s*\]/],
    tags: ['nested', 'flatten', 'comprehension'],
  },
  {
    id: 'py-dict-037',
    category: 'dict',
    difficulty: 'medium',
    title: 'Counter Total Count',
    text: 'Get the total count of all items in the Counter',
    setup:
      'from collections import Counter\ncounts = Counter({"apple": 5, "banana": 3, "cherry": 2})',
    setupCode:
      'from collections import Counter\ncounts = Counter({"apple": 5, "banana": 3, "cherry": 2})',
    expected: 10,
    sample: 'counts.total()',
    hints: ['Counter has a total() method (Python 3.10+)'],
    validPatterns: [/counts\.total\s*\(\s*\)/, /sum\s*\(\s*counts\.values\s*\(\s*\)\s*\)/],
    tags: ['counter', 'collections'],
  },
  {
    id: 'py-dict-038',
    category: 'dict',
    difficulty: 'medium',
    title: 'Sort Dictionary by Value',
    text: 'Sort the dictionary by values in descending order',
    setup: 'scores = {"Alice": 85, "Bob": 92, "Charlie": 78, "Diana": 95}',
    setupCode: 'scores = {"Alice": 85, "Bob": 92, "Charlie": 78, "Diana": 95}',
    expected: { Diana: 95, Bob: 92, Alice: 85, Charlie: 78 },
    sample: 'dict(sorted(scores.items(), key=lambda x: x[1], reverse=True))',
    hints: ['Use sorted() with a key function'],
    validPatterns: [/dict\s*\(\s*sorted\s*\(\s*scores\.items\s*\(\s*\).*reverse\s*=\s*True/],
    tags: ['sorting', 'dict-method'],
  },
  {
    id: 'py-dict-039',
    category: 'dict',
    difficulty: 'medium',
    title: 'OrderedDict Move to End',
    text: 'Move the "b" key to the end of the OrderedDict',
    setup:
      'from collections import OrderedDict\nod = OrderedDict([("a", 1), ("b", 2), ("c", 3)])\nod.move_to_end("b")',
    setupCode:
      'from collections import OrderedDict\nod = OrderedDict([("a", 1), ("b", 2), ("c", 3)])\nod.move_to_end("b")',
    expected: { a: 1, c: 3, b: 2 },
    sample: 'dict(od)',
    hints: ['OrderedDict has move_to_end() method'],
    validPatterns: [/dict\s*\(\s*od\s*\)/],
    tags: ['ordereddict', 'collections'],
  },
  {
    id: 'py-dict-040',
    category: 'dict',
    difficulty: 'hard',
    title: 'Deep Merge Dictionaries',
    text: 'Merge nested dictionaries recursively (nested values should merge, not replace)',
    setup:
      'def deep_merge(d1, d2):\n    result = d1.copy()\n    for k, v in d2.items():\n        if k in result and isinstance(result[k], dict) and isinstance(v, dict):\n            result[k] = deep_merge(result[k], v)\n        else:\n            result[k] = v\n    return result\nbase = {"a": {"x": 1, "y": 2}, "b": 3}\nupdate = {"a": {"y": 20, "z": 30}, "c": 4}',
    setupCode:
      'def deep_merge(d1, d2):\n    result = d1.copy()\n    for k, v in d2.items():\n        if k in result and isinstance(result[k], dict) and isinstance(v, dict):\n            result[k] = deep_merge(result[k], v)\n        else:\n            result[k] = v\n    return result\nbase = {"a": {"x": 1, "y": 2}, "b": 3}\nupdate = {"a": {"y": 20, "z": 30}, "c": 4}',
    expected: { a: { x: 1, y: 20, z: 30 }, b: 3, c: 4 },
    sample: 'deep_merge(base, update)',
    hints: ['Recursively merge when both values are dicts'],
    validPatterns: [/deep_merge\s*\(\s*base\s*,\s*update\s*\)/],
    tags: ['nested', 'merge', 'recursive'],
  },
  {
    id: 'py-dict-041',
    category: 'dict',
    difficulty: 'hard',
    title: 'Group and Aggregate Sales',
    text: 'Group sales by product and sum the amounts',
    setup:
      'from collections import defaultdict\nsales = [{"product": "A", "amount": 100}, {"product": "B", "amount": 200}, {"product": "A", "amount": 150}, {"product": "B", "amount": 50}]\nresult = defaultdict(int)\nfor s in sales:\n    result[s["product"]] += s["amount"]',
    setupCode:
      'from collections import defaultdict\nsales = [{"product": "A", "amount": 100}, {"product": "B", "amount": 200}, {"product": "A", "amount": 150}, {"product": "B", "amount": 50}]\nresult = defaultdict(int)\nfor s in sales:\n    result[s["product"]] += s["amount"]',
    expected: { A: 250, B: 250 },
    sample: 'dict(result)',
    hints: ['Use defaultdict(int) for summing'],
    validPatterns: [/dict\s*\(\s*result\s*\)/],
    tags: ['defaultdict', 'grouping', 'aggregation'],
  },
  {
    id: 'py-dict-042',
    category: 'dict',
    difficulty: 'hard',
    title: 'Transform JSON-like Data',
    text: 'Extract usernames from nested user data into a list',
    setup:
      'data = {"users": [{"id": 1, "profile": {"username": "alice"}}, {"id": 2, "profile": {"username": "bob"}}, {"id": 3, "profile": {"username": "charlie"}}]}',
    setupCode:
      'data = {"users": [{"id": 1, "profile": {"username": "alice"}}, {"id": 2, "profile": {"username": "bob"}}, {"id": 3, "profile": {"username": "charlie"}}]}',
    expected: ['alice', 'bob', 'charlie'],
    sample: '[u["profile"]["username"] for u in data["users"]]',
    hints: ['Access nested structure with bracket notation'],
    validPatterns: [/\[.*\[.*profile.*\].*\[.*username.*\].*for.*in\s+data\s*\[.*users.*\]\s*\]/],
    tags: ['json', 'nested', 'transform'],
  },
  {
    id: 'py-dict-043',
    category: 'dict',
    difficulty: 'hard',
    title: 'Counter Elements Expansion',
    text: 'Expand Counter back to list of individual elements',
    setup: 'from collections import Counter\ncounts = Counter({"a": 3, "b": 2, "c": 1})',
    setupCode: 'from collections import Counter\ncounts = Counter({"a": 3, "b": 2, "c": 1})',
    expected: ['a', 'a', 'a', 'b', 'b', 'c'],
    sample: 'list(counts.elements())',
    hints: ['Counter has an elements() method'],
    validPatterns: [/list\s*\(\s*counts\.elements\s*\(\s*\)\s*\)/],
    tags: ['counter', 'collections', 'expansion'],
  },
  {
    id: 'py-dict-044',
    category: 'dict',
    difficulty: 'hard',
    title: 'Pivot Data Structure',
    text: 'Pivot list of dicts to dict of lists by key',
    setup:
      'records = [{"name": "Alice", "score": 85}, {"name": "Bob", "score": 90}, {"name": "Charlie", "score": 78}]',
    setupCode:
      'records = [{"name": "Alice", "score": 85}, {"name": "Bob", "score": 90}, {"name": "Charlie", "score": 78}]',
    expected: { name: ['Alice', 'Bob', 'Charlie'], score: [85, 90, 78] },
    sample: '{k: [r[k] for r in records] for k in records[0].keys()}',
    hints: ['Get keys from first record'],
    validPatterns: [/\{.*:\s*\[.*for.*in\s+records\s*\].*for.*in\s+records\s*\[\s*0\s*\]/],
    tags: ['pivot', 'transform', 'comprehension'],
  },

  // ============================================================
  // NEW PROBLEMS - List Comprehensions Advanced
  // ============================================================
  {
    id: 'py-lc-300',
    category: 'list',
    difficulty: 'medium',
    title: 'Nested List Comprehension - Matrix Transpose',
    text: 'Transpose the matrix using nested list comprehension',
    setup: 'matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]',
    setupCode: 'matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]',
    expected: [
      [1, 4, 7],
      [2, 5, 8],
      [3, 6, 9],
    ],
    sample: '[[row[i] for row in matrix] for i in range(len(matrix[0]))]',
    hints: ['Use nested comprehension with range for column indices'],
    tags: ['list-comprehension', 'nested', 'matrix'],
  },
  {
    id: 'py-lc-301',
    category: 'list',
    difficulty: 'medium',
    title: 'Conditional with Enumerate',
    text: 'Get values at even indices only using enumerate',
    setup: 'items = ["a", "b", "c", "d", "e", "f"]',
    setupCode: 'items = ["a", "b", "c", "d", "e", "f"]',
    expected: ['a', 'c', 'e'],
    sample: '[v for i, v in enumerate(items) if i % 2 == 0]',
    hints: ['Use enumerate to get index and value, filter by even index'],
    tags: ['list-comprehension', 'enumerate', 'filter'],
  },
  {
    id: 'py-lc-302',
    category: 'list',
    difficulty: 'medium',
    title: 'Zip with Transformation',
    text: 'Multiply corresponding elements from two lists',
    setup: 'a = [1, 2, 3, 4]\nb = [10, 20, 30, 40]',
    setupCode: 'a = [1, 2, 3, 4]\nb = [10, 20, 30, 40]',
    expected: [10, 40, 90, 160],
    sample: '[x * y for x, y in zip(a, b)]',
    hints: ['Use zip to pair elements, multiply in comprehension'],
    tags: ['list-comprehension', 'zip', 'transform'],
  },
  {
    id: 'py-lc-303',
    category: 'list',
    difficulty: 'hard',
    title: 'Nested with Multiple Conditions',
    text: 'Flatten and filter: get even numbers from nested list',
    setup: 'nested = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]',
    setupCode: 'nested = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]',
    expected: [2, 4, 6, 8],
    sample: '[x for row in nested for x in row if x % 2 == 0]',
    hints: ['Flatten first, then filter for even numbers'],
    tags: ['list-comprehension', 'nested', 'filter'],
  },
  {
    id: 'py-lc-304',
    category: 'list',
    difficulty: 'medium',
    title: 'Dictionary from Two Lists with Zip',
    text: 'Create a dictionary from keys and values lists',
    setup: 'keys = ["name", "age", "city"]\nvalues = ["Alice", 30, "NYC"]',
    setupCode: 'keys = ["name", "age", "city"]\nvalues = ["Alice", 30, "NYC"]',
    expected: { name: 'Alice', age: 30, city: 'NYC' },
    sample: '{k: v for k, v in zip(keys, values)}',
    hints: ['Use dict comprehension with zip'],
    tags: ['dict-comprehension', 'zip'],
  },
  {
    id: 'py-lc-305',
    category: 'list',
    difficulty: 'hard',
    title: 'Enumerate with Start Index',
    text: 'Create numbered list starting from 1',
    setup: 'items = ["first", "second", "third"]',
    setupCode: 'items = ["first", "second", "third"]',
    expected: [
      [1, 'first'],
      [2, 'second'],
      [3, 'third'],
    ],
    sample: 'list(enumerate(items, 1))',
    hints: ['enumerate takes optional start parameter'],
    tags: ['enumerate', 'tuple'],
  },
  {
    id: 'py-lc-306',
    category: 'list',
    difficulty: 'medium',
    title: 'Zip Longest Elements',
    text: 'Pair elements from lists of different lengths, using None for missing',
    setup: 'from itertools import zip_longest\na = [1, 2, 3]\nb = [10, 20]',
    setupCode: 'from itertools import zip_longest\na = [1, 2, 3]\nb = [10, 20]',
    expected: [
      [1, 10],
      [2, 20],
      [3, null],
    ],
    sample: 'list(zip_longest(a, b))',
    hints: ['Use zip_longest from itertools for unequal length lists'],
    tags: ['zip', 'itertools'],
  },
  {
    id: 'py-lc-307',
    category: 'list',
    difficulty: 'hard',
    title: 'Nested Comprehension with Condition on Outer',
    text: 'Get all elements from rows that have length > 2',
    setup: 'data = [[1], [2, 3, 4], [5, 6], [7, 8, 9, 10]]',
    setupCode: 'data = [[1], [2, 3, 4], [5, 6], [7, 8, 9, 10]]',
    expected: [2, 3, 4, 7, 8, 9, 10],
    sample: '[x for row in data if len(row) > 2 for x in row]',
    hints: ['Filter on outer loop before inner loop'],
    tags: ['list-comprehension', 'nested', 'filter'],
  },
  {
    id: 'py-lc-308',
    category: 'list',
    difficulty: 'medium',
    title: 'Ternary in Comprehension',
    text: 'Replace negative numbers with 0',
    setup: 'nums = [-2, 3, -1, 5, -4, 6]',
    setupCode: 'nums = [-2, 3, -1, 5, -4, 6]',
    expected: [0, 3, 0, 5, 0, 6],
    sample: '[x if x >= 0 else 0 for x in nums]',
    hints: ['Use ternary expression: value_if_true if condition else value_if_false'],
    tags: ['list-comprehension', 'ternary'],
  },
  {
    id: 'py-lc-309',
    category: 'list',
    difficulty: 'hard',
    title: 'Cartesian Product',
    text: 'Generate all pairs from two lists',
    setup: 'colors = ["red", "blue"]\nsizes = ["S", "M", "L"]',
    setupCode: 'colors = ["red", "blue"]\nsizes = ["S", "M", "L"]',
    expected: [
      ['red', 'S'],
      ['red', 'M'],
      ['red', 'L'],
      ['blue', 'S'],
      ['blue', 'M'],
      ['blue', 'L'],
    ],
    sample: '[(c, s) for c in colors for s in sizes]',
    hints: ['Use nested for loops in comprehension for Cartesian product'],
    tags: ['list-comprehension', 'nested', 'cartesian'],
  },

  // ============================================================
  // NEW PROBLEMS - Dictionary Methods
  // ============================================================
  {
    id: 'py-dc-310',
    category: 'dict',
    difficulty: 'medium',
    title: 'Dict Comprehension with Condition',
    text: 'Create dict with only positive values',
    setup: 'data = {"a": 1, "b": -2, "c": 3, "d": -4}',
    setupCode: 'data = {"a": 1, "b": -2, "c": 3, "d": -4}',
    expected: { a: 1, c: 3 },
    sample: '{k: v for k, v in data.items() if v > 0}',
    hints: ['Filter in dict comprehension using if clause'],
    tags: ['dict-comprehension', 'filter'],
  },
  {
    id: 'py-dc-311',
    category: 'dict',
    difficulty: 'medium',
    title: 'Merge Dictionaries with Pipe Operator',
    text: 'Merge two dictionaries (Python 3.9+)',
    setup: 'd1 = {"a": 1, "b": 2}\nd2 = {"c": 3, "d": 4}',
    setupCode: 'd1 = {"a": 1, "b": 2}\nd2 = {"c": 3, "d": 4}',
    expected: { a: 1, b: 2, c: 3, d: 4 },
    sample: 'd1 | d2',
    hints: ['Use | operator for dict merge in Python 3.9+'],
    tags: ['dict', 'merge', 'python39'],
  },
  {
    id: 'py-dc-312',
    category: 'dict',
    difficulty: 'medium',
    title: 'Invert Dictionary',
    text: 'Swap keys and values in the dictionary',
    setup: 'original = {"a": 1, "b": 2, "c": 3}',
    setupCode: 'original = {"a": 1, "b": 2, "c": 3}',
    expected: { 1: 'a', 2: 'b', 3: 'c' },
    sample: '{v: k for k, v in original.items()}',
    hints: ['Use dict comprehension to swap k and v'],
    tags: ['dict-comprehension', 'transform'],
  },
  {
    id: 'py-dc-313',
    category: 'dict',
    difficulty: 'hard',
    title: 'ChainMap Lookup',
    text: 'Create a ChainMap and look up a key that exists in second dict',
    setup: 'from collections import ChainMap\nd1 = {"a": 1}\nd2 = {"b": 2, "c": 3}',
    setupCode:
      'from collections import ChainMap\nd1 = {"a": 1}\nd2 = {"b": 2, "c": 3}\ncm = ChainMap(d1, d2)',
    expected: 2,
    sample: 'cm["b"]',
    hints: ['ChainMap searches dicts in order, returns first match'],
    tags: ['collections', 'chainmap'],
  },
  {
    id: 'py-dc-314',
    category: 'dict',
    difficulty: 'medium',
    title: 'Dict fromkeys',
    text: 'Create dict with keys from list and default value 0',
    setup: 'keys = ["x", "y", "z"]',
    setupCode: 'keys = ["x", "y", "z"]',
    expected: { x: 0, y: 0, z: 0 },
    sample: 'dict.fromkeys(keys, 0)',
    hints: ['Use dict.fromkeys(iterable, default_value)'],
    tags: ['dict', 'fromkeys'],
  },
  {
    id: 'py-dc-315',
    category: 'dict',
    difficulty: 'easy',
    title: 'Dict setdefault',
    text: 'Get value for key "d", setting default 4 if missing',
    setup: 'data = {"a": 1, "b": 2, "c": 3}',
    setupCode: 'data = {"a": 1, "b": 2, "c": 3}',
    expected: 4,
    sample: 'data.setdefault("d", 4)',
    hints: ['setdefault returns existing value or sets and returns default'],
    tags: ['dict', 'setdefault'],
  },
  {
    id: 'py-dc-316',
    category: 'dict',
    difficulty: 'medium',
    title: 'Nested Dict Comprehension',
    text: 'Create multiplication table as nested dict',
    setup: 'nums = [1, 2, 3]',
    setupCode: 'nums = [1, 2, 3]',
    expected: { 1: { 1: 1, 2: 2, 3: 3 }, 2: { 1: 2, 2: 4, 3: 6 }, 3: { 1: 3, 2: 6, 3: 9 } },
    sample: '{i: {j: i*j for j in nums} for i in nums}',
    hints: ['Nest dict comprehensions for 2D structure'],
    tags: ['dict-comprehension', 'nested'],
  },
  {
    id: 'py-dc-317',
    category: 'dict',
    difficulty: 'hard',
    title: 'Group by First Letter',
    text: 'Group words by their first letter',
    setup: 'words = ["apple", "ant", "bear", "bat", "cat"]',
    setupCode: 'words = ["apple", "ant", "bear", "bat", "cat"]',
    expected: { a: ['apple', 'ant'], b: ['bear', 'bat'], c: ['cat'] },
    sample: '{k: [w for w in words if w[0] == k] for k in set(w[0] for w in words)}',
    hints: ['Create keys from first letters, filter words for each key'],
    tags: ['dict-comprehension', 'grouping'],
  },
  {
    id: 'py-dc-318',
    category: 'dict',
    difficulty: 'medium',
    title: 'Dict Update with Unpacking',
    text: 'Merge dicts using unpacking (Python 3.5+)',
    setup: 'base = {"a": 1, "b": 2}\nupdate = {"b": 3, "c": 4}',
    setupCode: 'base = {"a": 1, "b": 2}\nupdate = {"b": 3, "c": 4}',
    expected: { a: 1, b: 3, c: 4 },
    sample: '{**base, **update}',
    hints: ['Later dicts override earlier ones when unpacking'],
    tags: ['dict', 'unpacking', 'merge'],
  },
  {
    id: 'py-dc-319',
    category: 'dict',
    difficulty: 'easy',
    title: 'Dict pop with Default',
    text: 'Remove key "x" and return its value, or -1 if not found',
    setup: 'data = {"a": 1, "b": 2}',
    setupCode: 'data = {"a": 1, "b": 2}',
    expected: -1,
    sample: 'data.pop("x", -1)',
    hints: ['pop accepts a default value for missing keys'],
    tags: ['dict', 'pop'],
  },

  // ============================================================
  // NEW PROBLEMS - Set Operations
  // ============================================================
  {
    id: 'py-set-320',
    category: 'set',
    difficulty: 'medium',
    title: 'Frozenset Creation',
    text: 'Create an immutable set from the list',
    setup: 'items = [1, 2, 3, 2, 1]',
    setupCode: 'items = [1, 2, 3, 2, 1]',
    expected: [1, 2, 3],
    sample: 'frozenset(items)',
    hints: ['frozenset is an immutable version of set'],
    tags: ['frozenset', 'immutable'],
  },
  {
    id: 'py-set-321',
    category: 'set',
    difficulty: 'hard',
    title: 'Symmetric Difference Update',
    text: 'Update set a with symmetric difference of a and b',
    setup: 'a = {1, 2, 3, 4}\nb = {3, 4, 5, 6}',
    setupCode: 'a = {1, 2, 3, 4}\nb = {3, 4, 5, 6}',
    expected: [1, 2, 5, 6],
    sample: 'a.symmetric_difference_update(b); sorted(a)',
    hints: ['symmetric_difference_update modifies set in place'],
    tags: ['set', 'symmetric_difference'],
  },
  {
    id: 'py-set-322',
    category: 'set',
    difficulty: 'medium',
    title: 'Set Difference Update',
    text: 'Remove elements of b from a in place',
    setup: 'a = {1, 2, 3, 4, 5}\nb = {2, 4}',
    setupCode: 'a = {1, 2, 3, 4, 5}\nb = {2, 4}',
    expected: [1, 3, 5],
    sample: 'a.difference_update(b); sorted(a)',
    hints: ['difference_update removes elements in place'],
    tags: ['set', 'difference'],
  },
  {
    id: 'py-set-323',
    category: 'set',
    difficulty: 'easy',
    title: 'Set Discard vs Remove',
    text: 'Safely remove element 10 from set (no error if missing)',
    setup: 's = {1, 2, 3}',
    setupCode: 's = {1, 2, 3}',
    expected: [1, 2, 3],
    sample: 's.discard(10); sorted(s)',
    hints: ['discard does not raise error for missing element'],
    tags: ['set', 'discard'],
  },
  {
    id: 'py-set-324',
    category: 'set',
    difficulty: 'medium',
    title: 'Set Comprehension with Condition',
    text: 'Create set of squares of even numbers',
    setup: 'nums = [1, 2, 3, 4, 5, 6]',
    setupCode: 'nums = [1, 2, 3, 4, 5, 6]',
    expected: [4, 16, 36],
    sample: 'sorted({x**2 for x in nums if x % 2 == 0})',
    hints: ['Set comprehension uses curly braces'],
    tags: ['set-comprehension', 'filter'],
  },
  {
    id: 'py-set-325',
    category: 'set',
    difficulty: 'hard',
    title: 'Multiple Set Intersection',
    text: 'Find common elements across all sets',
    setup: 'sets = [{1, 2, 3}, {2, 3, 4}, {3, 4, 5}]',
    setupCode: 'sets = [{1, 2, 3}, {2, 3, 4}, {3, 4, 5}]',
    expected: [3],
    sample: 'sorted(set.intersection(*sets))',
    hints: ['Use set.intersection with unpacking'],
    tags: ['set', 'intersection'],
  },
  {
    id: 'py-set-326',
    category: 'set',
    difficulty: 'medium',
    title: 'Multiple Set Union',
    text: 'Find all unique elements across all sets',
    setup: 'sets = [{1, 2}, {3, 4}, {5, 6}]',
    setupCode: 'sets = [{1, 2}, {3, 4}, {5, 6}]',
    expected: [1, 2, 3, 4, 5, 6],
    sample: 'sorted(set.union(*sets))',
    hints: ['Use set.union with unpacking'],
    tags: ['set', 'union'],
  },
  {
    id: 'py-set-327',
    category: 'set',
    difficulty: 'easy',
    title: 'Set Pop Random Element',
    text: 'Remove and return an arbitrary element from set',
    setup: 's = {42}',
    setupCode: 's = {42}',
    expected: 42,
    sample: 's.pop()',
    hints: ['pop() removes and returns arbitrary element'],
    tags: ['set', 'pop'],
  },
  {
    id: 'py-set-328',
    category: 'set',
    difficulty: 'medium',
    title: 'Frozenset as Dict Key',
    text: 'Use frozenset as dictionary key',
    setup: 'data = {}\nkey = frozenset([1, 2, 3])',
    setupCode: 'data = {}\nkey = frozenset([1, 2, 3])',
    expected: 'found',
    sample: 'data[key] = "found"; data[frozenset([1, 2, 3])]',
    hints: ['Frozensets are hashable and can be dict keys'],
    tags: ['frozenset', 'dict'],
  },
  {
    id: 'py-set-329',
    category: 'set',
    difficulty: 'hard',
    title: 'Set Algebra Expression',
    text: 'Find elements in a or b but not in both, excluding c',
    setup: 'a = {1, 2, 3}\nb = {3, 4, 5}\nc = {1, 5}',
    setupCode: 'a = {1, 2, 3}\nb = {3, 4, 5}\nc = {1, 5}',
    expected: [2, 4],
    sample: 'sorted((a ^ b) - c)',
    hints: ['^ is symmetric difference, - is difference'],
    tags: ['set', 'algebra'],
  },

  // ============================================================
  // NEW PROBLEMS - String Methods Advanced
  // ============================================================
  {
    id: 'py-str-330',
    category: 'string',
    difficulty: 'medium',
    title: 'F-String with Expression',
    text: 'Create f-string showing calculation result',
    setup: 'x = 10\ny = 3',
    setupCode: 'x = 10\ny = 3',
    expected: '10 + 3 = 13',
    sample: 'f"{x} + {y} = {x + y}"',
    hints: ['F-strings can contain expressions'],
    tags: ['f-string', 'expression'],
  },
  {
    id: 'py-str-331',
    category: 'string',
    difficulty: 'hard',
    title: 'F-String Debug Mode',
    text: 'Use f-string debug format (Python 3.8+)',
    setup: 'value = 42',
    setupCode: 'value = 42',
    expected: 'value=42',
    sample: 'f"{value=}"',
    hints: ['Use = after variable name in f-string for debug output'],
    tags: ['f-string', 'debug', 'python38'],
  },
  {
    id: 'py-str-332',
    category: 'string',
    difficulty: 'medium',
    title: 'Format Map',
    text: 'Format string using dictionary mapping',
    setup: 'template = "{name} is {age} years old"\ndata = {"name": "Bob", "age": 25}',
    setupCode: 'template = "{name} is {age} years old"\ndata = {"name": "Bob", "age": 25}',
    expected: 'Bob is 25 years old',
    sample: 'template.format_map(data)',
    hints: ['format_map uses dict directly instead of keyword args'],
    tags: ['string', 'format_map'],
  },
  {
    id: 'py-str-333',
    category: 'string',
    difficulty: 'hard',
    title: 'Maketrans and Translate',
    text: 'Replace vowels with numbers (a=1, e=2, i=3, o=4, u=5)',
    setup: 'text = "hello world"',
    setupCode: 'text = "hello world"',
    expected: 'h2ll4 w4rld',
    sample: 'text.translate(str.maketrans("aeiou", "12345"))',
    hints: ['maketrans creates translation table, translate applies it'],
    tags: ['string', 'maketrans', 'translate'],
  },
  {
    id: 'py-str-334',
    category: 'string',
    difficulty: 'medium',
    title: 'F-String Alignment',
    text: 'Center the text in 20 characters with dashes',
    setup: 'text = "Python"',
    setupCode: 'text = "Python"',
    expected: '-------Python-------',
    sample: 'f"{text:-^20}"',
    hints: ['Use :fill^width for center alignment'],
    tags: ['f-string', 'alignment'],
  },
  {
    id: 'py-str-335',
    category: 'string',
    difficulty: 'medium',
    title: 'F-String Thousand Separator',
    text: 'Format large number with comma separators',
    setup: 'num = 1234567890',
    setupCode: 'num = 1234567890',
    expected: '1,234,567,890',
    sample: 'f"{num:,}"',
    hints: ['Use :, for thousand separators'],
    tags: ['f-string', 'formatting'],
  },
  {
    id: 'py-str-336',
    category: 'string',
    difficulty: 'hard',
    title: 'Translate with Deletion',
    text: 'Remove all digits from string',
    setup: 'text = "abc123def456"',
    setupCode: 'text = "abc123def456"',
    expected: 'abcdef',
    sample: 'text.translate(str.maketrans("", "", "0123456789"))',
    hints: ['Third argument to maketrans specifies chars to delete'],
    tags: ['string', 'translate', 'delete'],
  },
  {
    id: 'py-str-337',
    category: 'string',
    difficulty: 'medium',
    title: 'F-String Binary Format',
    text: 'Format number as binary with prefix',
    setup: 'num = 42',
    setupCode: 'num = 42',
    expected: '0b101010',
    sample: 'f"{num:#b}"',
    hints: ['Use #b for binary with 0b prefix'],
    tags: ['f-string', 'binary'],
  },
  {
    id: 'py-str-338',
    category: 'string',
    difficulty: 'medium',
    title: 'F-String Hex Format',
    text: 'Format number as uppercase hex with prefix',
    setup: 'num = 255',
    setupCode: 'num = 255',
    expected: '0xFF',
    sample: 'f"{num:#X}"',
    hints: ['Use #X for uppercase hex with 0x prefix'],
    tags: ['f-string', 'hex'],
  },
  {
    id: 'py-str-339',
    category: 'string',
    difficulty: 'hard',
    title: 'F-String Nested Format',
    text: 'Use variable for format width',
    setup: 'text = "hi"\nwidth = 10',
    setupCode: 'text = "hi"\nwidth = 10',
    expected: '    hi    ',
    sample: 'f"{text:^{width}}"',
    hints: ['Nest curly braces for dynamic format specs'],
    tags: ['f-string', 'nested', 'dynamic'],
  },

  // ============================================================
  // NEW PROBLEMS - Itertools
  // ============================================================
  {
    id: 'py-it-340',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Starmap Function',
    text: 'Apply pow function to pairs using starmap',
    setup: 'from itertools import starmap\npairs = [(2, 3), (3, 2), (4, 2)]',
    setupCode: 'from itertools import starmap\npairs = [(2, 3), (3, 2), (4, 2)]',
    expected: [8, 9, 16],
    sample: 'list(starmap(pow, pairs))',
    hints: ['starmap unpacks arguments from each tuple'],
    tags: ['itertools', 'starmap'],
  },
  {
    id: 'py-it-341',
    category: 'itertools',
    difficulty: 'hard',
    title: 'Tee Iterator',
    text: 'Create two independent iterators from one',
    setup: 'from itertools import tee\noriginal = iter([1, 2, 3])',
    setupCode: 'from itertools import tee\noriginal = iter([1, 2, 3])\na, b = tee(original)',
    expected: [
      [1, 2, 3],
      [1, 2, 3],
    ],
    sample: '[list(a), list(b)]',
    hints: ['tee creates n independent iterators from one'],
    tags: ['itertools', 'tee'],
  },
  {
    id: 'py-it-342',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Cycle Iterator',
    text: 'Get first 7 elements cycling through a list',
    setup: 'from itertools import cycle, islice\nitems = ["a", "b", "c"]',
    setupCode: 'from itertools import cycle, islice\nitems = ["a", "b", "c"]',
    expected: ['a', 'b', 'c', 'a', 'b', 'c', 'a'],
    sample: 'list(islice(cycle(items), 7))',
    hints: ['cycle repeats infinitely, use islice to limit'],
    tags: ['itertools', 'cycle', 'islice'],
  },
  {
    id: 'py-it-343',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Repeat with Limit',
    text: 'Repeat value 5 times',
    setup: 'from itertools import repeat',
    setupCode: 'from itertools import repeat',
    expected: ['x', 'x', 'x', 'x', 'x'],
    sample: 'list(repeat("x", 5))',
    hints: ['repeat takes value and optional times argument'],
    tags: ['itertools', 'repeat'],
  },
  {
    id: 'py-it-344',
    category: 'itertools',
    difficulty: 'hard',
    title: 'Accumulate with Operator',
    text: 'Running product of numbers',
    setup: 'from itertools import accumulate\nimport operator\nnums = [1, 2, 3, 4, 5]',
    setupCode: 'from itertools import accumulate\nimport operator\nnums = [1, 2, 3, 4, 5]',
    expected: [1, 2, 6, 24, 120],
    sample: 'list(accumulate(nums, operator.mul))',
    hints: ['accumulate accepts optional function argument'],
    tags: ['itertools', 'accumulate'],
  },
  {
    id: 'py-it-345',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Chain from Iterable',
    text: 'Flatten list of lists using chain.from_iterable',
    setup: 'from itertools import chain\nnested = [[1, 2], [3, 4], [5, 6]]',
    setupCode: 'from itertools import chain\nnested = [[1, 2], [3, 4], [5, 6]]',
    expected: [1, 2, 3, 4, 5, 6],
    sample: 'list(chain.from_iterable(nested))',
    hints: ['chain.from_iterable takes single iterable of iterables'],
    tags: ['itertools', 'chain'],
  },
  {
    id: 'py-it-346',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Dropwhile',
    text: 'Skip elements while condition is true',
    setup: 'from itertools import dropwhile\nnums = [1, 3, 5, 2, 4, 6]',
    setupCode: 'from itertools import dropwhile\nnums = [1, 3, 5, 2, 4, 6]',
    expected: [2, 4, 6],
    sample: 'list(dropwhile(lambda x: x % 2 != 0, nums))',
    hints: ['dropwhile skips until predicate becomes false'],
    tags: ['itertools', 'dropwhile'],
  },
  {
    id: 'py-it-347',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Takewhile',
    text: 'Take elements while condition is true',
    setup: 'from itertools import takewhile\nnums = [2, 4, 6, 1, 3, 5]',
    setupCode: 'from itertools import takewhile\nnums = [2, 4, 6, 1, 3, 5]',
    expected: [2, 4, 6],
    sample: 'list(takewhile(lambda x: x % 2 == 0, nums))',
    hints: ['takewhile stops when predicate becomes false'],
    tags: ['itertools', 'takewhile'],
  },
  {
    id: 'py-it-348',
    category: 'itertools',
    difficulty: 'hard',
    title: 'Combinations with Replacement',
    text: 'Get all 2-element combinations with replacement',
    setup: 'from itertools import combinations_with_replacement\nitems = ["a", "b"]',
    setupCode: 'from itertools import combinations_with_replacement\nitems = ["a", "b"]',
    expected: [
      ['a', 'a'],
      ['a', 'b'],
      ['b', 'b'],
    ],
    sample: 'list(combinations_with_replacement(items, 2))',
    hints: ['Allows repeated elements in combinations'],
    tags: ['itertools', 'combinations'],
  },
  {
    id: 'py-it-349',
    category: 'itertools',
    difficulty: 'hard',
    title: 'Product with Repeat',
    text: 'Cartesian product of list with itself 3 times',
    setup: 'from itertools import product\nitems = [0, 1]',
    setupCode: 'from itertools import product\nitems = [0, 1]',
    expected: [
      [0, 0, 0],
      [0, 0, 1],
      [0, 1, 0],
      [0, 1, 1],
      [1, 0, 0],
      [1, 0, 1],
      [1, 1, 0],
      [1, 1, 1],
    ],
    sample: 'list(product(items, repeat=3))',
    hints: ['product repeat parameter for multiple copies'],
    tags: ['itertools', 'product'],
  },

  // ============================================================
  // NEW PROBLEMS - Functools
  // ============================================================
  {
    id: 'py-ft-350',
    category: 'functools',
    difficulty: 'medium',
    title: 'Reduce Sum',
    text: 'Sum numbers using reduce',
    setup: 'from functools import reduce\nnums = [1, 2, 3, 4, 5]',
    setupCode: 'from functools import reduce\nnums = [1, 2, 3, 4, 5]',
    expected: 15,
    sample: 'reduce(lambda a, b: a + b, nums)',
    hints: ['reduce applies function cumulatively'],
    tags: ['functools', 'reduce'],
  },
  {
    id: 'py-ft-351',
    category: 'functools',
    difficulty: 'medium',
    title: 'Reduce with Initial',
    text: 'Product of numbers with initial value 10',
    setup: 'from functools import reduce\nnums = [1, 2, 3]',
    setupCode: 'from functools import reduce\nnums = [1, 2, 3]',
    expected: 60,
    sample: 'reduce(lambda a, b: a * b, nums, 10)',
    hints: ['Third argument is initial value'],
    tags: ['functools', 'reduce'],
  },
  {
    id: 'py-ft-352',
    category: 'functools',
    difficulty: 'medium',
    title: 'Partial Function',
    text: 'Create function that always multiplies by 10',
    setup: 'from functools import partial\ndef multiply(a, b): return a * b',
    setupCode:
      'from functools import partial\ndef multiply(a, b): return a * b\nmul10 = partial(multiply, 10)',
    expected: 50,
    sample: 'mul10(5)',
    hints: ['partial fixes some arguments of a function'],
    tags: ['functools', 'partial'],
  },
  {
    id: 'py-ft-353',
    category: 'functools',
    difficulty: 'hard',
    title: 'LRU Cache Usage',
    text: 'Check if cached function returns same object',
    setup: 'from functools import lru_cache\n@lru_cache(maxsize=2)\ndef square(n): return n ** 2',
    setupCode:
      'from functools import lru_cache\n@lru_cache(maxsize=2)\ndef square(n): return n ** 2\n_ = square(5)',
    expected: 25,
    sample: 'square(5)',
    hints: ['lru_cache memoizes function results'],
    tags: ['functools', 'lru_cache', 'decorator'],
  },
  {
    id: 'py-ft-354',
    category: 'functools',
    difficulty: 'hard',
    title: 'Total Ordering',
    text: 'Check comparison after total_ordering',
    setup:
      'from functools import total_ordering\n@total_ordering\nclass Num:\n    def __init__(self, v): self.v = v\n    def __eq__(self, o): return self.v == o.v\n    def __lt__(self, o): return self.v < o.v',
    setupCode:
      'from functools import total_ordering\n@total_ordering\nclass Num:\n    def __init__(self, v): self.v = v\n    def __eq__(self, o): return self.v == o.v\n    def __lt__(self, o): return self.v < o.v\na, b = Num(3), Num(5)',
    expected: true,
    sample: 'a <= b',
    hints: ['total_ordering fills in comparison methods'],
    tags: ['functools', 'total_ordering', 'decorator'],
  },
  {
    id: 'py-ft-355',
    category: 'functools',
    difficulty: 'hard',
    title: 'Singledispatch',
    text: 'Generic function dispatching by type',
    setup:
      'from functools import singledispatch\n@singledispatch\ndef process(x): return "unknown"\n@process.register(int)\ndef _(x): return "integer"\n@process.register(str)\ndef _(x): return "string"',
    setupCode:
      'from functools import singledispatch\n@singledispatch\ndef process(x): return "unknown"\n@process.register(int)\ndef _(x): return "integer"\n@process.register(str)\ndef _(x): return "string"',
    expected: 'integer',
    sample: 'process(42)',
    hints: ['singledispatch chooses implementation by argument type'],
    tags: ['functools', 'singledispatch'],
  },
  {
    id: 'py-ft-356',
    category: 'functools',
    difficulty: 'medium',
    title: 'Reduce Find Max',
    text: 'Find maximum using reduce',
    setup: 'from functools import reduce\nnums = [3, 7, 2, 9, 4]',
    setupCode: 'from functools import reduce\nnums = [3, 7, 2, 9, 4]',
    expected: 9,
    sample: 'reduce(lambda a, b: a if a > b else b, nums)',
    hints: ['Compare and keep larger value'],
    tags: ['functools', 'reduce'],
  },
  {
    id: 'py-ft-357',
    category: 'functools',
    difficulty: 'medium',
    title: 'Partial with Keyword',
    text: 'Create print function that always ends with "!"',
    setup: 'from functools import partial',
    setupCode: 'from functools import partial\nshout = partial(print, end="!")',
    expected: null,
    sample: 'shout("Hello")',
    hints: ['partial can fix keyword arguments too'],
    tags: ['functools', 'partial'],
  },
  {
    id: 'py-ft-358',
    category: 'functools',
    difficulty: 'hard',
    title: 'Cache Property',
    text: 'Check cached_property only computes once',
    setup:
      'from functools import cached_property\nclass C:\n    def __init__(self): self.count = 0\n    @cached_property\n    def val(self):\n        self.count += 1\n        return 42',
    setupCode:
      'from functools import cached_property\nclass C:\n    def __init__(self): self.count = 0\n    @cached_property\n    def val(self):\n        self.count += 1\n        return 42\nc = C()\n_ = c.val\n_ = c.val',
    expected: 1,
    sample: 'c.count',
    hints: ['cached_property computes value only once'],
    tags: ['functools', 'cached_property'],
  },
  {
    id: 'py-ft-359',
    category: 'functools',
    difficulty: 'hard',
    title: 'Reduce Flatten',
    text: 'Flatten nested list using reduce',
    setup: 'from functools import reduce\nnested = [[1, 2], [3, 4], [5, 6]]',
    setupCode: 'from functools import reduce\nnested = [[1, 2], [3, 4], [5, 6]]',
    expected: [1, 2, 3, 4, 5, 6],
    sample: 'reduce(lambda a, b: a + b, nested)',
    hints: ['Concatenate lists with +'],
    tags: ['functools', 'reduce', 'flatten'],
  },

  // ============================================================
  // NEW PROBLEMS - Collections
  // ============================================================
  {
    id: 'py-col-360',
    category: 'collections',
    difficulty: 'easy',
    title: 'Counter Most Common',
    text: 'Get the 2 most common elements',
    setup: 'from collections import Counter\nletters = "abracadabra"',
    setupCode: 'from collections import Counter\nletters = "abracadabra"',
    expected: [
      ['a', 5],
      ['b', 2],
    ],
    sample: 'Counter(letters).most_common(2)',
    hints: ['most_common(n) returns n most frequent'],
    tags: ['collections', 'counter'],
  },
  {
    id: 'py-col-361',
    category: 'collections',
    difficulty: 'medium',
    title: 'Counter Arithmetic',
    text: 'Subtract one counter from another',
    setup: 'from collections import Counter\na = Counter("aabbcc")\nb = Counter("abc")',
    setupCode: 'from collections import Counter\na = Counter("aabbcc")\nb = Counter("abc")',
    expected: { a: 1, b: 1, c: 1 },
    sample: 'dict(a - b)',
    hints: ['Counter supports arithmetic operations'],
    tags: ['collections', 'counter', 'arithmetic'],
  },
  {
    id: 'py-col-362',
    category: 'collections',
    difficulty: 'easy',
    title: 'Defaultdict List',
    text: 'Group numbers by even/odd using defaultdict',
    setup: 'from collections import defaultdict\nnums = [1, 2, 3, 4, 5, 6]',
    setupCode:
      'from collections import defaultdict\nnums = [1, 2, 3, 4, 5, 6]\ngroups = defaultdict(list)\nfor n in nums:\n    groups["even" if n % 2 == 0 else "odd"].append(n)',
    expected: { even: [2, 4, 6], odd: [1, 3, 5] },
    sample: 'dict(groups)',
    hints: ['defaultdict(list) creates empty list for missing keys'],
    tags: ['collections', 'defaultdict'],
  },
  {
    id: 'py-col-363',
    category: 'collections',
    difficulty: 'medium',
    title: 'Defaultdict Counter',
    text: 'Count occurrences using defaultdict(int)',
    setup: 'from collections import defaultdict\nwords = ["a", "b", "a", "c", "b", "a"]',
    setupCode:
      'from collections import defaultdict\nwords = ["a", "b", "a", "c", "b", "a"]\ncounts = defaultdict(int)\nfor w in words:\n    counts[w] += 1',
    expected: { a: 3, b: 2, c: 1 },
    sample: 'dict(counts)',
    hints: ['defaultdict(int) defaults to 0'],
    tags: ['collections', 'defaultdict'],
  },
  {
    id: 'py-col-364',
    category: 'collections',
    difficulty: 'medium',
    title: 'OrderedDict Move to End',
    text: 'Move key "b" to the end of ordered dict',
    setup: 'from collections import OrderedDict\nod = OrderedDict([("a", 1), ("b", 2), ("c", 3)])',
    setupCode:
      'from collections import OrderedDict\nod = OrderedDict([("a", 1), ("b", 2), ("c", 3)])',
    expected: ['a', 'c', 'b'],
    sample: 'od.move_to_end("b"); list(od.keys())',
    hints: ['move_to_end repositions a key'],
    tags: ['collections', 'ordereddict'],
  },
  {
    id: 'py-col-365',
    category: 'collections',
    difficulty: 'easy',
    title: 'Namedtuple Creation',
    text: 'Create and use a Point namedtuple',
    setup: 'from collections import namedtuple\nPoint = namedtuple("Point", ["x", "y"])',
    setupCode:
      'from collections import namedtuple\nPoint = namedtuple("Point", ["x", "y"])\np = Point(3, 4)',
    expected: 3,
    sample: 'p.x',
    hints: ['Access namedtuple fields by name'],
    tags: ['collections', 'namedtuple'],
  },
  {
    id: 'py-col-366',
    category: 'collections',
    difficulty: 'medium',
    title: 'Namedtuple _replace',
    text: 'Create new point with different y value',
    setup:
      'from collections import namedtuple\nPoint = namedtuple("Point", ["x", "y"])\np = Point(3, 4)',
    setupCode:
      'from collections import namedtuple\nPoint = namedtuple("Point", ["x", "y"])\np = Point(3, 4)',
    expected: [3, 10],
    sample: 'list(p._replace(y=10))',
    hints: ['_replace creates new namedtuple with changes'],
    tags: ['collections', 'namedtuple'],
  },
  {
    id: 'py-col-367',
    category: 'collections',
    difficulty: 'easy',
    title: 'Deque Append Left',
    text: 'Add element to left of deque',
    setup: 'from collections import deque\nd = deque([1, 2, 3])',
    setupCode: 'from collections import deque\nd = deque([1, 2, 3])',
    expected: [0, 1, 2, 3],
    sample: 'd.appendleft(0); list(d)',
    hints: ['appendleft adds to beginning'],
    tags: ['collections', 'deque'],
  },
  {
    id: 'py-col-368',
    category: 'collections',
    difficulty: 'medium',
    title: 'Deque Rotate',
    text: 'Rotate deque right by 2 positions',
    setup: 'from collections import deque\nd = deque([1, 2, 3, 4, 5])',
    setupCode: 'from collections import deque\nd = deque([1, 2, 3, 4, 5])',
    expected: [4, 5, 1, 2, 3],
    sample: 'd.rotate(2); list(d)',
    hints: ['Positive rotate moves right, negative moves left'],
    tags: ['collections', 'deque', 'rotate'],
  },
  {
    id: 'py-col-369',
    category: 'collections',
    difficulty: 'medium',
    title: 'Deque Maxlen',
    text: 'Create bounded deque that keeps last 3 elements',
    setup: 'from collections import deque',
    setupCode: 'from collections import deque\nd = deque(maxlen=3)\nfor i in range(5): d.append(i)',
    expected: [2, 3, 4],
    sample: 'list(d)',
    hints: ['maxlen limits deque size, old items are dropped'],
    tags: ['collections', 'deque', 'maxlen'],
  },

  // ============================================================
  // NEW PROBLEMS - Generators
  // ============================================================
  {
    id: 'py-gen-370',
    category: 'generators',
    difficulty: 'easy',
    title: 'Generator Expression Sum',
    text: 'Sum squares using generator expression',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode: 'nums = [1, 2, 3, 4, 5]',
    expected: 55,
    sample: 'sum(x**2 for x in nums)',
    hints: ['Generator expressions use parentheses'],
    tags: ['generator', 'expression'],
  },
  {
    id: 'py-gen-371',
    category: 'generators',
    difficulty: 'medium',
    title: 'Yield From',
    text: 'Flatten using yield from',
    setup:
      'def flatten(nested):\n    for item in nested:\n        yield from item\nnested = [[1, 2], [3, 4]]',
    setupCode:
      'def flatten(nested):\n    for item in nested:\n        yield from item\nnested = [[1, 2], [3, 4]]',
    expected: [1, 2, 3, 4],
    sample: 'list(flatten(nested))',
    hints: ['yield from delegates to sub-generator'],
    tags: ['generator', 'yield-from'],
  },
  {
    id: 'py-gen-372',
    category: 'generators',
    difficulty: 'hard',
    title: 'Generator Send',
    text: 'Send value to generator',
    setup:
      'def accumulator():\n    total = 0\n    while True:\n        value = yield total\n        if value is not None:\n            total += value',
    setupCode:
      'def accumulator():\n    total = 0\n    while True:\n        value = yield total\n        if value is not None:\n            total += value\nacc = accumulator()\nnext(acc)\nacc.send(10)\nacc.send(5)',
    expected: 15,
    sample: 'acc.send(0)',
    hints: ['send() resumes generator with a value'],
    tags: ['generator', 'send', 'coroutine'],
  },
  {
    id: 'py-gen-373',
    category: 'generators',
    difficulty: 'medium',
    title: 'Generator with Filter',
    text: 'Generator expression with condition',
    setup: 'words = ["hello", "hi", "world", "python"]',
    setupCode: 'words = ["hello", "hi", "world", "python"]',
    expected: ['hello', 'hi'],
    sample: 'list(w for w in words if w.startswith("h"))',
    hints: ['Add if clause at end of generator expression'],
    tags: ['generator', 'filter'],
  },
  {
    id: 'py-gen-374',
    category: 'generators',
    difficulty: 'hard',
    title: 'Generator Throw',
    text: 'Throw exception into generator',
    setup:
      'def gen():\n    try:\n        yield 1\n        yield 2\n    except ValueError:\n        yield "caught"',
    setupCode:
      'def gen():\n    try:\n        yield 1\n        yield 2\n    except ValueError:\n        yield "caught"\ng = gen()\nnext(g)',
    expected: 'caught',
    sample: 'g.throw(ValueError)',
    hints: ['throw() raises exception at yield point'],
    tags: ['generator', 'throw', 'exception'],
  },
  {
    id: 'py-gen-375',
    category: 'generators',
    difficulty: 'medium',
    title: 'Infinite Counter Generator',
    text: 'Create generator that counts from n',
    setup: 'def counter(n):\n    while True:\n        yield n\n        n += 1',
    setupCode:
      'def counter(n):\n    while True:\n        yield n\n        n += 1\nfrom itertools import islice\nc = counter(10)',
    expected: [10, 11, 12, 13, 14],
    sample: 'list(islice(c, 5))',
    hints: ['Use islice to take finite portion'],
    tags: ['generator', 'infinite'],
  },
  {
    id: 'py-gen-376',
    category: 'generators',
    difficulty: 'medium',
    title: 'Generator Close',
    text: 'Close generator and handle cleanup',
    setup:
      'results = []\ndef gen():\n    try:\n        yield 1\n        yield 2\n    finally:\n        results.append("cleaned")',
    setupCode:
      'results = []\ndef gen():\n    try:\n        yield 1\n        yield 2\n    finally:\n        results.append("cleaned")\ng = gen()\nnext(g)\ng.close()',
    expected: ['cleaned'],
    sample: 'results',
    hints: ['close() triggers finally block'],
    tags: ['generator', 'close', 'cleanup'],
  },
  {
    id: 'py-gen-377',
    category: 'generators',
    difficulty: 'hard',
    title: 'Yield From Return Value',
    text: 'Get return value from delegated generator',
    setup:
      'def inner():\n    yield 1\n    yield 2\n    return "done"\ndef outer():\n    result = yield from inner()\n    yield result',
    setupCode:
      'def inner():\n    yield 1\n    yield 2\n    return "done"\ndef outer():\n    result = yield from inner()\n    yield result\ng = outer()',
    expected: [1, 2, 'done'],
    sample: 'list(g)',
    hints: ['yield from captures return value of subgenerator'],
    tags: ['generator', 'yield-from', 'return'],
  },
  {
    id: 'py-gen-378',
    category: 'generators',
    difficulty: 'easy',
    title: 'Generator Next with Default',
    text: 'Get next value or default if exhausted',
    setup: 'gen = (x for x in [1, 2])',
    setupCode: 'gen = (x for x in [1, 2])\nnext(gen)\nnext(gen)',
    expected: 'empty',
    sample: 'next(gen, "empty")',
    hints: ['next() accepts default value for StopIteration'],
    tags: ['generator', 'next'],
  },
  {
    id: 'py-gen-379',
    category: 'generators',
    difficulty: 'medium',
    title: 'Chained Generator Expressions',
    text: 'Chain multiple transformations lazily',
    setup: 'nums = [1, 2, 3, 4, 5]',
    setupCode:
      'nums = [1, 2, 3, 4, 5]\nsquared = (x**2 for x in nums)\nfiltered = (x for x in squared if x > 5)',
    expected: [9, 16, 25],
    sample: 'list(filtered)',
    hints: ['Generator expressions compose lazily'],
    tags: ['generator', 'composition'],
  },

  // ============================================================
  // NEW PROBLEMS - Decorators
  // ============================================================
  {
    id: 'py-dec-380',
    category: 'decorators',
    difficulty: 'medium',
    title: 'Simple Function Decorator',
    text: 'Decorator that prints before and after',
    setup:
      'def trace(fn):\n    def wrapper(*args):\n        print("before")\n        result = fn(*args)\n        print("after")\n        return result\n    return wrapper\n@trace\ndef add(a, b): return a + b',
    setupCode:
      'def trace(fn):\n    def wrapper(*args):\n        result = fn(*args)\n        return result\n    return wrapper\n@trace\ndef add(a, b): return a + b',
    expected: 8,
    sample: 'add(3, 5)',
    hints: ['Decorator wraps function with additional behavior'],
    tags: ['decorator', 'function'],
  },
  {
    id: 'py-dec-381',
    category: 'decorators',
    difficulty: 'hard',
    title: 'Decorator Factory with Arguments',
    text: 'Create decorator that repeats function n times',
    setup:
      'def repeat(n):\n    def decorator(fn):\n        def wrapper(*args):\n            for _ in range(n): fn(*args)\n        return wrapper\n    return decorator\nresults = []\n@repeat(3)\ndef append_one(): results.append(1)',
    setupCode:
      'def repeat(n):\n    def decorator(fn):\n        def wrapper(*args):\n            for _ in range(n): fn(*args)\n        return wrapper\n    return decorator\nresults = []\n@repeat(3)\ndef append_one(): results.append(1)\nappend_one()',
    expected: [1, 1, 1],
    sample: 'results',
    hints: ['Decorator factory returns decorator'],
    tags: ['decorator', 'factory'],
  },
  {
    id: 'py-dec-382',
    category: 'decorators',
    difficulty: 'medium',
    title: 'Functools Wraps',
    text: 'Preserve function metadata with wraps',
    setup:
      'from functools import wraps\ndef logged(fn):\n    @wraps(fn)\n    def wrapper(*args): return fn(*args)\n    return wrapper\n@logged\ndef greet():\n    """Say hello"""\n    return "hello"',
    setupCode:
      'from functools import wraps\ndef logged(fn):\n    @wraps(fn)\n    def wrapper(*args): return fn(*args)\n    return wrapper\n@logged\ndef greet():\n    """Say hello"""\n    return "hello"',
    expected: 'greet',
    sample: 'greet.__name__',
    hints: ['wraps preserves __name__, __doc__, etc.'],
    tags: ['decorator', 'functools', 'wraps'],
  },
  {
    id: 'py-dec-383',
    category: 'decorators',
    difficulty: 'hard',
    title: 'Class Decorator',
    text: 'Decorator that adds method to class',
    setup:
      'def add_repr(cls):\n    def __repr__(self):\n        return f"{cls.__name__}({self.__dict__})"\n    cls.__repr__ = __repr__\n    return cls\n@add_repr\nclass Person:\n    def __init__(self, name): self.name = name',
    setupCode:
      'def add_repr(cls):\n    def __repr__(self):\n        return f"{cls.__name__}({self.__dict__})"\n    cls.__repr__ = __repr__\n    return cls\n@add_repr\nclass Person:\n    def __init__(self, name): self.name = name\np = Person("Alice")',
    expected: "Person({'name': 'Alice'})",
    sample: 'repr(p)',
    hints: ['Class decorators modify or wrap classes'],
    tags: ['decorator', 'class'],
  },
  {
    id: 'py-dec-384',
    category: 'decorators',
    difficulty: 'medium',
    title: 'Decorator with Return Value',
    text: 'Decorator that doubles the return value',
    setup:
      'def double_result(fn):\n    def wrapper(*args):\n        return fn(*args) * 2\n    return wrapper\n@double_result\ndef get_value(): return 21',
    setupCode:
      'def double_result(fn):\n    def wrapper(*args):\n        return fn(*args) * 2\n    return wrapper\n@double_result\ndef get_value(): return 21',
    expected: 42,
    sample: 'get_value()',
    hints: ['Wrapper can modify return value'],
    tags: ['decorator', 'transform'],
  },
  {
    id: 'py-dec-385',
    category: 'decorators',
    difficulty: 'hard',
    title: 'Decorator with Optional Arguments',
    text: 'Decorator that works with or without arguments',
    setup:
      'def optional_args(fn=None, *, prefix=""):\n    def decorator(fn):\n        def wrapper(*args):\n            return prefix + str(fn(*args))\n        return wrapper\n    return decorator(fn) if fn else decorator\n@optional_args(prefix="Result: ")\ndef compute(): return 42',
    setupCode:
      'def optional_args(fn=None, *, prefix=""):\n    def decorator(fn):\n        def wrapper(*args):\n            return prefix + str(fn(*args))\n        return wrapper\n    return decorator(fn) if fn else decorator\n@optional_args(prefix="Result: ")\ndef compute(): return 42',
    expected: 'Result: 42',
    sample: 'compute()',
    hints: ['Check if fn is provided to handle both cases'],
    tags: ['decorator', 'advanced'],
  },
  {
    id: 'py-dec-386',
    category: 'decorators',
    difficulty: 'medium',
    title: 'Method Decorator',
    text: 'Decorator for instance methods',
    setup:
      'def validate_positive(fn):\n    def wrapper(self, value):\n        if value < 0: raise ValueError("negative")\n        return fn(self, value)\n    return wrapper\nclass Account:\n    def __init__(self): self.balance = 0\n    @validate_positive\n    def deposit(self, amount): self.balance += amount; return self.balance',
    setupCode:
      'def validate_positive(fn):\n    def wrapper(self, value):\n        if value < 0: raise ValueError("negative")\n        return fn(self, value)\n    return wrapper\nclass Account:\n    def __init__(self): self.balance = 0\n    @validate_positive\n    def deposit(self, amount): self.balance += amount; return self.balance\nacc = Account()',
    expected: 100,
    sample: 'acc.deposit(100)',
    hints: ['Include self in wrapper for methods'],
    tags: ['decorator', 'method'],
  },
  {
    id: 'py-dec-387',
    category: 'decorators',
    difficulty: 'hard',
    title: 'Stacked Decorators',
    text: 'Apply multiple decorators in order',
    setup:
      'def add_one(fn):\n    def w(*a): return fn(*a) + 1\n    return w\ndef double(fn):\n    def w(*a): return fn(*a) * 2\n    return w\n@add_one\n@double\ndef value(): return 5',
    setupCode:
      'def add_one(fn):\n    def w(*a): return fn(*a) + 1\n    return w\ndef double(fn):\n    def w(*a): return fn(*a) * 2\n    return w\n@add_one\n@double\ndef value(): return 5',
    expected: 11,
    sample: 'value()',
    hints: ['Decorators apply bottom to top, execute top to bottom'],
    tags: ['decorator', 'stacking'],
  },
  {
    id: 'py-dec-388',
    category: 'decorators',
    difficulty: 'medium',
    title: 'Memoization Decorator',
    text: 'Simple caching decorator',
    setup:
      'def memoize(fn):\n    cache = {}\n    def wrapper(*args):\n        if args not in cache:\n            cache[args] = fn(*args)\n        return cache[args]\n    return wrapper\ncall_count = 0\n@memoize\ndef expensive(n):\n    global call_count\n    call_count += 1\n    return n * 2',
    setupCode:
      'def memoize(fn):\n    cache = {}\n    def wrapper(*args):\n        if args not in cache:\n            cache[args] = fn(*args)\n        return cache[args]\n    return wrapper\ncall_count = 0\n@memoize\ndef expensive(n):\n    global call_count\n    call_count += 1\n    return n * 2\nexpensive(5)\nexpensive(5)\nexpensive(5)',
    expected: 1,
    sample: 'call_count',
    hints: ['Cache results in closure dictionary'],
    tags: ['decorator', 'memoization', 'cache'],
  },
  {
    id: 'py-dec-389',
    category: 'decorators',
    difficulty: 'hard',
    title: 'Decorator Registry',
    text: 'Register functions in a dictionary',
    setup:
      'registry = {}\ndef register(name):\n    def decorator(fn):\n        registry[name] = fn\n        return fn\n    return decorator\n@register("hello")\ndef say_hello(): return "Hello!"',
    setupCode:
      'registry = {}\ndef register(name):\n    def decorator(fn):\n        registry[name] = fn\n        return fn\n    return decorator\n@register("hello")\ndef say_hello(): return "Hello!"',
    expected: 'Hello!',
    sample: 'registry["hello"]()',
    hints: ['Decorator can store function in external structure'],
    tags: ['decorator', 'registry', 'pattern'],
  },

  // ============================================================
  // NEW PROBLEMS - Context Managers
  // ============================================================
  {
    id: 'py-ctx-390',
    category: 'context-managers',
    difficulty: 'medium',
    title: 'Contextlib Contextmanager',
    text: 'Create context manager with generator',
    setup:
      'from contextlib import contextmanager\nlog = []\n@contextmanager\ndef tracked():\n    log.append("enter")\n    yield\n    log.append("exit")',
    setupCode:
      'from contextlib import contextmanager\nlog = []\n@contextmanager\ndef tracked():\n    log.append("enter")\n    yield\n    log.append("exit")\nwith tracked(): pass',
    expected: ['enter', 'exit'],
    sample: 'log',
    hints: ['Code before yield is __enter__, after is __exit__'],
    tags: ['contextlib', 'contextmanager'],
  },
  {
    id: 'py-ctx-391',
    category: 'context-managers',
    difficulty: 'medium',
    title: 'Context Manager Class',
    text: 'Implement context manager with class',
    setup:
      'class Timer:\n    def __enter__(self): self.started = True; return self\n    def __exit__(self, *args): self.stopped = True',
    setupCode:
      'class Timer:\n    def __enter__(self): self.started = True; return self\n    def __exit__(self, *args): self.stopped = True\nt = Timer()\nwith t: pass',
    expected: true,
    sample: 't.stopped',
    hints: ['__enter__ returns context, __exit__ cleans up'],
    tags: ['context-manager', 'class'],
  },
  {
    id: 'py-ctx-392',
    category: 'context-managers',
    difficulty: 'hard',
    title: 'ExitStack Usage',
    text: 'Manage multiple context managers',
    setup:
      'from contextlib import ExitStack, contextmanager\nlog = []\n@contextmanager\ndef cm(name):\n    log.append(f"{name} enter")\n    yield\n    log.append(f"{name} exit")',
    setupCode:
      'from contextlib import ExitStack, contextmanager\nlog = []\n@contextmanager\ndef cm(name):\n    log.append(f"{name} enter")\n    yield\n    log.append(f"{name} exit")\nwith ExitStack() as stack:\n    stack.enter_context(cm("a"))\n    stack.enter_context(cm("b"))',
    expected: ['a enter', 'b enter', 'b exit', 'a exit'],
    sample: 'log',
    hints: ['ExitStack manages multiple context managers'],
    tags: ['contextlib', 'exitstack'],
  },
  {
    id: 'py-ctx-393',
    category: 'context-managers',
    difficulty: 'medium',
    title: 'Suppress Exceptions',
    text: 'Suppress specific exception types',
    setup: 'from contextlib import suppress',
    setupCode:
      'from contextlib import suppress\nresult = "default"\nwith suppress(KeyError):\n    d = {}\n    result = d["missing"]',
    expected: 'default',
    sample: 'result',
    hints: ['suppress silently ignores specified exceptions'],
    tags: ['contextlib', 'suppress'],
  },
  {
    id: 'py-ctx-394',
    category: 'context-managers',
    difficulty: 'medium',
    title: 'Closing Helper',
    text: 'Use closing for objects with close method',
    setup:
      'from contextlib import closing\nclass Resource:\n    def __init__(self): self.closed = False\n    def close(self): self.closed = True',
    setupCode:
      'from contextlib import closing\nclass Resource:\n    def __init__(self): self.closed = False\n    def close(self): self.closed = True\nr = Resource()\nwith closing(r): pass',
    expected: true,
    sample: 'r.closed',
    hints: ['closing calls close() on exit'],
    tags: ['contextlib', 'closing'],
  },
  {
    id: 'py-ctx-395',
    category: 'context-managers',
    difficulty: 'hard',
    title: 'Context Manager with As Value',
    text: 'Yield value from context manager',
    setup:
      'from contextlib import contextmanager\n@contextmanager\ndef provide(value):\n    yield value * 2',
    setupCode:
      'from contextlib import contextmanager\n@contextmanager\ndef provide(value):\n    yield value * 2',
    expected: 42,
    sample: 'with provide(21) as v: result = v\nresult',
    hints: ['yield provides the as value'],
    tags: ['contextlib', 'yield'],
  },
  {
    id: 'py-ctx-396',
    category: 'context-managers',
    difficulty: 'hard',
    title: 'Nullcontext',
    text: 'Use nullcontext as no-op context manager',
    setup: 'from contextlib import nullcontext',
    setupCode: 'from contextlib import nullcontext',
    expected: 'hello',
    sample: 'with nullcontext("hello") as v: result = v\nresult',
    hints: ['nullcontext is a no-op that can provide a value'],
    tags: ['contextlib', 'nullcontext'],
  },
  {
    id: 'py-ctx-397',
    category: 'context-managers',
    difficulty: 'hard',
    title: 'Redirect Stdout',
    text: 'Capture print output to string',
    setup: 'from contextlib import redirect_stdout\nfrom io import StringIO',
    setupCode:
      'from contextlib import redirect_stdout\nfrom io import StringIO\nf = StringIO()\nwith redirect_stdout(f):\n    print("captured")',
    expected: 'captured\n',
    sample: 'f.getvalue()',
    hints: ['redirect_stdout sends print to given file object'],
    tags: ['contextlib', 'redirect'],
  },
  {
    id: 'py-ctx-398',
    category: 'context-managers',
    difficulty: 'medium',
    title: 'Exception Handling in Context',
    text: '__exit__ receives exception info',
    setup:
      'class Catcher:\n    def __enter__(self): return self\n    def __exit__(self, exc_type, exc_val, tb):\n        self.caught = exc_type.__name__ if exc_type else None\n        return True',
    setupCode:
      'class Catcher:\n    def __enter__(self): return self\n    def __exit__(self, exc_type, exc_val, tb):\n        self.caught = exc_type.__name__ if exc_type else None\n        return True\nc = Catcher()\nwith c: raise ValueError("test")',
    expected: 'ValueError',
    sample: 'c.caught',
    hints: ['__exit__ returning True suppresses exception'],
    tags: ['context-manager', 'exception'],
  },
  {
    id: 'py-ctx-399',
    category: 'context-managers',
    difficulty: 'hard',
    title: 'Async Context Manager',
    text: 'Define async context manager',
    setup:
      'class AsyncResource:\n    async def __aenter__(self): return "async value"\n    async def __aexit__(self, *args): pass',
    setupCode:
      'class AsyncResource:\n    async def __aenter__(self): return "async value"\n    async def __aexit__(self, *args): pass\nimport asyncio\nasync def main():\n    async with AsyncResource() as r:\n        return r\nresult = asyncio.run(main())',
    expected: 'async value',
    sample: 'result',
    hints: ['Use __aenter__ and __aexit__ for async context managers'],
    tags: ['context-manager', 'async'],
  },

  // ============================================================
  // NEW PROBLEMS - Regular Expressions
  // ============================================================
  {
    id: 'py-re-400',
    category: 'regex',
    difficulty: 'easy',
    title: 'Simple Pattern Match',
    text: 'Check if string contains digits',
    setup: 'import re\ntext = "hello123world"',
    setupCode: 'import re\ntext = "hello123world"',
    expected: true,
    sample: 'bool(re.search(r"\\d+", text))',
    hints: ['\\d matches digits, + means one or more'],
    tags: ['regex', 'search'],
  },
  {
    id: 'py-re-401',
    category: 'regex',
    difficulty: 'easy',
    title: 'Find All Matches',
    text: 'Find all numbers in string',
    setup: 'import re\ntext = "a1b22c333"',
    setupCode: 'import re\ntext = "a1b22c333"',
    expected: ['1', '22', '333'],
    sample: 're.findall(r"\\d+", text)',
    hints: ['findall returns list of all matches'],
    tags: ['regex', 'findall'],
  },
  {
    id: 'py-re-402',
    category: 'regex',
    difficulty: 'medium',
    title: 'Capture Groups',
    text: 'Extract area code and number from phone',
    setup: 'import re\nphone = "(123) 456-7890"',
    setupCode:
      'import re\nphone = "(123) 456-7890"\nmatch = re.search(r"\\((\\d+)\\)\\s*(\\d+-\\d+)", phone)',
    expected: ['123', '456-7890'],
    sample: 'list(match.groups())',
    hints: ['Parentheses create capture groups'],
    tags: ['regex', 'groups'],
  },
  {
    id: 'py-re-403',
    category: 'regex',
    difficulty: 'medium',
    title: 'Named Groups',
    text: 'Extract using named capture groups',
    setup: 'import re\nemail = "user@example.com"',
    setupCode:
      'import re\nemail = "user@example.com"\nmatch = re.search(r"(?P<user>\\w+)@(?P<domain>[\\w.]+)", email)',
    expected: { user: 'user', domain: 'example.com' },
    sample: 'match.groupdict()',
    hints: ['(?P<name>pattern) creates named group'],
    tags: ['regex', 'named-groups'],
  },
  {
    id: 'py-re-404',
    category: 'regex',
    difficulty: 'hard',
    title: 'Positive Lookahead',
    text: 'Find word followed by exclamation',
    setup: 'import re\ntext = "hello! world goodbye!"',
    setupCode: 'import re\ntext = "hello! world goodbye!"',
    expected: ['hello', 'goodbye'],
    sample: 're.findall(r"\\w+(?=!)", text)',
    hints: ['(?=pattern) is positive lookahead'],
    tags: ['regex', 'lookahead'],
  },
  {
    id: 'py-re-405',
    category: 'regex',
    difficulty: 'hard',
    title: 'Negative Lookahead',
    text: 'Find words NOT followed by exclamation',
    setup: 'import re\ntext = "hello! world goodbye"',
    setupCode: 'import re\ntext = "hello! world goodbye"',
    expected: ['hell', 'world', 'goodbye'],
    sample: 're.findall(r"\\w+(?!!)", text)',
    hints: ['(?!pattern) is negative lookahead'],
    tags: ['regex', 'lookahead'],
  },
  {
    id: 'py-re-406',
    category: 'regex',
    difficulty: 'hard',
    title: 'Positive Lookbehind',
    text: 'Find numbers preceded by $',
    setup: 'import re\ntext = "$100 200 $300"',
    setupCode: 'import re\ntext = "$100 200 $300"',
    expected: ['100', '300'],
    sample: 're.findall(r"(?<=\\$)\\d+", text)',
    hints: ['(?<=pattern) is positive lookbehind'],
    tags: ['regex', 'lookbehind'],
  },
  {
    id: 'py-re-407',
    category: 'regex',
    difficulty: 'medium',
    title: 'Regex Substitution',
    text: 'Replace all digits with X',
    setup: 'import re\ntext = "abc123def456"',
    setupCode: 'import re\ntext = "abc123def456"',
    expected: 'abcXXXdefXXX',
    sample: 're.sub(r"\\d", "X", text)',
    hints: ['re.sub replaces all matches'],
    tags: ['regex', 'sub'],
  },
  {
    id: 'py-re-408',
    category: 'regex',
    difficulty: 'medium',
    title: 'Compiled Pattern',
    text: 'Compile and reuse pattern',
    setup: 'import re\npattern = re.compile(r"\\b\\w{3}\\b")\ntext = "The cat sat on mat"',
    setupCode: 'import re\npattern = re.compile(r"\\b\\w{3}\\b")\ntext = "The cat sat on mat"',
    expected: ['The', 'cat', 'sat', 'mat'],
    sample: 'pattern.findall(text)',
    hints: ['Compiled patterns are more efficient for reuse'],
    tags: ['regex', 'compile'],
  },
  {
    id: 'py-re-409',
    category: 'regex',
    difficulty: 'medium',
    title: 'Case Insensitive Match',
    text: 'Match word ignoring case',
    setup: 'import re\ntext = "Hello HELLO hello"',
    setupCode: 'import re\ntext = "Hello HELLO hello"',
    expected: ['Hello', 'HELLO', 'hello'],
    sample: 're.findall(r"hello", text, re.IGNORECASE)',
    hints: ['re.IGNORECASE or re.I for case insensitive'],
    tags: ['regex', 'flags'],
  },

  // ============================================================
  // NEW PROBLEMS - File Operations
  // ============================================================
  {
    id: 'py-file-410',
    category: 'file',
    difficulty: 'easy',
    title: 'Pathlib Path Join',
    text: 'Join path components',
    setup: 'from pathlib import Path\nbase = Path("/home/user")',
    setupCode: 'from pathlib import Path\nbase = Path("/home/user")',
    expected: '/home/user/docs/file.txt',
    sample: 'str(base / "docs" / "file.txt")',
    hints: ['Use / operator to join Path objects'],
    tags: ['pathlib', 'path'],
  },
  {
    id: 'py-file-411',
    category: 'file',
    difficulty: 'easy',
    title: 'Get File Extension',
    text: 'Extract file extension from path',
    setup: 'from pathlib import Path\npath = Path("/home/user/document.pdf")',
    setupCode: 'from pathlib import Path\npath = Path("/home/user/document.pdf")',
    expected: '.pdf',
    sample: 'path.suffix',
    hints: ['suffix property returns the file extension'],
    tags: ['pathlib', 'extension'],
  },
  {
    id: 'py-file-412',
    category: 'file',
    difficulty: 'easy',
    title: 'Get File Name',
    text: 'Get filename without directory',
    setup: 'from pathlib import Path\npath = Path("/home/user/document.pdf")',
    setupCode: 'from pathlib import Path\npath = Path("/home/user/document.pdf")',
    expected: 'document.pdf',
    sample: 'path.name',
    hints: ['name property returns the final component'],
    tags: ['pathlib', 'name'],
  },
  {
    id: 'py-file-413',
    category: 'file',
    difficulty: 'medium',
    title: 'Get Stem Without Extension',
    text: 'Get filename without extension',
    setup: 'from pathlib import Path\npath = Path("/home/user/document.pdf")',
    setupCode: 'from pathlib import Path\npath = Path("/home/user/document.pdf")',
    expected: 'document',
    sample: 'path.stem',
    hints: ['stem is the filename without suffix'],
    tags: ['pathlib', 'stem'],
  },
  {
    id: 'py-file-414',
    category: 'file',
    difficulty: 'medium',
    title: 'Get Parent Directory',
    text: 'Get parent directory path',
    setup: 'from pathlib import Path\npath = Path("/home/user/docs/file.txt")',
    setupCode: 'from pathlib import Path\npath = Path("/home/user/docs/file.txt")',
    expected: '/home/user/docs',
    sample: 'str(path.parent)',
    hints: ['parent property returns directory containing file'],
    tags: ['pathlib', 'parent'],
  },
  {
    id: 'py-file-415',
    category: 'file',
    difficulty: 'medium',
    title: 'Change File Extension',
    text: 'Replace file extension',
    setup: 'from pathlib import Path\npath = Path("/home/user/document.txt")',
    setupCode: 'from pathlib import Path\npath = Path("/home/user/document.txt")',
    expected: '/home/user/document.md',
    sample: 'str(path.with_suffix(".md"))',
    hints: ['with_suffix creates new path with different extension'],
    tags: ['pathlib', 'suffix'],
  },
  {
    id: 'py-file-416',
    category: 'file',
    difficulty: 'medium',
    title: 'Os Path Basename',
    text: 'Get basename using os.path',
    setup: 'import os.path\npath = "/home/user/document.pdf"',
    setupCode: 'import os.path\npath = "/home/user/document.pdf"',
    expected: 'document.pdf',
    sample: 'os.path.basename(path)',
    hints: ['basename returns final component of path'],
    tags: ['os.path', 'basename'],
  },
  {
    id: 'py-file-417',
    category: 'file',
    difficulty: 'medium',
    title: 'Os Path Split Extension',
    text: 'Split filename and extension',
    setup: 'import os.path\npath = "/home/user/document.pdf"',
    setupCode: 'import os.path\npath = "/home/user/document.pdf"',
    expected: ['/home/user/document', '.pdf'],
    sample: 'list(os.path.splitext(path))',
    hints: ['splitext separates path from extension'],
    tags: ['os.path', 'splitext'],
  },
  {
    id: 'py-file-418',
    category: 'file',
    difficulty: 'easy',
    title: 'Check Path Exists',
    text: 'Check if path exists (using example that always works)',
    setup: 'from pathlib import Path',
    setupCode: 'from pathlib import Path',
    expected: true,
    sample: 'Path(".").exists()',
    hints: ['exists() checks if path exists on filesystem'],
    tags: ['pathlib', 'exists'],
  },
  {
    id: 'py-file-419',
    category: 'file',
    difficulty: 'medium',
    title: 'Iterate Path Parts',
    text: 'Get all components of a path',
    setup: 'from pathlib import Path\npath = Path("/home/user/docs")',
    setupCode: 'from pathlib import Path\npath = Path("/home/user/docs")',
    expected: ['/', 'home', 'user', 'docs'],
    sample: 'list(path.parts)',
    hints: ['parts property returns tuple of path components'],
    tags: ['pathlib', 'parts'],
  },

  // ============================================================
  // NEW PROBLEMS - JSON/Pickle
  // ============================================================
  {
    id: 'py-json-420',
    category: 'json',
    difficulty: 'easy',
    title: 'JSON Dumps',
    text: 'Convert dict to JSON string',
    setup: 'import json\ndata = {"name": "Alice", "age": 30}',
    setupCode: 'import json\ndata = {"name": "Alice", "age": 30}',
    expected: '{"name": "Alice", "age": 30}',
    sample: 'json.dumps(data)',
    hints: ['dumps converts Python object to JSON string'],
    tags: ['json', 'dumps'],
  },
  {
    id: 'py-json-421',
    category: 'json',
    difficulty: 'easy',
    title: 'JSON Loads',
    text: 'Parse JSON string to dict',
    setup: 'import json\njson_str = \'{"name": "Bob", "age": 25}\'',
    setupCode: 'import json\njson_str = \'{"name": "Bob", "age": 25}\'',
    expected: { name: 'Bob', age: 25 },
    sample: 'json.loads(json_str)',
    hints: ['loads parses JSON string to Python object'],
    tags: ['json', 'loads'],
  },
  {
    id: 'py-json-422',
    category: 'json',
    difficulty: 'medium',
    title: 'JSON Pretty Print',
    text: 'Format JSON with indentation',
    setup: 'import json\ndata = {"a": 1, "b": 2}',
    setupCode: 'import json\ndata = {"a": 1, "b": 2}',
    expected: '{\n  "a": 1,\n  "b": 2\n}',
    sample: 'json.dumps(data, indent=2)',
    hints: ['indent parameter adds pretty formatting'],
    tags: ['json', 'format'],
  },
  {
    id: 'py-json-423',
    category: 'json',
    difficulty: 'medium',
    title: 'JSON Sort Keys',
    text: 'Output JSON with sorted keys',
    setup: 'import json\ndata = {"z": 1, "a": 2, "m": 3}',
    setupCode: 'import json\ndata = {"z": 1, "a": 2, "m": 3}',
    expected: '{"a": 2, "m": 3, "z": 1}',
    sample: 'json.dumps(data, sort_keys=True)',
    hints: ['sort_keys=True orders keys alphabetically'],
    tags: ['json', 'sort'],
  },
  {
    id: 'py-json-424',
    category: 'json',
    difficulty: 'hard',
    title: 'Custom JSON Encoder',
    text: 'Encode custom object to JSON',
    setup:
      'import json\nclass Point:\n    def __init__(self, x, y): self.x, self.y = x, y\nclass PointEncoder(json.JSONEncoder):\n    def default(self, obj):\n        if isinstance(obj, Point):\n            return {"x": obj.x, "y": obj.y}\n        return super().default(obj)',
    setupCode:
      'import json\nclass Point:\n    def __init__(self, x, y): self.x, self.y = x, y\nclass PointEncoder(json.JSONEncoder):\n    def default(self, obj):\n        if isinstance(obj, Point):\n            return {"x": obj.x, "y": obj.y}\n        return super().default(obj)\np = Point(3, 4)',
    expected: '{"x": 3, "y": 4}',
    sample: 'json.dumps(p, cls=PointEncoder)',
    hints: ['Subclass JSONEncoder and override default method'],
    tags: ['json', 'encoder', 'custom'],
  },
  {
    id: 'py-json-425',
    category: 'json',
    difficulty: 'hard',
    title: 'Custom JSON Decoder',
    text: 'Decode JSON with object hook',
    setup:
      'import json\ndef point_decoder(d):\n    if "x" in d and "y" in d:\n        return (d["x"], d["y"])\n    return d',
    setupCode:
      'import json\ndef point_decoder(d):\n    if "x" in d and "y" in d:\n        return (d["x"], d["y"])\n    return d\njson_str = \'{"x": 5, "y": 10}\'',
    expected: [5, 10],
    sample: 'list(json.loads(json_str, object_hook=point_decoder))',
    hints: ['object_hook is called for each dict'],
    tags: ['json', 'decoder', 'hook'],
  },
  {
    id: 'py-json-426',
    category: 'json',
    difficulty: 'medium',
    title: 'JSON Default Function',
    text: 'Handle non-serializable objects',
    setup: 'import json\ndata = {"date": "2023-01-15", "items": {1, 2, 3}}',
    setupCode: 'import json\ndata = {"items": {1, 2, 3}}',
    expected: '{"items": [1, 2, 3]}',
    sample: 'json.dumps(data, default=lambda x: sorted(x) if isinstance(x, set) else x)',
    hints: ['default function handles non-serializable types'],
    tags: ['json', 'default'],
  },
  {
    id: 'py-json-427',
    category: 'pickle',
    difficulty: 'medium',
    title: 'Pickle Dumps and Loads',
    text: 'Serialize and deserialize with pickle',
    setup: 'import pickle\ndata = {"key": [1, 2, 3]}',
    setupCode: 'import pickle\ndata = {"key": [1, 2, 3]}\npickled = pickle.dumps(data)',
    expected: { key: [1, 2, 3] },
    sample: 'pickle.loads(pickled)',
    hints: ['pickle can serialize most Python objects'],
    tags: ['pickle', 'serialize'],
  },
  {
    id: 'py-json-428',
    category: 'json',
    difficulty: 'easy',
    title: 'JSON Compact Output',
    text: 'Output JSON without spaces',
    setup: 'import json\ndata = {"a": 1, "b": [2, 3]}',
    setupCode: 'import json\ndata = {"a": 1, "b": [2, 3]}',
    expected: '{"a":1,"b":[2,3]}',
    sample: 'json.dumps(data, separators=(",", ":"))',
    hints: ['separators parameter controls whitespace'],
    tags: ['json', 'compact'],
  },
  {
    id: 'py-json-429',
    category: 'json',
    difficulty: 'medium',
    title: 'JSON Ensure ASCII',
    text: 'Include unicode characters directly',
    setup: 'import json\ndata = {"greeting": "Hello"}',
    setupCode: 'import json\ndata = {"greeting": "Hello"}',
    expected: '{"greeting": "Hello"}',
    sample: 'json.dumps(data, ensure_ascii=False)',
    hints: ['ensure_ascii=False allows non-ASCII characters'],
    tags: ['json', 'unicode'],
  },

  // ============================================================
  // NEW PROBLEMS - Dataclasses
  // ============================================================
  {
    id: 'py-dc-430',
    category: 'dataclasses',
    difficulty: 'easy',
    title: 'Basic Dataclass',
    text: 'Create and use a simple dataclass',
    setup:
      'from dataclasses import dataclass\n@dataclass\nclass Person:\n    name: str\n    age: int',
    setupCode:
      'from dataclasses import dataclass\n@dataclass\nclass Person:\n    name: str\n    age: int\np = Person("Alice", 30)',
    expected: 'Alice',
    sample: 'p.name',
    hints: ['Dataclasses auto-generate __init__'],
    tags: ['dataclass', 'basic'],
  },
  {
    id: 'py-dc-431',
    category: 'dataclasses',
    difficulty: 'easy',
    title: 'Dataclass Default Value',
    text: 'Dataclass field with default value',
    setup:
      'from dataclasses import dataclass\n@dataclass\nclass Config:\n    debug: bool = False\n    port: int = 8080',
    setupCode:
      'from dataclasses import dataclass\n@dataclass\nclass Config:\n    debug: bool = False\n    port: int = 8080\nc = Config()',
    expected: 8080,
    sample: 'c.port',
    hints: ['Fields with defaults must come after required fields'],
    tags: ['dataclass', 'default'],
  },
  {
    id: 'py-dc-432',
    category: 'dataclasses',
    difficulty: 'medium',
    title: 'Dataclass Field with Factory',
    text: 'Use field with default_factory for mutable defaults',
    setup:
      'from dataclasses import dataclass, field\n@dataclass\nclass Inventory:\n    items: list = field(default_factory=list)',
    setupCode:
      'from dataclasses import dataclass, field\n@dataclass\nclass Inventory:\n    items: list = field(default_factory=list)\na = Inventory()\nb = Inventory()\na.items.append(1)',
    expected: 0,
    sample: 'len(b.items)',
    hints: ['default_factory creates new instance for each object'],
    tags: ['dataclass', 'field', 'factory'],
  },
  {
    id: 'py-dc-433',
    category: 'dataclasses',
    difficulty: 'medium',
    title: 'Dataclass Post Init',
    text: 'Use __post_init__ for computed fields',
    setup:
      'from dataclasses import dataclass, field\n@dataclass\nclass Rectangle:\n    width: int\n    height: int\n    area: int = field(init=False)\n    def __post_init__(self):\n        self.area = self.width * self.height',
    setupCode:
      'from dataclasses import dataclass, field\n@dataclass\nclass Rectangle:\n    width: int\n    height: int\n    area: int = field(init=False)\n    def __post_init__(self):\n        self.area = self.width * self.height\nr = Rectangle(3, 4)',
    expected: 12,
    sample: 'r.area',
    hints: ['__post_init__ runs after auto-generated __init__'],
    tags: ['dataclass', 'post_init'],
  },
  {
    id: 'py-dc-434',
    category: 'dataclasses',
    difficulty: 'medium',
    title: 'Frozen Dataclass',
    text: 'Create immutable dataclass',
    setup:
      'from dataclasses import dataclass\n@dataclass(frozen=True)\nclass Point:\n    x: int\n    y: int',
    setupCode:
      'from dataclasses import dataclass\n@dataclass(frozen=True)\nclass Point:\n    x: int\n    y: int\np = Point(3, 4)',
    expected: true,
    sample: 'hash(p) is not None',
    hints: ['Frozen dataclasses are hashable'],
    tags: ['dataclass', 'frozen', 'immutable'],
  },
  {
    id: 'py-dc-435',
    category: 'dataclasses',
    difficulty: 'hard',
    title: 'Dataclass Slots',
    text: 'Use slots for memory efficiency',
    setup:
      'from dataclasses import dataclass\n@dataclass(slots=True)\nclass Compact:\n    x: int\n    y: int',
    setupCode:
      'from dataclasses import dataclass\n@dataclass(slots=True)\nclass Compact:\n    x: int\n    y: int\nc = Compact(1, 2)',
    expected: true,
    sample: 'hasattr(c, "__slots__")',
    hints: ['slots=True avoids __dict__ for memory savings'],
    tags: ['dataclass', 'slots'],
  },
  {
    id: 'py-dc-436',
    category: 'dataclasses',
    difficulty: 'medium',
    title: 'Dataclass Field Exclude from Repr',
    text: 'Hide field from repr output',
    setup:
      'from dataclasses import dataclass, field\n@dataclass\nclass User:\n    name: str\n    password: str = field(repr=False)',
    setupCode:
      'from dataclasses import dataclass, field\n@dataclass\nclass User:\n    name: str\n    password: str = field(repr=False)\nu = User("alice", "secret")',
    expected: true,
    sample: '"password" not in repr(u)',
    hints: ['repr=False hides field from __repr__'],
    tags: ['dataclass', 'field', 'repr'],
  },
  {
    id: 'py-dc-437',
    category: 'dataclasses',
    difficulty: 'medium',
    title: 'Dataclass Exclude from Compare',
    text: 'Exclude field from equality comparison',
    setup:
      'from dataclasses import dataclass, field\n@dataclass\nclass Item:\n    name: str\n    cache: dict = field(default_factory=dict, compare=False)',
    setupCode:
      'from dataclasses import dataclass, field\n@dataclass\nclass Item:\n    name: str\n    cache: dict = field(default_factory=dict, compare=False)\na = Item("x", {"a": 1})\nb = Item("x", {"b": 2})',
    expected: true,
    sample: 'a == b',
    hints: ['compare=False excludes from __eq__'],
    tags: ['dataclass', 'field', 'compare'],
  },
  {
    id: 'py-dc-438',
    category: 'dataclasses',
    difficulty: 'easy',
    title: 'Dataclass as Dict',
    text: 'Convert dataclass to dictionary',
    setup:
      'from dataclasses import dataclass, asdict\n@dataclass\nclass Point:\n    x: int\n    y: int',
    setupCode:
      'from dataclasses import dataclass, asdict\n@dataclass\nclass Point:\n    x: int\n    y: int\np = Point(3, 4)',
    expected: { x: 3, y: 4 },
    sample: 'asdict(p)',
    hints: ['asdict converts dataclass to dict recursively'],
    tags: ['dataclass', 'asdict'],
  },
  {
    id: 'py-dc-439',
    category: 'dataclasses',
    difficulty: 'easy',
    title: 'Dataclass as Tuple',
    text: 'Convert dataclass to tuple',
    setup:
      'from dataclasses import dataclass, astuple\n@dataclass\nclass Point:\n    x: int\n    y: int',
    setupCode:
      'from dataclasses import dataclass, astuple\n@dataclass\nclass Point:\n    x: int\n    y: int\np = Point(5, 10)',
    expected: [5, 10],
    sample: 'list(astuple(p))',
    hints: ['astuple converts dataclass to tuple recursively'],
    tags: ['dataclass', 'astuple'],
  },

  // ============================================================
  // NEW PROBLEMS - Type Hints
  // ============================================================
  {
    id: 'py-type-440',
    category: 'typing',
    difficulty: 'easy',
    title: 'Basic Type Hints',
    text: 'Function with type hints',
    setup: 'def greet(name: str) -> str:\n    return f"Hello, {name}"',
    setupCode: 'def greet(name: str) -> str:\n    return f"Hello, {name}"',
    expected: 'Hello, World',
    sample: 'greet("World")',
    hints: ['Type hints document expected types'],
    tags: ['typing', 'basic'],
  },
  {
    id: 'py-type-441',
    category: 'typing',
    difficulty: 'medium',
    title: 'Optional Type',
    text: 'Handle optional parameter',
    setup:
      'from typing import Optional\ndef get_length(s: Optional[str]) -> int:\n    return len(s) if s else 0',
    setupCode:
      'from typing import Optional\ndef get_length(s: Optional[str]) -> int:\n    return len(s) if s else 0',
    expected: 0,
    sample: 'get_length(None)',
    hints: ['Optional[T] is Union[T, None]'],
    tags: ['typing', 'optional'],
  },
  {
    id: 'py-type-442',
    category: 'typing',
    difficulty: 'medium',
    title: 'List Type Hint',
    text: 'Type hint for list of integers',
    setup:
      'from typing import List\ndef double_all(nums: List[int]) -> List[int]:\n    return [x * 2 for x in nums]',
    setupCode:
      'from typing import List\ndef double_all(nums: List[int]) -> List[int]:\n    return [x * 2 for x in nums]',
    expected: [2, 4, 6],
    sample: 'double_all([1, 2, 3])',
    hints: ['List[T] specifies element type'],
    tags: ['typing', 'list'],
  },
  {
    id: 'py-type-443',
    category: 'typing',
    difficulty: 'medium',
    title: 'Dict Type Hint',
    text: 'Type hint for dictionary',
    setup:
      'from typing import Dict\ndef count_chars(s: str) -> Dict[str, int]:\n    return {c: s.count(c) for c in set(s)}',
    setupCode:
      'from typing import Dict\ndef count_chars(s: str) -> Dict[str, int]:\n    return {c: s.count(c) for c in set(s)}',
    expected: { a: 3 },
    sample: 'count_chars("aaa")',
    hints: ['Dict[K, V] specifies key and value types'],
    tags: ['typing', 'dict'],
  },
  {
    id: 'py-type-444',
    category: 'typing',
    difficulty: 'hard',
    title: 'TypeVar Generic',
    text: 'Create generic function with TypeVar',
    setup:
      'from typing import TypeVar, List\nT = TypeVar("T")\ndef first(items: List[T]) -> T:\n    return items[0]',
    setupCode:
      'from typing import TypeVar, List\nT = TypeVar("T")\ndef first(items: List[T]) -> T:\n    return items[0]',
    expected: 'hello',
    sample: 'first(["hello", "world"])',
    hints: ['TypeVar creates type variable for generics'],
    tags: ['typing', 'typevar', 'generic'],
  },
  {
    id: 'py-type-445',
    category: 'typing',
    difficulty: 'hard',
    title: 'Protocol Structural Typing',
    text: 'Define structural type with Protocol',
    setup:
      'from typing import Protocol\nclass Sized(Protocol):\n    def __len__(self) -> int: ...\ndef get_size(obj: Sized) -> int:\n    return len(obj)',
    setupCode:
      'from typing import Protocol\nclass Sized(Protocol):\n    def __len__(self) -> int: ...\ndef get_size(obj: Sized) -> int:\n    return len(obj)',
    expected: 3,
    sample: 'get_size([1, 2, 3])',
    hints: ['Protocol defines interface by structure, not inheritance'],
    tags: ['typing', 'protocol'],
  },
  {
    id: 'py-type-446',
    category: 'typing',
    difficulty: 'medium',
    title: 'Union Type',
    text: 'Accept multiple types with Union',
    setup:
      'from typing import Union\ndef stringify(value: Union[int, float, str]) -> str:\n    return str(value)',
    setupCode:
      'from typing import Union\ndef stringify(value: Union[int, float, str]) -> str:\n    return str(value)',
    expected: '42',
    sample: 'stringify(42)',
    hints: ['Union[A, B] accepts either type'],
    tags: ['typing', 'union'],
  },
  {
    id: 'py-type-447',
    category: 'typing',
    difficulty: 'medium',
    title: 'Literal Type',
    text: 'Restrict to specific literal values',
    setup:
      'from typing import Literal\ndef set_mode(mode: Literal["r", "w", "a"]) -> str:\n    return f"Mode: {mode}"',
    setupCode:
      'from typing import Literal\ndef set_mode(mode: Literal["r", "w", "a"]) -> str:\n    return f"Mode: {mode}"',
    expected: 'Mode: r',
    sample: 'set_mode("r")',
    hints: ['Literal restricts to specific values'],
    tags: ['typing', 'literal'],
  },
  {
    id: 'py-type-448',
    category: 'typing',
    difficulty: 'hard',
    title: 'TypedDict',
    text: 'Define dictionary structure with TypedDict',
    setup:
      'from typing import TypedDict\nclass Point(TypedDict):\n    x: int\n    y: int\ndef get_origin() -> Point:\n    return {"x": 0, "y": 0}',
    setupCode:
      'from typing import TypedDict\nclass Point(TypedDict):\n    x: int\n    y: int\ndef get_origin() -> Point:\n    return {"x": 0, "y": 0}',
    expected: { x: 0, y: 0 },
    sample: 'get_origin()',
    hints: ['TypedDict specifies required keys and value types'],
    tags: ['typing', 'typeddict'],
  },
  {
    id: 'py-type-449',
    category: 'typing',
    difficulty: 'medium',
    title: 'Callable Type',
    text: 'Type hint for function parameter',
    setup:
      'from typing import Callable\ndef apply(fn: Callable[[int], int], x: int) -> int:\n    return fn(x)',
    setupCode:
      'from typing import Callable\ndef apply(fn: Callable[[int], int], x: int) -> int:\n    return fn(x)',
    expected: 25,
    sample: 'apply(lambda x: x ** 2, 5)',
    hints: ['Callable[[args], return] specifies function signature'],
    tags: ['typing', 'callable'],
  },

  // ============================================================
  // NEW PROBLEMS - Async/Await
  // ============================================================
  {
    id: 'py-async-450',
    category: 'async',
    difficulty: 'medium',
    title: 'Basic Async Function',
    text: 'Define and run async function',
    setup: 'import asyncio\nasync def get_value():\n    return 42',
    setupCode:
      'import asyncio\nasync def get_value():\n    return 42\nresult = asyncio.run(get_value())',
    expected: 42,
    sample: 'result',
    hints: ['asyncio.run() executes coroutine'],
    tags: ['async', 'coroutine'],
  },
  {
    id: 'py-async-451',
    category: 'async',
    difficulty: 'medium',
    title: 'Await Another Coroutine',
    text: 'Await result from another async function',
    setup:
      'import asyncio\nasync def double(x): return x * 2\nasync def main(): return await double(21)',
    setupCode:
      'import asyncio\nasync def double(x): return x * 2\nasync def main(): return await double(21)\nresult = asyncio.run(main())',
    expected: 42,
    sample: 'result',
    hints: ['Use await to get result from coroutine'],
    tags: ['async', 'await'],
  },
  {
    id: 'py-async-452',
    category: 'async',
    difficulty: 'hard',
    title: 'Asyncio Gather',
    text: 'Run multiple coroutines concurrently',
    setup:
      'import asyncio\nasync def task(n): return n * 2\nasync def main():\n    results = await asyncio.gather(task(1), task(2), task(3))\n    return results',
    setupCode:
      'import asyncio\nasync def task(n): return n * 2\nasync def main():\n    results = await asyncio.gather(task(1), task(2), task(3))\n    return results\nresult = asyncio.run(main())',
    expected: [2, 4, 6],
    sample: 'result',
    hints: ['gather runs coroutines concurrently'],
    tags: ['async', 'gather'],
  },
  {
    id: 'py-async-453',
    category: 'async',
    difficulty: 'hard',
    title: 'Create Task',
    text: 'Create task for background execution',
    setup:
      'import asyncio\nasync def compute(): return 100\nasync def main():\n    task = asyncio.create_task(compute())\n    return await task',
    setupCode:
      'import asyncio\nasync def compute(): return 100\nasync def main():\n    task = asyncio.create_task(compute())\n    return await task\nresult = asyncio.run(main())',
    expected: 100,
    sample: 'result',
    hints: ['create_task schedules coroutine execution'],
    tags: ['async', 'task'],
  },
  {
    id: 'py-async-454',
    category: 'async',
    difficulty: 'hard',
    title: 'Async Sleep',
    text: 'Use asyncio.sleep for non-blocking delay',
    setup:
      'import asyncio\nasync def delayed_value():\n    await asyncio.sleep(0.001)\n    return "done"',
    setupCode:
      'import asyncio\nasync def delayed_value():\n    await asyncio.sleep(0.001)\n    return "done"\nresult = asyncio.run(delayed_value())',
    expected: 'done',
    sample: 'result',
    hints: ['asyncio.sleep is non-blocking'],
    tags: ['async', 'sleep'],
  },
  {
    id: 'py-async-455',
    category: 'async',
    difficulty: 'hard',
    title: 'Async List Comprehension',
    text: 'Use async for in comprehension',
    setup:
      'import asyncio\nasync def gen():\n    for i in range(3): yield i\nasync def main():\n    return [x async for x in gen()]',
    setupCode:
      'import asyncio\nasync def gen():\n    for i in range(3): yield i\nasync def main():\n    return [x async for x in gen()]\nresult = asyncio.run(main())',
    expected: [0, 1, 2],
    sample: 'result',
    hints: ['async for iterates over async generators'],
    tags: ['async', 'comprehension'],
  },
  {
    id: 'py-async-456',
    category: 'async',
    difficulty: 'hard',
    title: 'Asyncio Wait For Timeout',
    text: 'Set timeout for coroutine',
    setup:
      'import asyncio\nasync def slow(): return "completed"\nasync def main():\n    return await asyncio.wait_for(slow(), timeout=1.0)',
    setupCode:
      'import asyncio\nasync def slow(): return "completed"\nasync def main():\n    return await asyncio.wait_for(slow(), timeout=1.0)\nresult = asyncio.run(main())',
    expected: 'completed',
    sample: 'result',
    hints: ['wait_for adds timeout to coroutine'],
    tags: ['async', 'timeout'],
  },
  {
    id: 'py-async-457',
    category: 'async',
    difficulty: 'hard',
    title: 'Async Context Manager',
    text: 'Use async with statement',
    setup:
      'import asyncio\nclass AsyncResource:\n    async def __aenter__(self): return "resource"\n    async def __aexit__(self, *args): pass\nasync def main():\n    async with AsyncResource() as r:\n        return r',
    setupCode:
      'import asyncio\nclass AsyncResource:\n    async def __aenter__(self): return "resource"\n    async def __aexit__(self, *args): pass\nasync def main():\n    async with AsyncResource() as r:\n        return r\nresult = asyncio.run(main())',
    expected: 'resource',
    sample: 'result',
    hints: ['async with uses __aenter__ and __aexit__'],
    tags: ['async', 'context-manager'],
  },
  {
    id: 'py-async-458',
    category: 'async',
    difficulty: 'hard',
    title: 'Asyncio Queue',
    text: 'Use asyncio Queue for producer-consumer',
    setup:
      'import asyncio\nasync def main():\n    q = asyncio.Queue()\n    await q.put("item")\n    return await q.get()',
    setupCode:
      'import asyncio\nasync def main():\n    q = asyncio.Queue()\n    await q.put("item")\n    return await q.get()\nresult = asyncio.run(main())',
    expected: 'item',
    sample: 'result',
    hints: ['asyncio.Queue is async-safe'],
    tags: ['async', 'queue'],
  },
  {
    id: 'py-async-459',
    category: 'async',
    difficulty: 'hard',
    title: 'Asyncio Semaphore',
    text: 'Limit concurrency with Semaphore',
    setup:
      'import asyncio\nasync def main():\n    sem = asyncio.Semaphore(2)\n    async with sem:\n        return "acquired"',
    setupCode:
      'import asyncio\nasync def main():\n    sem = asyncio.Semaphore(2)\n    async with sem:\n        return "acquired"\nresult = asyncio.run(main())',
    expected: 'acquired',
    sample: 'result',
    hints: ['Semaphore limits concurrent access'],
    tags: ['async', 'semaphore'],
  },

  // ============================================================
  // MORE LIST COMPREHENSIONS - Advanced Patterns
  // ============================================================
  {
    id: 'py-lc-460',
    category: 'list',
    difficulty: 'medium',
    title: 'Enumerate with Filter',
    text: 'Get indices where value is greater than 5',
    setup: 'nums = [3, 8, 2, 9, 1, 7, 4]',
    setupCode: 'nums = [3, 8, 2, 9, 1, 7, 4]',
    expected: [1, 3, 5],
    sample: '[i for i, x in enumerate(nums) if x > 5]',
    hints: ['Enumerate gives index and value'],
    tags: ['list-comprehension', 'enumerate'],
  },
  {
    id: 'py-lc-461',
    category: 'list',
    difficulty: 'hard',
    title: 'Nested Dict Comprehension',
    text: 'Create dict mapping each number to its powers',
    setup: 'nums = [2, 3, 4]',
    setupCode: 'nums = [2, 3, 4]',
    expected: { 2: [2, 4, 8], 3: [3, 9, 27], 4: [4, 16, 64] },
    sample: '{n: [n**p for p in [1,2,3]] for n in nums}',
    hints: ['Combine dict comprehension with list comprehension'],
    tags: ['comprehension', 'nested'],
  },
  {
    id: 'py-lc-462',
    category: 'list',
    difficulty: 'medium',
    title: 'Zip with Index',
    text: 'Create tuples of (index, a, b) from two lists',
    setup: 'a = ["x", "y", "z"]\nb = [1, 2, 3]',
    setupCode: 'a = ["x", "y", "z"]\nb = [1, 2, 3]',
    expected: [
      [0, 'x', 1],
      [1, 'y', 2],
      [2, 'z', 3],
    ],
    sample: '[(i, x, y) for i, (x, y) in enumerate(zip(a, b))]',
    hints: ['Combine enumerate with zip'],
    tags: ['list-comprehension', 'enumerate', 'zip'],
  },
  {
    id: 'py-lc-463',
    category: 'list',
    difficulty: 'hard',
    title: 'Matrix Diagonal',
    text: 'Extract main diagonal from matrix',
    setup: 'matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]',
    setupCode: 'matrix = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]',
    expected: [1, 5, 9],
    sample: '[matrix[i][i] for i in range(len(matrix))]',
    hints: ['Diagonal elements have same row and column index'],
    tags: ['list-comprehension', 'matrix'],
  },
  {
    id: 'py-lc-464',
    category: 'list',
    difficulty: 'medium',
    title: 'String to List of Ints',
    text: 'Convert comma-separated string to list of integers',
    setup: 's = "1,2,3,4,5"',
    setupCode: 's = "1,2,3,4,5"',
    expected: [1, 2, 3, 4, 5],
    sample: '[int(x) for x in s.split(",")]',
    hints: ['Split then map to int'],
    tags: ['list-comprehension', 'string', 'convert'],
  },
  {
    id: 'py-lc-465',
    category: 'list',
    difficulty: 'hard',
    title: 'Pairwise Differences',
    text: 'Calculate difference between consecutive elements',
    setup: 'nums = [10, 15, 12, 20, 18]',
    setupCode: 'nums = [10, 15, 12, 20, 18]',
    expected: [5, -3, 8, -2],
    sample: '[nums[i+1] - nums[i] for i in range(len(nums)-1)]',
    hints: ['Use range to iterate pairs of indices'],
    tags: ['list-comprehension', 'pairwise'],
  },
  {
    id: 'py-lc-466',
    category: 'list',
    difficulty: 'medium',
    title: 'Filter and Transform with Walrus',
    text: 'Filter and transform in one pass using walrus operator',
    setup: 'data = ["123", "abc", "456", "def"]',
    setupCode: 'data = ["123", "abc", "456", "def"]',
    expected: [123, 456],
    sample: '[n for s in data if (n := s.isdigit() and int(s))]',
    hints: ['Walrus operator := assigns in expression'],
    tags: ['list-comprehension', 'walrus'],
  },
  {
    id: 'py-lc-467',
    category: 'list',
    difficulty: 'hard',
    title: 'Running Total',
    text: 'Calculate cumulative sum',
    setup: 'from itertools import accumulate\nnums = [1, 2, 3, 4, 5]',
    setupCode: 'from itertools import accumulate\nnums = [1, 2, 3, 4, 5]',
    expected: [1, 3, 6, 10, 15],
    sample: 'list(accumulate(nums))',
    hints: ['accumulate produces running totals'],
    tags: ['itertools', 'accumulate'],
  },
  {
    id: 'py-lc-468',
    category: 'list',
    difficulty: 'medium',
    title: 'Filter None Values',
    text: 'Remove None values from list',
    setup: 'items = [1, None, 2, None, 3, None]',
    setupCode: 'items = [1, None, 2, None, 3, None]',
    expected: [1, 2, 3],
    sample: '[x for x in items if x is not None]',
    hints: ['Use is not None for explicit check'],
    tags: ['list-comprehension', 'filter'],
  },
  {
    id: 'py-lc-469',
    category: 'list',
    difficulty: 'hard',
    title: 'Group Adjacent Duplicates',
    text: 'Group consecutive identical items',
    setup: 'from itertools import groupby\nitems = [1, 1, 2, 2, 2, 3, 1, 1]',
    setupCode: 'from itertools import groupby\nitems = [1, 1, 2, 2, 2, 3, 1, 1]',
    expected: [
      [1, 2],
      [2, 3],
      [3, 1],
      [1, 2],
    ],
    sample: '[(k, len(list(g))) for k, g in groupby(items)]',
    hints: ['groupby groups consecutive identical items'],
    tags: ['itertools', 'groupby'],
  },

  // ============================================================
  // MORE DICTIONARY METHODS
  // ============================================================
  {
    id: 'py-dict-470',
    category: 'dict',
    difficulty: 'medium',
    title: 'Dict Items Filter',
    text: 'Filter dict keeping items where value > 10',
    setup: 'data = {"a": 5, "b": 15, "c": 8, "d": 20}',
    setupCode: 'data = {"a": 5, "b": 15, "c": 8, "d": 20}',
    expected: { b: 15, d: 20 },
    sample: '{k: v for k, v in data.items() if v > 10}',
    hints: ['Filter in dict comprehension'],
    tags: ['dict-comprehension', 'filter'],
  },
  {
    id: 'py-dict-471',
    category: 'dict',
    difficulty: 'medium',
    title: 'Enumerate to Dict',
    text: 'Create dict mapping index to value',
    setup: 'items = ["a", "b", "c"]',
    setupCode: 'items = ["a", "b", "c"]',
    expected: { 0: 'a', 1: 'b', 2: 'c' },
    sample: 'dict(enumerate(items))',
    hints: ['enumerate produces (index, value) pairs'],
    tags: ['dict', 'enumerate'],
  },
  {
    id: 'py-dict-472',
    category: 'dict',
    difficulty: 'hard',
    title: 'Nested Dict Get',
    text: 'Safely get nested value',
    setup: 'data = {"user": {"profile": {"name": "Alice"}}}',
    setupCode: 'data = {"user": {"profile": {"name": "Alice"}}}',
    expected: 'Alice',
    sample: 'data.get("user", {}).get("profile", {}).get("name", "Unknown")',
    hints: ['Chain get() calls with default empty dicts'],
    tags: ['dict', 'nested', 'get'],
  },
  {
    id: 'py-dict-473',
    category: 'dict',
    difficulty: 'medium',
    title: 'Dict Key Transform',
    text: 'Transform dict keys to uppercase',
    setup: 'data = {"name": "Alice", "age": 30}',
    setupCode: 'data = {"name": "Alice", "age": 30}',
    expected: { NAME: 'Alice', AGE: 30 },
    sample: '{k.upper(): v for k, v in data.items()}',
    hints: ['Transform keys in dict comprehension'],
    tags: ['dict-comprehension', 'transform'],
  },
  {
    id: 'py-dict-474',
    category: 'dict',
    difficulty: 'hard',
    title: 'Dict Reduce to Single Value',
    text: 'Sum all values in dict',
    setup: 'data = {"a": 10, "b": 20, "c": 30}',
    setupCode: 'data = {"a": 10, "b": 20, "c": 30}',
    expected: 60,
    sample: 'sum(data.values())',
    hints: ['values() returns dict values'],
    tags: ['dict', 'aggregation'],
  },
  {
    id: 'py-dict-475',
    category: 'dict',
    difficulty: 'medium',
    title: 'Dict Sorted by Value',
    text: 'Sort dict by value descending',
    setup: 'data = {"a": 3, "b": 1, "c": 2}',
    setupCode: 'data = {"a": 3, "b": 1, "c": 2}',
    expected: [
      ['a', 3],
      ['c', 2],
      ['b', 1],
    ],
    sample: 'sorted(data.items(), key=lambda x: x[1], reverse=True)',
    hints: ['Sort items by second element (value)'],
    tags: ['dict', 'sorting'],
  },
  {
    id: 'py-dict-476',
    category: 'dict',
    difficulty: 'medium',
    title: 'Dict Max by Value',
    text: 'Find key with maximum value',
    setup: 'data = {"a": 10, "b": 50, "c": 30}',
    setupCode: 'data = {"a": 10, "b": 50, "c": 30}',
    expected: 'b',
    sample: 'max(data, key=data.get)',
    hints: ['max with key function on dict returns key'],
    tags: ['dict', 'max'],
  },
  {
    id: 'py-dict-477',
    category: 'dict',
    difficulty: 'hard',
    title: 'Dict Zip Keys Values',
    text: 'Create dict from separate keys and values lists',
    setup: 'keys = ["x", "y", "z"]\nvalues = [1, 2, 3]',
    setupCode: 'keys = ["x", "y", "z"]\nvalues = [1, 2, 3]',
    expected: { x: 1, y: 2, z: 3 },
    sample: 'dict(zip(keys, values))',
    hints: ['zip pairs corresponding elements'],
    tags: ['dict', 'zip'],
  },
  {
    id: 'py-dict-478',
    category: 'dict',
    difficulty: 'medium',
    title: 'Dict Value Count',
    text: 'Count occurrences of each value',
    setup: 'from collections import Counter\ndata = {"a": 1, "b": 2, "c": 1, "d": 2, "e": 1}',
    setupCode: 'from collections import Counter\ndata = {"a": 1, "b": 2, "c": 1, "d": 2, "e": 1}',
    expected: { 1: 3, 2: 2 },
    sample: 'dict(Counter(data.values()))',
    hints: ['Counter counts hashable objects'],
    tags: ['dict', 'counter'],
  },
  {
    id: 'py-dict-479',
    category: 'dict',
    difficulty: 'hard',
    title: 'Dict Deep Merge',
    text: 'Merge nested dicts',
    setup: 'd1 = {"a": {"x": 1}}\nd2 = {"a": {"y": 2}, "b": 3}',
    setupCode: 'd1 = {"a": {"x": 1}}\nd2 = {"a": {"y": 2}, "b": 3}',
    expected: { a: { x: 1, y: 2 }, b: 3 },
    sample:
      '{**d1, "a": {**d1.get("a", {}), **d2.get("a", {})}, **{k: v for k, v in d2.items() if k != "a"}}',
    hints: ['Manual merge for nested structures'],
    tags: ['dict', 'merge', 'nested'],
  },

  // ============================================================
  // MORE SET OPERATIONS
  // ============================================================
  {
    id: 'py-set-480',
    category: 'set',
    difficulty: 'easy',
    title: 'Set from String',
    text: 'Get unique characters from string',
    setup: 'text = "mississippi"',
    setupCode: 'text = "mississippi"',
    expected: ['i', 'm', 'p', 's'],
    sample: 'sorted(set(text))',
    hints: ['set() removes duplicates from iterable'],
    tags: ['set', 'string'],
  },
  {
    id: 'py-set-481',
    category: 'set',
    difficulty: 'medium',
    title: 'Set Intersection Count',
    text: 'Count common elements between two sets',
    setup: 'a = {1, 2, 3, 4, 5}\nb = {4, 5, 6, 7, 8}',
    setupCode: 'a = {1, 2, 3, 4, 5}\nb = {4, 5, 6, 7, 8}',
    expected: 2,
    sample: 'len(a & b)',
    hints: ['& gives intersection'],
    tags: ['set', 'intersection'],
  },
  {
    id: 'py-set-482',
    category: 'set',
    difficulty: 'medium',
    title: 'Check Disjoint Sets',
    text: 'Check if sets have no common elements',
    setup: 'a = {1, 2, 3}\nb = {4, 5, 6}',
    setupCode: 'a = {1, 2, 3}\nb = {4, 5, 6}',
    expected: true,
    sample: 'a.isdisjoint(b)',
    hints: ['isdisjoint returns True if no common elements'],
    tags: ['set', 'disjoint'],
  },
  {
    id: 'py-set-483',
    category: 'set',
    difficulty: 'hard',
    title: 'Set Comprehension Filter',
    text: 'Create set of lengths from words > 3 chars',
    setup: 'words = ["a", "cat", "hello", "dog", "elephant"]',
    setupCode: 'words = ["a", "cat", "hello", "dog", "elephant"]',
    expected: [5, 8],
    sample: 'sorted({len(w) for w in words if len(w) > 3})',
    hints: ['Set comprehension with filter'],
    tags: ['set-comprehension', 'filter'],
  },
  {
    id: 'py-set-484',
    category: 'set',
    difficulty: 'medium',
    title: 'Set Intersection Update',
    text: 'Keep only elements present in both sets',
    setup: 'a = {1, 2, 3, 4, 5}\nb = {3, 4, 5, 6, 7}',
    setupCode: 'a = {1, 2, 3, 4, 5}\nb = {3, 4, 5, 6, 7}',
    expected: [3, 4, 5],
    sample: 'a.intersection_update(b); sorted(a)',
    hints: ['intersection_update modifies set in place'],
    tags: ['set', 'intersection'],
  },

  // ============================================================
  // MORE STRING METHODS
  // ============================================================
  {
    id: 'py-str-485',
    category: 'string',
    difficulty: 'easy',
    title: 'String Count Substring',
    text: 'Count occurrences of substring',
    setup: 'text = "abracadabra"',
    setupCode: 'text = "abracadabra"',
    expected: 2,
    sample: 'text.count("bra")',
    hints: ['count() counts non-overlapping occurrences'],
    tags: ['string', 'count'],
  },
  {
    id: 'py-str-486',
    category: 'string',
    difficulty: 'medium',
    title: 'String Replace Limit',
    text: 'Replace only first 2 occurrences',
    setup: 'text = "aaa bbb aaa bbb aaa"',
    setupCode: 'text = "aaa bbb aaa bbb aaa"',
    expected: 'xxx bbb xxx bbb aaa',
    sample: 'text.replace("aaa", "xxx", 2)',
    hints: ['replace() takes optional count parameter'],
    tags: ['string', 'replace'],
  },
  {
    id: 'py-str-487',
    category: 'string',
    difficulty: 'medium',
    title: 'String Find with Start',
    text: 'Find substring starting from index 5',
    setup: 'text = "hello hello hello"',
    setupCode: 'text = "hello hello hello"',
    expected: 6,
    sample: 'text.find("hello", 5)',
    hints: ['find() takes optional start index'],
    tags: ['string', 'find'],
  },
  {
    id: 'py-str-488',
    category: 'string',
    difficulty: 'easy',
    title: 'String Title Case',
    text: 'Convert to title case',
    setup: 'text = "hello world python"',
    setupCode: 'text = "hello world python"',
    expected: 'Hello World Python',
    sample: 'text.title()',
    hints: ['title() capitalizes first letter of each word'],
    tags: ['string', 'title'],
  },
  {
    id: 'py-str-489',
    category: 'string',
    difficulty: 'medium',
    title: 'String Splitlines',
    text: 'Split string by line breaks',
    setup: 'text = "line1\\nline2\\nline3"',
    setupCode: 'text = "line1\\nline2\\nline3"',
    expected: ['line1', 'line2', 'line3'],
    sample: 'text.splitlines()',
    hints: ['splitlines() splits on various line endings'],
    tags: ['string', 'split'],
  },

  // ============================================================
  // MORE ITERTOOLS
  // ============================================================
  {
    id: 'py-iter-490',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Islice from Middle',
    text: 'Get elements from index 2 to 5',
    setup: 'from itertools import islice\nitems = range(10)',
    setupCode: 'from itertools import islice\nitems = range(10)',
    expected: [2, 3, 4],
    sample: 'list(islice(items, 2, 5))',
    hints: ['islice(iterable, start, stop)'],
    tags: ['itertools', 'islice'],
  },
  {
    id: 'py-iter-491',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Count with Step',
    text: 'Generate numbers with step',
    setup: 'from itertools import count, islice',
    setupCode: 'from itertools import count, islice',
    expected: [0, 5, 10, 15, 20],
    sample: 'list(islice(count(0, 5), 5))',
    hints: ['count(start, step) generates infinite sequence'],
    tags: ['itertools', 'count'],
  },
  {
    id: 'py-iter-492',
    category: 'itertools',
    difficulty: 'hard',
    title: 'Pairwise Iteration',
    text: 'Iterate consecutive pairs',
    setup: 'from itertools import pairwise\nitems = [1, 2, 3, 4, 5]',
    setupCode: 'from itertools import pairwise\nitems = [1, 2, 3, 4, 5]',
    expected: [
      [1, 2],
      [2, 3],
      [3, 4],
      [4, 5],
    ],
    sample: 'list(pairwise(items))',
    hints: ['pairwise gives consecutive overlapping pairs'],
    tags: ['itertools', 'pairwise'],
  },
  {
    id: 'py-iter-493',
    category: 'itertools',
    difficulty: 'hard',
    title: 'Batched Iteration',
    text: 'Split into batches of size 3',
    setup: 'from itertools import batched\nitems = [1, 2, 3, 4, 5, 6, 7, 8]',
    setupCode: 'from itertools import batched\nitems = [1, 2, 3, 4, 5, 6, 7, 8]',
    expected: [
      [1, 2, 3],
      [4, 5, 6],
      [7, 8],
    ],
    sample: '[list(b) for b in batched(items, 3)]',
    hints: ['batched splits into fixed-size chunks'],
    tags: ['itertools', 'batched'],
  },
  {
    id: 'py-iter-494',
    category: 'itertools',
    difficulty: 'medium',
    title: 'Filterfalse',
    text: 'Keep elements where predicate is false',
    setup: 'from itertools import filterfalse\nnums = [1, 2, 3, 4, 5, 6]',
    setupCode: 'from itertools import filterfalse\nnums = [1, 2, 3, 4, 5, 6]',
    expected: [1, 3, 5],
    sample: 'list(filterfalse(lambda x: x % 2 == 0, nums))',
    hints: ['filterfalse is opposite of filter'],
    tags: ['itertools', 'filterfalse'],
  },

  // ============================================================
  // MORE FUNCTOOLS
  // ============================================================
  {
    id: 'py-func-495',
    category: 'functools',
    difficulty: 'medium',
    title: 'Reduce with Operator',
    text: 'Multiply all numbers using reduce',
    setup: 'from functools import reduce\nimport operator\nnums = [1, 2, 3, 4, 5]',
    setupCode: 'from functools import reduce\nimport operator\nnums = [1, 2, 3, 4, 5]',
    expected: 120,
    sample: 'reduce(operator.mul, nums)',
    hints: ['operator.mul is function for multiplication'],
    tags: ['functools', 'reduce', 'operator'],
  },
  {
    id: 'py-func-496',
    category: 'functools',
    difficulty: 'hard',
    title: 'Partial Method',
    text: 'Create partial method with partialmethod',
    setup:
      'from functools import partialmethod\nclass Counter:\n    def __init__(self): self.count = 0\n    def step(self, amount): self.count += amount\n    step1 = partialmethod(step, 1)\n    step5 = partialmethod(step, 5)',
    setupCode:
      'from functools import partialmethod\nclass Counter:\n    def __init__(self): self.count = 0\n    def step(self, amount): self.count += amount\n    step1 = partialmethod(step, 1)\n    step5 = partialmethod(step, 5)\nc = Counter()\nc.step1()\nc.step5()',
    expected: 6,
    sample: 'c.count',
    hints: ['partialmethod works for methods in classes'],
    tags: ['functools', 'partialmethod'],
  },
  {
    id: 'py-func-497',
    category: 'functools',
    difficulty: 'medium',
    title: 'Cmp to Key',
    text: 'Sort with comparison function',
    setup: 'from functools import cmp_to_key\nitems = ["bb", "aaa", "c"]',
    setupCode: 'from functools import cmp_to_key\nitems = ["bb", "aaa", "c"]',
    expected: ['c', 'bb', 'aaa'],
    sample: 'sorted(items, key=cmp_to_key(lambda a, b: len(a) - len(b)))',
    hints: ['cmp_to_key converts comparison function to key function'],
    tags: ['functools', 'cmp_to_key', 'sorting'],
  },
  {
    id: 'py-func-498',
    category: 'functools',
    difficulty: 'hard',
    title: 'Singledispatch Method',
    text: 'Dispatch by type for method',
    setup:
      'from functools import singledispatchmethod\nclass Processor:\n    @singledispatchmethod\n    def process(self, x): return "unknown"\n    @process.register\n    def _(self, x: int): return "int"\n    @process.register\n    def _(self, x: str): return "str"',
    setupCode:
      'from functools import singledispatchmethod\nclass Processor:\n    @singledispatchmethod\n    def process(self, x): return "unknown"\n    @process.register\n    def _(self, x: int): return "int"\n    @process.register\n    def _(self, x: str): return "str"\np = Processor()',
    expected: 'int',
    sample: 'p.process(42)',
    hints: ['singledispatchmethod for method overloading'],
    tags: ['functools', 'singledispatchmethod'],
  },
  {
    id: 'py-func-499',
    category: 'functools',
    difficulty: 'medium',
    title: 'Reduce Empty with Initial',
    text: 'Handle empty sequence with initial value',
    setup: 'from functools import reduce\nempty = []',
    setupCode: 'from functools import reduce\nempty = []',
    expected: 0,
    sample: 'reduce(lambda a, b: a + b, empty, 0)',
    hints: ['Initial value handles empty sequences'],
    tags: ['functools', 'reduce'],
  },

  // ============================================================
  // MORE COLLECTIONS
  // ============================================================
  {
    id: 'py-col-500',
    category: 'collections',
    difficulty: 'medium',
    title: 'Counter Total',
    text: 'Sum all counts in Counter',
    setup: 'from collections import Counter\nc = Counter("aabbccc")',
    setupCode: 'from collections import Counter\nc = Counter("aabbccc")',
    expected: 7,
    sample: 'c.total()',
    hints: ['total() sums all counts'],
    tags: ['collections', 'counter'],
  },
  {
    id: 'py-col-501',
    category: 'collections',
    difficulty: 'medium',
    title: 'Counter Intersection',
    text: 'Common elements with minimum counts',
    setup: 'from collections import Counter\na = Counter("aaabbc")\nb = Counter("aabbcc")',
    setupCode: 'from collections import Counter\na = Counter("aaabbc")\nb = Counter("aabbcc")',
    expected: { a: 2, b: 2, c: 1 },
    sample: 'dict(a & b)',
    hints: ['& gives minimum of corresponding counts'],
    tags: ['collections', 'counter'],
  },
  {
    id: 'py-col-502',
    category: 'collections',
    difficulty: 'hard',
    title: 'ChainMap New Child',
    text: 'Create new scope in ChainMap',
    setup: 'from collections import ChainMap\nbase = {"a": 1, "b": 2}',
    setupCode:
      'from collections import ChainMap\nbase = {"a": 1, "b": 2}\ncm = ChainMap({}, base)\ncm["a"] = 10',
    expected: 10,
    sample: 'cm["a"]',
    hints: ['Child scope shadows parent'],
    tags: ['collections', 'chainmap'],
  },
  {
    id: 'py-col-503',
    category: 'collections',
    difficulty: 'medium',
    title: 'Deque Extend Left',
    text: 'Add multiple items to left',
    setup: 'from collections import deque\nd = deque([4, 5, 6])',
    setupCode: 'from collections import deque\nd = deque([4, 5, 6])',
    expected: [3, 2, 1, 4, 5, 6],
    sample: 'd.extendleft([1, 2, 3]); list(d)',
    hints: ['extendleft adds items in reverse order'],
    tags: ['collections', 'deque'],
  },
  {
    id: 'py-col-504',
    category: 'collections',
    difficulty: 'medium',
    title: 'Namedtuple Defaults',
    text: 'Namedtuple with default values',
    setup:
      'from collections import namedtuple\nPoint = namedtuple("Point", ["x", "y", "z"], defaults=[0, 0])',
    setupCode:
      'from collections import namedtuple\nPoint = namedtuple("Point", ["x", "y", "z"], defaults=[0, 0])\np = Point(1)',
    expected: [1, 0, 0],
    sample: 'list(p)',
    hints: ['defaults apply to rightmost fields'],
    tags: ['collections', 'namedtuple'],
  },

  // ============================================================
  // MORE REGEX
  // ============================================================
  {
    id: 'py-re-505',
    category: 'regex',
    difficulty: 'medium',
    title: 'Regex Split',
    text: 'Split on multiple delimiters',
    setup: 'import re\ntext = "a,b;c:d"',
    setupCode: 'import re\ntext = "a,b;c:d"',
    expected: ['a', 'b', 'c', 'd'],
    sample: 're.split(r"[,;:]", text)',
    hints: ['Character class matches any listed char'],
    tags: ['regex', 'split'],
  },
  {
    id: 'py-re-506',
    category: 'regex',
    difficulty: 'hard',
    title: 'Regex Non-Greedy',
    text: 'Match shortest possible string',
    setup: 'import re\ntext = "<tag>content</tag>"',
    setupCode: 'import re\ntext = "<tag>content</tag>"',
    expected: ['<tag>', '</tag>'],
    sample: 're.findall(r"<.*?>", text)',
    hints: ['? after quantifier makes it non-greedy'],
    tags: ['regex', 'non-greedy'],
  },
  {
    id: 'py-re-507',
    category: 'regex',
    difficulty: 'medium',
    title: 'Regex Word Boundary',
    text: 'Match whole word only',
    setup: 'import re\ntext = "cat category catch"',
    setupCode: 'import re\ntext = "cat category catch"',
    expected: ['cat'],
    sample: 're.findall(r"\\bcat\\b", text)',
    hints: ['\\b matches word boundary'],
    tags: ['regex', 'boundary'],
  },
  {
    id: 'py-re-508',
    category: 'regex',
    difficulty: 'hard',
    title: 'Regex Backreference',
    text: 'Match repeated word',
    setup: 'import re\ntext = "the the cat sat sat"',
    setupCode: 'import re\ntext = "the the cat sat sat"',
    expected: ['the', 'sat'],
    sample: 're.findall(r"\\b(\\w+)\\s+\\1\\b", text)',
    hints: ['\\1 refers to first captured group'],
    tags: ['regex', 'backreference'],
  },
  {
    id: 'py-re-509',
    category: 'regex',
    difficulty: 'medium',
    title: 'Regex Multiline',
    text: 'Match at start of each line',
    setup: 'import re\ntext = "line1\\nline2\\nline3"',
    setupCode: 'import re\ntext = "line1\\nline2\\nline3"',
    expected: ['line1', 'line2', 'line3'],
    sample: 're.findall(r"^\\w+", text, re.MULTILINE)',
    hints: ['MULTILINE makes ^ match start of each line'],
    tags: ['regex', 'multiline'],
  },

  // ============================================================
  // MORE BUILTINS
  // ============================================================
  {
    id: 'py-builtin-510',
    category: 'builtin',
    difficulty: 'easy',
    title: 'Abs Negative',
    text: 'Get absolute value',
    setup: 'num = -42',
    setupCode: 'num = -42',
    expected: 42,
    sample: 'abs(num)',
    hints: ['abs() returns absolute value'],
    tags: ['builtin', 'abs'],
  },
  {
    id: 'py-builtin-511',
    category: 'builtin',
    difficulty: 'easy',
    title: 'Round to Decimal',
    text: 'Round to 2 decimal places',
    setup: 'num = 3.14159',
    setupCode: 'num = 3.14159',
    expected: 3.14,
    sample: 'round(num, 2)',
    hints: ['round(number, ndigits)'],
    tags: ['builtin', 'round'],
  },
  {
    id: 'py-builtin-512',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Divmod',
    text: 'Get quotient and remainder',
    setup: 'dividend = 17\ndivisor = 5',
    setupCode: 'dividend = 17\ndivisor = 5',
    expected: [3, 2],
    sample: 'list(divmod(dividend, divisor))',
    hints: ['divmod returns (quotient, remainder)'],
    tags: ['builtin', 'divmod'],
  },
  {
    id: 'py-builtin-513',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Bin Convert',
    text: 'Convert to binary string',
    setup: 'num = 42',
    setupCode: 'num = 42',
    expected: '0b101010',
    sample: 'bin(num)',
    hints: ['bin() returns binary string with 0b prefix'],
    tags: ['builtin', 'bin'],
  },
  {
    id: 'py-builtin-514',
    category: 'builtin',
    difficulty: 'medium',
    title: 'Hex Convert',
    text: 'Convert to hex string',
    setup: 'num = 255',
    setupCode: 'num = 255',
    expected: '0xff',
    sample: 'hex(num)',
    hints: ['hex() returns hexadecimal string'],
    tags: ['builtin', 'hex'],
  },

  // ============================================================
  // MORE DATACLASSES
  // ============================================================
  {
    id: 'py-dc-515',
    category: 'dataclasses',
    difficulty: 'medium',
    title: 'Dataclass Order',
    text: 'Enable comparison operators',
    setup:
      'from dataclasses import dataclass\n@dataclass(order=True)\nclass Priority:\n    level: int\n    name: str',
    setupCode:
      'from dataclasses import dataclass\n@dataclass(order=True)\nclass Priority:\n    level: int\n    name: str\na = Priority(1, "low")\nb = Priority(2, "high")',
    expected: true,
    sample: 'a < b',
    hints: ['order=True generates comparison methods'],
    tags: ['dataclass', 'order'],
  },
  {
    id: 'py-dc-516',
    category: 'dataclasses',
    difficulty: 'hard',
    title: 'Dataclass Inheritance',
    text: 'Extend dataclass with new fields',
    setup:
      'from dataclasses import dataclass\n@dataclass\nclass Base:\n    x: int\n@dataclass\nclass Extended(Base):\n    y: int',
    setupCode:
      'from dataclasses import dataclass\n@dataclass\nclass Base:\n    x: int\n@dataclass\nclass Extended(Base):\n    y: int\ne = Extended(1, 2)',
    expected: 3,
    sample: 'e.x + e.y',
    hints: ['Dataclasses can inherit from other dataclasses'],
    tags: ['dataclass', 'inheritance'],
  },
  {
    id: 'py-dc-517',
    category: 'dataclasses',
    difficulty: 'medium',
    title: 'Dataclass Fields',
    text: 'Get list of field names',
    setup:
      'from dataclasses import dataclass, fields\n@dataclass\nclass Person:\n    name: str\n    age: int',
    setupCode:
      'from dataclasses import dataclass, fields\n@dataclass\nclass Person:\n    name: str\n    age: int',
    expected: ['name', 'age'],
    sample: '[f.name for f in fields(Person)]',
    hints: ['fields() returns field objects'],
    tags: ['dataclass', 'fields'],
  },
  {
    id: 'py-dc-518',
    category: 'dataclasses',
    difficulty: 'hard',
    title: 'Dataclass KW Only',
    text: 'Force keyword-only arguments',
    setup:
      'from dataclasses import dataclass\n@dataclass(kw_only=True)\nclass Config:\n    host: str\n    port: int',
    setupCode:
      'from dataclasses import dataclass\n@dataclass(kw_only=True)\nclass Config:\n    host: str\n    port: int\nc = Config(host="localhost", port=8080)',
    expected: 'localhost',
    sample: 'c.host',
    hints: ['kw_only=True requires keyword arguments'],
    tags: ['dataclass', 'kw_only'],
  },
  {
    id: 'py-dc-519',
    category: 'dataclasses',
    difficulty: 'medium',
    title: 'Dataclass Match Args',
    text: 'Use dataclass in pattern matching',
    setup: 'from dataclasses import dataclass\n@dataclass\nclass Point:\n    x: int\n    y: int',
    setupCode:
      'from dataclasses import dataclass\n@dataclass\nclass Point:\n    x: int\n    y: int\np = Point(3, 4)\nmatch p:\n    case Point(x=x, y=y):\n        result = x + y',
    expected: 7,
    sample: 'result',
    hints: ['Dataclasses work with structural pattern matching'],
    tags: ['dataclass', 'pattern-matching'],
  },

  // ============================================================
  // MORE TYPE HINTS
  // ============================================================
  {
    id: 'py-type-520',
    category: 'typing',
    difficulty: 'hard',
    title: 'ParamSpec Usage',
    text: 'Preserve function signature with ParamSpec',
    setup:
      'from typing import Callable, ParamSpec, TypeVar\nP = ParamSpec("P")\nR = TypeVar("R")\ndef logged(fn: Callable[P, R]) -> Callable[P, R]:\n    def wrapper(*args: P.args, **kwargs: P.kwargs) -> R:\n        return fn(*args, **kwargs)\n    return wrapper\n@logged\ndef add(a: int, b: int) -> int: return a + b',
    setupCode:
      'from typing import Callable, ParamSpec, TypeVar\nP = ParamSpec("P")\nR = TypeVar("R")\ndef logged(fn: Callable[P, R]) -> Callable[P, R]:\n    def wrapper(*args: P.args, **kwargs: P.kwargs) -> R:\n        return fn(*args, **kwargs)\n    return wrapper\n@logged\ndef add(a: int, b: int) -> int: return a + b',
    expected: 7,
    sample: 'add(3, 4)',
    hints: ['ParamSpec captures function parameter types'],
    tags: ['typing', 'paramspec'],
  },
  {
    id: 'py-type-521',
    category: 'typing',
    difficulty: 'medium',
    title: 'Final Annotation',
    text: 'Mark constant as Final',
    setup: 'from typing import Final\nMAX_SIZE: Final = 100',
    setupCode: 'from typing import Final\nMAX_SIZE: Final = 100',
    expected: 100,
    sample: 'MAX_SIZE',
    hints: ['Final indicates value should not be reassigned'],
    tags: ['typing', 'final'],
  },
  {
    id: 'py-type-522',
    category: 'typing',
    difficulty: 'hard',
    title: 'ClassVar Annotation',
    text: 'Mark class variable with ClassVar',
    setup:
      'from typing import ClassVar\nfrom dataclasses import dataclass\n@dataclass\nclass Counter:\n    count: ClassVar[int] = 0\n    name: str',
    setupCode:
      'from typing import ClassVar\nfrom dataclasses import dataclass\n@dataclass\nclass Counter:\n    count: ClassVar[int] = 0\n    name: str\nCounter.count = 5',
    expected: 5,
    sample: 'Counter.count',
    hints: ['ClassVar marks class-level attributes'],
    tags: ['typing', 'classvar'],
  },
  {
    id: 'py-type-523',
    category: 'typing',
    difficulty: 'medium',
    title: 'Type Alias',
    text: 'Create type alias',
    setup:
      'from typing import List, Tuple\nVector = List[float]\nPoint = Tuple[float, float]\ndef scale(v: Vector, factor: float) -> Vector:\n    return [x * factor for x in v]',
    setupCode:
      'from typing import List, Tuple\nVector = List[float]\nPoint = Tuple[float, float]\ndef scale(v: Vector, factor: float) -> Vector:\n    return [x * factor for x in v]',
    expected: [2.0, 4.0, 6.0],
    sample: 'scale([1.0, 2.0, 3.0], 2.0)',
    hints: ['Type aliases make complex types readable'],
    tags: ['typing', 'alias'],
  },
  {
    id: 'py-type-524',
    category: 'typing',
    difficulty: 'hard',
    title: 'Overload Decorator',
    text: 'Define overloaded function signatures',
    setup:
      'from typing import overload\n@overload\ndef process(x: int) -> int: ...\n@overload\ndef process(x: str) -> str: ...\ndef process(x):\n    if isinstance(x, int): return x * 2\n    return x.upper()',
    setupCode:
      'from typing import overload\n@overload\ndef process(x: int) -> int: ...\n@overload\ndef process(x: str) -> str: ...\ndef process(x):\n    if isinstance(x, int): return x * 2\n    return x.upper()',
    expected: 'HELLO',
    sample: 'process("hello")',
    hints: ['overload provides multiple type signatures'],
    tags: ['typing', 'overload'],
  },

  // ============================================================
  // MORE ADVANCED PROBLEMS
  // ============================================================
  {
    id: 'py-adv-525',
    category: 'advanced',
    difficulty: 'hard',
    title: 'Walrus in Comprehension',
    text: 'Use walrus operator to avoid double computation',
    setup: 'def expensive(x): return x ** 2\nnums = [1, 2, 3, 4, 5]',
    setupCode: 'def expensive(x): return x ** 2\nnums = [1, 2, 3, 4, 5]',
    expected: [4, 9, 16, 25],
    sample: '[y for x in nums if (y := expensive(x)) > 2]',
    hints: ['Walrus operator assigns and returns value'],
    tags: ['walrus', 'comprehension'],
  },
  {
    id: 'py-adv-526',
    category: 'advanced',
    difficulty: 'hard',
    title: 'Structural Pattern Matching',
    text: 'Match complex data structure',
    setup: 'data = {"type": "point", "x": 3, "y": 4}',
    setupCode:
      'data = {"type": "point", "x": 3, "y": 4}\nmatch data:\n    case {"type": "point", "x": x, "y": y}:\n        result = x + y\n    case _:\n        result = 0',
    expected: 7,
    sample: 'result',
    hints: ['Match dict patterns with key extraction'],
    tags: ['pattern-matching', 'dict'],
  },
  {
    id: 'py-adv-527',
    category: 'advanced',
    difficulty: 'hard',
    title: 'Exception Group',
    text: 'Handle multiple exceptions together',
    setup: 'errors = [ValueError("bad"), TypeError("wrong")]',
    setupCode:
      'errors = [ValueError("bad"), TypeError("wrong")]\neg = ExceptionGroup("multiple errors", errors)',
    expected: 2,
    sample: 'len(eg.exceptions)',
    hints: ['ExceptionGroup bundles multiple exceptions'],
    tags: ['exception', 'group'],
  },
  {
    id: 'py-adv-528',
    category: 'advanced',
    difficulty: 'medium',
    title: 'Slots Class',
    text: 'Define class with __slots__',
    setup:
      'class Point:\n    __slots__ = ["x", "y"]\n    def __init__(self, x, y):\n        self.x, self.y = x, y',
    setupCode:
      'class Point:\n    __slots__ = ["x", "y"]\n    def __init__(self, x, y):\n        self.x, self.y = x, y\np = Point(3, 4)',
    expected: false,
    sample: 'hasattr(p, "__dict__")',
    hints: ['__slots__ prevents __dict__ creation'],
    tags: ['class', 'slots'],
  },
  {
    id: 'py-adv-529',
    category: 'advanced',
    difficulty: 'hard',
    title: 'Property with Setter',
    text: 'Create property with getter and setter',
    setup:
      'class Circle:\n    def __init__(self, r): self._r = r\n    @property\n    def radius(self): return self._r\n    @radius.setter\n    def radius(self, v): self._r = max(0, v)',
    setupCode:
      'class Circle:\n    def __init__(self, r): self._r = r\n    @property\n    def radius(self): return self._r\n    @radius.setter\n    def radius(self, v): self._r = max(0, v)\nc = Circle(5)\nc.radius = -10',
    expected: 0,
    sample: 'c.radius',
    hints: ['Setter validates and transforms values'],
    tags: ['property', 'setter'],
  },

  // ========================================
  // BEGINNER FUNDAMENTALS
  // ========================================

  // -- For Loops & Iteration (5 problems) --
  {
    id: 'py-beginner-loop-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Basic for Loop with range()',
    text: 'Use a for loop with range() to print numbers 0 through 4',
    setup: '',
    setupCode: '',
    expected: [0, 1, 2, 3, 4],
    sample: '[i for i in range(5)]',
    hints: [
      'range(n) generates numbers from 0 to n-1',
      'Use a list comprehension or append to a list in the loop',
    ],
    tags: ['beginner', 'loop', 'range'],
  },
  {
    id: 'py-beginner-loop-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Loop with enumerate()',
    text: 'Use enumerate() to get both index and value from a list',
    setup: 'fruits = ["apple", "banana", "cherry"]',
    setupCode: 'fruits = ["apple", "banana", "cherry"]',
    expected: [
      [0, 'apple'],
      [1, 'banana'],
      [2, 'cherry'],
    ],
    sample: '[[i, fruit] for i, fruit in enumerate(fruits)]',
    hints: [
      'enumerate() returns tuples of (index, value)',
      'Unpack the tuple in the for loop: for i, val in enumerate(list)',
    ],
    tags: ['beginner', 'loop', 'enumerate'],
  },
  {
    id: 'py-beginner-loop-003',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'While Loop with Counter',
    text: 'Use a while loop to count from 1 to 5',
    setup: '',
    setupCode: '',
    expected: [1, 2, 3, 4, 5],
    sample: 'result = []\ni = 1\nwhile i <= 5:\n    result.append(i)\n    i += 1\nresult',
    hints: [
      'Initialize a counter variable before the loop',
      'Increment the counter inside the loop',
      'Set a condition to stop the loop',
    ],
    tags: ['beginner', 'loop', 'while'],
  },
  {
    id: 'py-beginner-loop-004',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Loop Through String Characters',
    text: 'Loop through each character in a string and collect them in a list',
    setup: 'word = "hello"',
    setupCode: 'word = "hello"',
    expected: ['h', 'e', 'l', 'l', 'o'],
    sample: '[char for char in word]',
    hints: ['Strings are iterable in Python', 'Use a for loop: for char in string'],
    tags: ['beginner', 'loop', 'string'],
  },
  {
    id: 'py-beginner-loop-005',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Loop with range() and Step',
    text: 'Use range() with a step to get even numbers from 0 to 10',
    setup: '',
    setupCode: '',
    expected: [0, 2, 4, 6, 8, 10],
    sample: '[i for i in range(0, 11, 2)]',
    hints: [
      'range(start, stop, step) takes three arguments',
      'Step of 2 gives every second number',
    ],
    tags: ['beginner', 'loop', 'range'],
  },

  // -- Conditionals (4 problems) --
  {
    id: 'py-beginner-cond-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Simple if Statement',
    text: 'Check if a number is greater than 10 and return "big" or "small"',
    setup: 'num = 15',
    setupCode: 'num = 15',
    expected: 'big',
    sample: '"big" if num > 10 else "small"',
    hints: [
      'Use a ternary expression: value_if_true if condition else value_if_false',
      'Or use a regular if/else block',
    ],
    tags: ['beginner', 'conditional', 'ternary'],
  },
  {
    id: 'py-beginner-cond-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'if/elif/else Chain',
    text: 'Return "A" if score >= 90, "B" if >= 80, "C" if >= 70, else "F"',
    setup: 'score = 85',
    setupCode: 'score = 85',
    expected: 'B',
    sample: '"A" if score >= 90 else "B" if score >= 80 else "C" if score >= 70 else "F"',
    hints: [
      'Use nested ternary expressions or a traditional if/elif/else block',
      'Check conditions from highest to lowest',
    ],
    tags: ['beginner', 'conditional', 'elif'],
  },
  {
    id: 'py-beginner-cond-003',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Check Even or Odd',
    text: 'Return "even" if number is even, "odd" otherwise',
    setup: 'n = 7',
    setupCode: 'n = 7',
    expected: 'odd',
    sample: '"even" if n % 2 == 0 else "odd"',
    hints: [
      'Use the modulo operator % to check remainder',
      'Even numbers have remainder 0 when divided by 2',
    ],
    tags: ['beginner', 'conditional', 'modulo'],
  },
  {
    id: 'py-beginner-cond-004',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Multiple Conditions with and',
    text: 'Return True if number is between 10 and 20 (inclusive)',
    setup: 'x = 15',
    setupCode: 'x = 15',
    expected: true,
    sample: '10 <= x <= 20',
    hints: ['Python allows chained comparisons: a <= x <= b', 'Or use: x >= 10 and x <= 20'],
    tags: ['beginner', 'conditional', 'logical-operators'],
  },

  // -- Lists (3 problems) --
  {
    id: 'py-beginner-list-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Append to a List',
    text: 'Create an empty list, append 1, 2, 3 to it, and return the list',
    setup: '',
    setupCode: '',
    expected: [1, 2, 3],
    sample: 'nums = []\nnums.append(1)\nnums.append(2)\nnums.append(3)\nnums',
    hints: ['Use list.append(item) to add items to the end', 'Start with an empty list: []'],
    tags: ['beginner', 'list', 'append'],
  },
  {
    id: 'py-beginner-list-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'List Indexing and Slicing',
    text: 'Get the first 3 elements from a list',
    setup: 'nums = [10, 20, 30, 40, 50]',
    setupCode: 'nums = [10, 20, 30, 40, 50]',
    expected: [10, 20, 30],
    sample: 'nums[:3]',
    hints: [
      'Use slice notation: list[start:end]',
      'Omitting start defaults to 0',
      'End index is exclusive',
    ],
    tags: ['beginner', 'list', 'slicing'],
  },
  {
    id: 'py-beginner-list-003',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'List Length with len()',
    text: 'Return the number of elements in a list',
    setup: 'items = ["a", "b", "c", "d"]',
    setupCode: 'items = ["a", "b", "c", "d"]',
    expected: 4,
    sample: 'len(items)',
    hints: ['Use the built-in len() function', 'len(list) returns the count of elements'],
    tags: ['beginner', 'list', 'len'],
  },

  // -- Dictionaries (2 problems) --
  {
    id: 'py-beginner-dict-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Create and Access Dictionary',
    text: 'Create a dictionary with name: "Alice", age: 25, and access the age',
    setup: '',
    setupCode: '',
    expected: 25,
    sample: 'person = {"name": "Alice", "age": 25}\nperson["age"]',
    hints: [
      'Create a dict with curly braces: {key: value}',
      'Access values with square brackets: dict[key]',
    ],
    tags: ['beginner', 'dict', 'access'],
  },
  {
    id: 'py-beginner-dict-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Dictionary keys() and values()',
    text: 'Get all keys from a dictionary as a list',
    setup: 'data = {"x": 1, "y": 2, "z": 3}',
    setupCode: 'data = {"x": 1, "y": 2, "z": 3}',
    expected: ['x', 'y', 'z'],
    sample: 'list(data.keys())',
    hints: ['Use dict.keys() to get a view of keys', 'Convert to list with list()'],
    tags: ['beginner', 'dict', 'keys'],
  },

  // -- Functions (2 problems) --
  {
    id: 'py-beginner-func-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Define a Simple Function',
    text: 'Define a function that takes a number and returns its double',
    setup: '',
    setupCode: '',
    expected: 10,
    sample: 'def double(n):\n    return n * 2\ndouble(5)',
    hints: ['Use def function_name(parameters):', 'Return a value with the return keyword'],
    tags: ['beginner', 'function', 'return'],
  },
  {
    id: 'py-beginner-func-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Function with Multiple Parameters',
    text: 'Define a function that takes two numbers and returns their sum',
    setup: '',
    setupCode: '',
    expected: 8,
    sample: 'def add(a, b):\n    return a + b\nadd(3, 5)',
    hints: [
      'Separate parameters with commas: def func(a, b)',
      'Use both parameters in the function body',
    ],
    tags: ['beginner', 'function', 'parameters'],
  },
];

export default pythonProblems;
