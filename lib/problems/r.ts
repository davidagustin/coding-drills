import type { Problem } from '../types';

export const rProblems: Problem[] = [
  // ============================================================
  // VECTOR OPERATIONS - Easy (8 problems)
  // ============================================================
  {
    id: 'r-vector-001',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Create a Numeric Vector',
    text: 'Create a vector containing the numbers 1, 2, 3, 4, 5 using the c() function.',
    setup: '# Create a numeric vector',
    setupCode: '# Create a numeric vector',
    expected: [1, 2, 3, 4, 5],
    sample: 'c(1, 2, 3, 4, 5)',
    hints: ['Use the c() function to combine values', 'c stands for combine or concatenate'],
    validPatterns: [/c\s*\(/],
    tags: ['vectors', 'c', 'basics'],
  },
  {
    id: 'r-vector-002',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Find Vector Length',
    text: 'Find the length of the given vector using the length() function.',
    setup: 'numbers <- c(10, 20, 30, 40, 50, 60)',
    setupCode: 'numbers <- c(10, 20, 30, 40, 50, 60)',
    expected: 6,
    sample: 'length(numbers)',
    hints: ['Use the length() function', 'It returns the number of elements in a vector'],
    validPatterns: [/length\s*\(/],
    tags: ['vectors', 'length', 'basics'],
  },
  {
    id: 'r-vector-003',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Calculate Vector Sum',
    text: 'Calculate the sum of all elements in the given vector.',
    setup: 'values <- c(5, 10, 15, 20)',
    setupCode: 'values <- c(5, 10, 15, 20)',
    expected: 50,
    sample: 'sum(values)',
    hints: ['Use the sum() function', 'It adds all elements together'],
    validPatterns: [/sum\s*\(/],
    tags: ['vectors', 'sum', 'aggregation'],
  },
  {
    id: 'r-vector-004',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Calculate Vector Mean',
    text: 'Calculate the arithmetic mean (average) of the given vector.',
    setup: 'scores <- c(80, 90, 85, 95, 70)',
    setupCode: 'scores <- c(80, 90, 85, 95, 70)',
    expected: 84,
    sample: 'mean(scores)',
    hints: ['Use the mean() function', 'Mean is the sum divided by count'],
    validPatterns: [/mean\s*\(/],
    tags: ['vectors', 'mean', 'statistics'],
  },
  {
    id: 'r-vector-005',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Find Maximum Value',
    text: 'Find the maximum value in the given vector.',
    setup: 'temps <- c(72, 85, 68, 91, 77)',
    setupCode: 'temps <- c(72, 85, 68, 91, 77)',
    expected: 91,
    sample: 'max(temps)',
    hints: ['Use the max() function', 'It returns the largest element'],
    validPatterns: [/max\s*\(/],
    tags: ['vectors', 'max', 'aggregation'],
  },
  {
    id: 'r-vector-006',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Find Minimum Value',
    text: 'Find the minimum value in the given vector.',
    setup: 'prices <- c(25.99, 19.99, 34.50, 12.00, 28.75)',
    setupCode: 'prices <- c(25.99, 19.99, 34.50, 12.00, 28.75)',
    expected: 12.0,
    sample: 'min(prices)',
    hints: ['Use the min() function', 'It returns the smallest element'],
    validPatterns: [/min\s*\(/],
    tags: ['vectors', 'min', 'aggregation'],
  },
  {
    id: 'r-vector-007',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Sort Vector Ascending',
    text: 'Sort the given vector in ascending order.',
    setup: 'nums <- c(5, 2, 8, 1, 9, 3)',
    setupCode: 'nums <- c(5, 2, 8, 1, 9, 3)',
    expected: [1, 2, 3, 5, 8, 9],
    sample: 'sort(nums)',
    hints: ['Use the sort() function', 'Default sorting is ascending'],
    validPatterns: [/sort\s*\(/],
    tags: ['vectors', 'sort', 'ordering'],
  },
  {
    id: 'r-vector-008',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Reverse a Vector',
    text: 'Reverse the order of elements in the given vector.',
    setup: 'letters_vec <- c("a", "b", "c", "d", "e")',
    setupCode: 'letters_vec <- c("a", "b", "c", "d", "e")',
    expected: ['e', 'd', 'c', 'b', 'a'],
    sample: 'rev(letters_vec)',
    hints: ['Use the rev() function', 'It reverses the element order'],
    validPatterns: [/rev\s*\(/],
    tags: ['vectors', 'rev', 'ordering'],
  },

  // ============================================================
  // STRING FUNCTIONS - Easy (6 problems)
  // ============================================================
  {
    id: 'r-string-001',
    category: 'String Functions',
    difficulty: 'easy',
    title: 'Concatenate Strings with Paste',
    text: 'Join the two strings together with a space between them using paste().',
    setup: 'first <- "Hello"\nsecond <- "World"',
    setupCode: 'first <- "Hello"\nsecond <- "World"',
    expected: 'Hello World',
    sample: 'paste(first, second)',
    hints: ['Use the paste() function', 'Default separator is a space'],
    validPatterns: [/paste\s*\(/],
    tags: ['strings', 'paste', 'concatenation'],
  },
  {
    id: 'r-string-002',
    category: 'String Functions',
    difficulty: 'easy',
    title: 'Get String Length',
    text: 'Find the number of characters in the given string.',
    setup: 'message <- "R Programming"',
    setupCode: 'message <- "R Programming"',
    expected: 13,
    sample: 'nchar(message)',
    hints: ['Use the nchar() function', 'It counts all characters including spaces'],
    validPatterns: [/nchar\s*\(/],
    tags: ['strings', 'nchar', 'length'],
  },
  {
    id: 'r-string-003',
    category: 'String Functions',
    difficulty: 'easy',
    title: 'Convert to Uppercase',
    text: 'Convert the given string to all uppercase letters.',
    setup: 'text <- "data science"',
    setupCode: 'text <- "data science"',
    expected: 'DATA SCIENCE',
    sample: 'toupper(text)',
    hints: ['Use the toupper() function', 'It converts all letters to uppercase'],
    validPatterns: [/toupper\s*\(/],
    tags: ['strings', 'toupper', 'case'],
  },
  {
    id: 'r-string-004',
    category: 'String Functions',
    difficulty: 'easy',
    title: 'Convert to Lowercase',
    text: 'Convert the given string to all lowercase letters.',
    setup: 'title <- "MACHINE LEARNING"',
    setupCode: 'title <- "MACHINE LEARNING"',
    expected: 'machine learning',
    sample: 'tolower(title)',
    hints: ['Use the tolower() function', 'It converts all letters to lowercase'],
    validPatterns: [/tolower\s*\(/],
    tags: ['strings', 'tolower', 'case'],
  },
  {
    id: 'r-string-005',
    category: 'String Functions',
    difficulty: 'easy',
    title: 'Extract Substring',
    text: 'Extract characters 1 through 5 from the given string.',
    setup: 'word <- "Statistics"',
    setupCode: 'word <- "Statistics"',
    expected: 'Stati',
    sample: 'substr(word, 1, 5)',
    hints: ['Use the substr() function', 'Provide start and stop positions'],
    validPatterns: [/substr\s*\(/],
    tags: ['strings', 'substr', 'extraction'],
  },
  {
    id: 'r-string-006',
    category: 'String Functions',
    difficulty: 'easy',
    title: 'Paste with Custom Separator',
    text: 'Join the three words with a hyphen separator.',
    setup: 'w1 <- "one"\nw2 <- "two"\nw3 <- "three"',
    setupCode: 'w1 <- "one"\nw2 <- "two"\nw3 <- "three"',
    expected: 'one-two-three',
    sample: 'paste(w1, w2, w3, sep = "-")',
    hints: ['Use paste() with sep argument', 'sep defines the separator between elements'],
    validPatterns: [/paste\s*\(/, /sep\s*=/],
    tags: ['strings', 'paste', 'separator'],
  },

  // ============================================================
  // LIST OPERATIONS - Easy (3 problems)
  // ============================================================
  {
    id: 'r-list-001',
    category: 'List Operations',
    difficulty: 'easy',
    title: 'Create a Named List',
    text: 'Create a list with name="Alice" and age=30.',
    setup: '# Create a named list',
    setupCode: '# Create a named list',
    expected: { name: 'Alice', age: 30 },
    sample: 'list(name = "Alice", age = 30)',
    hints: ['Use the list() function', 'Assign names with = inside list()'],
    validPatterns: [/list\s*\(/],
    tags: ['lists', 'list', 'creation'],
  },
  {
    id: 'r-list-002',
    category: 'List Operations',
    difficulty: 'easy',
    title: 'Get List Element Names',
    text: 'Get the names of all elements in the given list.',
    setup: 'person <- list(name = "Bob", age = 25, city = "NYC")',
    setupCode: 'person <- list(name = "Bob", age = 25, city = "NYC")',
    expected: ['name', 'age', 'city'],
    sample: 'names(person)',
    hints: ['Use the names() function', 'It returns a character vector of names'],
    validPatterns: [/names\s*\(/],
    tags: ['lists', 'names', 'attributes'],
  },
  {
    id: 'r-list-003',
    category: 'List Operations',
    difficulty: 'easy',
    title: 'Access List Element by Name',
    text: 'Extract the "city" element from the list using $ notation.',
    setup: 'info <- list(name = "Carol", age = 28, city = "Boston")',
    setupCode: 'info <- list(name = "Carol", age = 28, city = "Boston")',
    expected: 'Boston',
    sample: 'info$city',
    hints: ['Use the $ operator to access by name', 'Syntax is list$elementname'],
    validPatterns: [/\$city/],
    tags: ['lists', 'access', 'dollar'],
  },

  // ============================================================
  // DATA FRAME BASICS - Easy (2 problems)
  // ============================================================
  {
    id: 'r-dataframe-001',
    category: 'Data Frame Basics',
    difficulty: 'easy',
    title: 'Get Number of Rows',
    text: 'Find the number of rows in the given data frame.',
    setup: 'df <- data.frame(x = 1:5, y = c("a", "b", "c", "d", "e"))',
    setupCode: 'df <- data.frame(x = 1:5, y = c("a", "b", "c", "d", "e"))',
    expected: 5,
    sample: 'nrow(df)',
    hints: ['Use the nrow() function', 'It returns the number of rows'],
    validPatterns: [/nrow\s*\(/],
    tags: ['dataframes', 'nrow', 'dimensions'],
  },
  {
    id: 'r-dataframe-002',
    category: 'Data Frame Basics',
    difficulty: 'easy',
    title: 'Get Number of Columns',
    text: 'Find the number of columns in the given data frame.',
    setup: 'df <- data.frame(a = 1:3, b = 4:6, c = 7:9, d = 10:12)',
    setupCode: 'df <- data.frame(a = 1:3, b = 4:6, c = 7:9, d = 10:12)',
    expected: 4,
    sample: 'ncol(df)',
    hints: ['Use the ncol() function', 'It returns the number of columns'],
    validPatterns: [/ncol\s*\(/],
    tags: ['dataframes', 'ncol', 'dimensions'],
  },

  // ============================================================
  // MATH FUNCTIONS - Easy (1 problem)
  // ============================================================
  {
    id: 'r-math-001',
    category: 'Math Functions',
    difficulty: 'easy',
    title: 'Calculate Square Root',
    text: 'Calculate the square root of 144.',
    setup: 'num <- 144',
    setupCode: 'num <- 144',
    expected: 12,
    sample: 'sqrt(num)',
    hints: ['Use the sqrt() function', 'Square root of 144 is 12'],
    validPatterns: [/sqrt\s*\(/],
    tags: ['math', 'sqrt', 'arithmetic'],
  },

  // ============================================================
  // VECTOR OPERATIONS - Medium (4 problems)
  // ============================================================
  {
    id: 'r-vector-009',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Get Unique Values',
    text: 'Extract all unique values from the vector that contains duplicates.',
    setup: 'data <- c(1, 2, 2, 3, 3, 3, 4, 4, 4, 4)',
    setupCode: 'data <- c(1, 2, 2, 3, 3, 3, 4, 4, 4, 4)',
    expected: [1, 2, 3, 4],
    sample: 'unique(data)',
    hints: ['Use the unique() function', 'It removes duplicate values'],
    validPatterns: [/unique\s*\(/],
    tags: ['vectors', 'unique', 'duplicates'],
  },
  {
    id: 'r-vector-010',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Sort Vector Descending',
    text: 'Sort the given vector in descending order (largest to smallest).',
    setup: 'values <- c(15, 8, 23, 4, 16)',
    setupCode: 'values <- c(15, 8, 23, 4, 16)',
    expected: [23, 16, 15, 8, 4],
    sample: 'sort(values, decreasing = TRUE)',
    hints: ['Use sort() with decreasing argument', 'Set decreasing = TRUE'],
    validPatterns: [/sort\s*\(/, /decreasing\s*=\s*TRUE/],
    tags: ['vectors', 'sort', 'ordering'],
  },
  {
    id: 'r-vector-011',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Filter Even Numbers',
    text: 'Extract only the even numbers from the vector using logical indexing.',
    setup: 'numbers <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)',
    setupCode: 'numbers <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)',
    expected: [2, 4, 6, 8, 10],
    sample: 'numbers[numbers %% 2 == 0]',
    hints: ['Use modulo operator %% to check for even', 'Use logical indexing with []'],
    validPatterns: [/%%/, /==\s*0/],
    tags: ['vectors', 'filtering', 'modulo'],
  },
  {
    id: 'r-vector-012',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Calculate Range',
    text: 'Find the range (difference between max and min) of the vector.',
    setup: 'temps <- c(55, 72, 68, 81, 59, 65)',
    setupCode: 'temps <- c(55, 72, 68, 81, 59, 65)',
    expected: 26,
    sample: 'max(temps) - min(temps)',
    hints: ['Range is max minus min', 'Use both max() and min() functions'],
    validPatterns: [/max\s*\(/, /min\s*\(/],
    tags: ['vectors', 'range', 'statistics'],
  },

  // ============================================================
  // STRING FUNCTIONS - Medium (5 problems)
  // ============================================================
  {
    id: 'r-string-007',
    category: 'String Functions',
    difficulty: 'medium',
    title: 'Split String by Delimiter',
    text: 'Split the CSV string by commas into a vector of individual items.',
    setup: 'csv <- "apple,banana,cherry,date"',
    setupCode: 'csv <- "apple,banana,cherry,date"',
    expected: [['apple', 'banana', 'cherry', 'date']],
    sample: 'strsplit(csv, ",")',
    hints: ['Use the strsplit() function', 'First argument is string, second is delimiter'],
    validPatterns: [/strsplit\s*\(/],
    tags: ['strings', 'strsplit', 'splitting'],
  },
  {
    id: 'r-string-008',
    category: 'String Functions',
    difficulty: 'medium',
    title: 'Replace Pattern with gsub',
    text: 'Replace all spaces in the string with underscores.',
    setup: 'sentence <- "this is a test"',
    setupCode: 'sentence <- "this is a test"',
    expected: 'this_is_a_test',
    sample: 'gsub(" ", "_", sentence)',
    hints: ['Use gsub() for global substitution', 'Arguments: pattern, replacement, string'],
    validPatterns: [/gsub\s*\(/],
    tags: ['strings', 'gsub', 'replacement'],
  },
  {
    id: 'r-string-009',
    category: 'String Functions',
    difficulty: 'medium',
    title: 'Paste with Collapse',
    text: 'Combine the vector of words into a single string separated by spaces.',
    setup: 'words <- c("R", "is", "awesome")',
    setupCode: 'words <- c("R", "is", "awesome")',
    expected: 'R is awesome',
    sample: 'paste(words, collapse = " ")',
    hints: ['Use paste() with collapse argument', 'collapse joins vector elements into one string'],
    validPatterns: [/paste\s*\(/, /collapse\s*=/],
    tags: ['strings', 'paste', 'collapse'],
  },
  {
    id: 'r-string-010',
    category: 'String Functions',
    difficulty: 'medium',
    title: 'Extract Last N Characters',
    text: 'Extract the last 4 characters from the string.',
    setup: 'filename <- "report2023.csv"',
    setupCode: 'filename <- "report2023.csv"',
    expected: '.csv',
    sample: 'substr(filename, nchar(filename) - 3, nchar(filename))',
    hints: ['Combine substr() with nchar()', 'Calculate the start position dynamically'],
    validPatterns: [/substr\s*\(/, /nchar\s*\(/],
    tags: ['strings', 'substr', 'nchar'],
  },
  {
    id: 'r-string-011',
    category: 'String Functions',
    difficulty: 'medium',
    title: 'Remove Digits from String',
    text: 'Remove all digits from the given string using gsub.',
    setup: 'mixed <- "abc123def456"',
    setupCode: 'mixed <- "abc123def456"',
    expected: 'abcdef',
    sample: 'gsub("[0-9]", "", mixed)',
    hints: ['Use gsub() with regex pattern', '[0-9] matches any digit'],
    validPatterns: [/gsub\s*\(/, /\[0-9\]/],
    tags: ['strings', 'gsub', 'regex'],
  },

  // ============================================================
  // LIST OPERATIONS - Medium (4 problems)
  // ============================================================
  {
    id: 'r-list-004',
    category: 'List Operations',
    difficulty: 'medium',
    title: 'Apply Function to List with lapply',
    text: 'Use lapply to find the length of each element in the list.',
    setup: 'items <- list(a = 1:5, b = 1:10, c = 1:3)',
    setupCode: 'items <- list(a = 1:5, b = 1:10, c = 1:3)',
    expected: { a: 5, b: 10, c: 3 },
    sample: 'lapply(items, length)',
    hints: [
      'Use lapply() to apply a function to each element',
      'First arg is list, second is function',
    ],
    validPatterns: [/lapply\s*\(/],
    tags: ['lists', 'lapply', 'apply'],
  },
  {
    id: 'r-list-005',
    category: 'List Operations',
    difficulty: 'medium',
    title: 'Simplify with sapply',
    text: 'Use sapply to calculate the mean of each numeric vector in the list and return a simple vector.',
    setup: 'data <- list(x = c(1, 2, 3), y = c(10, 20, 30), z = c(5, 5, 5))',
    setupCode: 'data <- list(x = c(1, 2, 3), y = c(10, 20, 30), z = c(5, 5, 5))',
    expected: { x: 2, y: 20, z: 5 },
    sample: 'sapply(data, mean)',
    hints: ['sapply simplifies output when possible', 'It returns a vector instead of list'],
    validPatterns: [/sapply\s*\(/],
    tags: ['lists', 'sapply', 'apply'],
  },
  {
    id: 'r-list-006',
    category: 'List Operations',
    difficulty: 'medium',
    title: 'Modify List Names',
    text: 'Change the names of the list elements to "first", "second", "third".',
    setup: 'my_list <- list(a = 1, b = 2, c = 3)',
    setupCode: 'my_list <- list(a = 1, b = 2, c = 3)',
    expected: ['first', 'second', 'third'],
    sample: 'names(my_list) <- c("first", "second", "third"); names(my_list)',
    hints: ['Assign new values to names()', 'names() can be used on left side of assignment'],
    validPatterns: [/names\s*\(/, /<-/],
    tags: ['lists', 'names', 'modification'],
  },
  {
    id: 'r-list-007',
    category: 'List Operations',
    difficulty: 'medium',
    title: 'Apply Custom Function with lapply',
    text: 'Use lapply to square each numeric value in the list.',
    setup: 'nums <- list(a = 2, b = 3, c = 4, d = 5)',
    setupCode: 'nums <- list(a = 2, b = 3, c = 4, d = 5)',
    expected: { a: 4, b: 9, c: 16, d: 25 },
    sample: 'lapply(nums, function(x) x^2)',
    hints: ['Use anonymous function inside lapply', 'function(x) x^2 squares the input'],
    validPatterns: [/lapply\s*\(/, /function\s*\(/],
    tags: ['lists', 'lapply', 'anonymous-function'],
  },

  // ============================================================
  // DATA FRAME BASICS - Medium (4 problems)
  // ============================================================
  {
    id: 'r-dataframe-003',
    category: 'Data Frame Basics',
    difficulty: 'medium',
    title: 'Create a Data Frame',
    text: 'Create a data frame with columns: name (character) and score (numeric).',
    setup: '# Create a data frame with 3 students',
    setupCode: '# Create a data frame with 3 students',
    expected: { name: ['Alice', 'Bob', 'Carol'], score: [85, 92, 78] },
    sample: 'data.frame(name = c("Alice", "Bob", "Carol"), score = c(85, 92, 78))',
    hints: ['Use data.frame() to create', 'Each column is a named vector'],
    validPatterns: [/data\.frame\s*\(/],
    tags: ['dataframes', 'creation', 'data.frame'],
  },
  {
    id: 'r-dataframe-004',
    category: 'Data Frame Basics',
    difficulty: 'medium',
    title: 'Subset Rows by Condition',
    text: 'Get all rows where age is greater than 25.',
    setup: 'df <- data.frame(name = c("Amy", "Ben", "Cal"), age = c(22, 28, 35))',
    setupCode: 'df <- data.frame(name = c("Amy", "Ben", "Cal"), age = c(22, 28, 35))',
    expected: { name: ['Ben', 'Cal'], age: [28, 35] },
    sample: 'subset(df, age > 25)',
    hints: ['Use the subset() function', 'Second argument is the condition'],
    validPatterns: [/subset\s*\(/],
    tags: ['dataframes', 'subset', 'filtering'],
  },
  {
    id: 'r-dataframe-005',
    category: 'Data Frame Basics',
    difficulty: 'medium',
    title: 'Select Specific Columns',
    text: 'Select only the name and city columns from the data frame.',
    setup: 'df <- data.frame(name = c("X", "Y"), age = c(20, 30), city = c("LA", "NY"))',
    setupCode: 'df <- data.frame(name = c("X", "Y"), age = c(20, 30), city = c("LA", "NY"))',
    expected: { name: ['X', 'Y'], city: ['LA', 'NY'] },
    sample: 'subset(df, select = c(name, city))',
    hints: ['Use subset() with select argument', 'select specifies which columns to keep'],
    validPatterns: [/subset\s*\(/, /select\s*=/],
    tags: ['dataframes', 'subset', 'columns'],
  },
  {
    id: 'r-dataframe-006',
    category: 'Data Frame Basics',
    difficulty: 'medium',
    title: 'Access Column as Vector',
    text: 'Extract the "price" column as a vector using $ notation.',
    setup: 'products <- data.frame(item = c("A", "B", "C"), price = c(10, 20, 30))',
    setupCode: 'products <- data.frame(item = c("A", "B", "C"), price = c(10, 20, 30))',
    expected: [10, 20, 30],
    sample: 'products$price',
    hints: ['Use $ operator to access columns', 'Returns a vector'],
    validPatterns: [/\$price/],
    tags: ['dataframes', 'access', 'dollar'],
  },

  // ============================================================
  // MATH FUNCTIONS - Medium (3 problems)
  // ============================================================
  {
    id: 'r-math-002',
    category: 'Math Functions',
    difficulty: 'medium',
    title: 'Calculate Absolute Values',
    text: 'Find the absolute values of all elements in the vector.',
    setup: 'values <- c(-5, 3, -8, 12, -1)',
    setupCode: 'values <- c(-5, 3, -8, 12, -1)',
    expected: [5, 3, 8, 12, 1],
    sample: 'abs(values)',
    hints: ['Use the abs() function', 'It works on entire vectors'],
    validPatterns: [/abs\s*\(/],
    tags: ['math', 'abs', 'vectors'],
  },
  {
    id: 'r-math-003',
    category: 'Math Functions',
    difficulty: 'medium',
    title: 'Round to Decimal Places',
    text: 'Round the numbers to 2 decimal places.',
    setup: 'prices <- c(10.567, 23.891, 5.123, 99.999)',
    setupCode: 'prices <- c(10.567, 23.891, 5.123, 99.999)',
    expected: [10.57, 23.89, 5.12, 100],
    sample: 'round(prices, 2)',
    hints: ['Use round() with digits argument', 'Second argument specifies decimal places'],
    validPatterns: [/round\s*\(/],
    tags: ['math', 'round', 'precision'],
  },
  {
    id: 'r-math-004',
    category: 'Math Functions',
    difficulty: 'medium',
    title: 'Apply Ceiling Function',
    text: 'Round all numbers up to the nearest integer using ceiling.',
    setup: 'nums <- c(1.2, 2.7, 3.0, 4.5, 5.9)',
    setupCode: 'nums <- c(1.2, 2.7, 3.0, 4.5, 5.9)',
    expected: [2, 3, 3, 5, 6],
    sample: 'ceiling(nums)',
    hints: ['Use the ceiling() function', 'It always rounds up'],
    validPatterns: [/ceiling\s*\(/],
    tags: ['math', 'ceiling', 'rounding'],
  },

  // ============================================================
  // VECTOR OPERATIONS - Hard (2 problems)
  // ============================================================
  {
    id: 'r-vector-013',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Find Values Above Mean',
    text: 'Extract all values that are above the mean of the vector.',
    setup: 'scores <- c(45, 72, 89, 56, 91, 68, 77, 83)',
    setupCode: 'scores <- c(45, 72, 89, 56, 91, 68, 77, 83)',
    expected: [72, 89, 91, 77, 83],
    sample: 'scores[scores > mean(scores)]',
    hints: ['Calculate mean inside the condition', 'Use logical indexing with comparison'],
    validPatterns: [/mean\s*\(/, />/],
    tags: ['vectors', 'filtering', 'statistics'],
  },
  {
    id: 'r-vector-014',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Combine and Sort Unique Values',
    text: 'Combine two vectors, remove duplicates, and sort in descending order.',
    setup: 'v1 <- c(5, 3, 8, 3, 1)\nv2 <- c(8, 2, 5, 9, 1)',
    setupCode: 'v1 <- c(5, 3, 8, 3, 1)\nv2 <- c(8, 2, 5, 9, 1)',
    expected: [9, 8, 5, 3, 2, 1],
    sample: 'sort(unique(c(v1, v2)), decreasing = TRUE)',
    hints: ['First combine with c()', 'Then unique(), then sort()'],
    validPatterns: [/sort\s*\(/, /unique\s*\(/, /c\s*\(/],
    tags: ['vectors', 'combining', 'unique', 'sort'],
  },

  // ============================================================
  // STRING FUNCTIONS - Hard (2 problems)
  // ============================================================
  {
    id: 'r-string-012',
    category: 'String Functions',
    difficulty: 'hard',
    title: 'Extract Domain from Email',
    text: 'Extract the domain (part after @) from the email address.',
    setup: 'email <- "user@example.com"',
    setupCode: 'email <- "user@example.com"',
    expected: 'example.com',
    sample: 'strsplit(email, "@")[[1]][2]',
    hints: ['Split by @ symbol', 'Access second element of result'],
    validPatterns: [/strsplit\s*\(/, /@/],
    tags: ['strings', 'strsplit', 'extraction'],
  },
  {
    id: 'r-string-013',
    category: 'String Functions',
    difficulty: 'hard',
    title: 'Clean and Standardize String',
    text: 'Convert to lowercase, replace spaces with underscores, and remove non-alphanumeric characters except underscores.',
    setup: 'messy <- "Hello World! 123"',
    setupCode: 'messy <- "Hello World! 123"',
    expected: 'hello_world_123',
    sample: 'gsub("[^a-z0-9_]", "", gsub(" ", "_", tolower(messy)))',
    hints: ['Chain multiple transformations', 'Use tolower, gsub for spaces, gsub for cleaning'],
    validPatterns: [/tolower\s*\(/, /gsub\s*\(/],
    tags: ['strings', 'cleaning', 'standardization'],
  },

  // ============================================================
  // LIST OPERATIONS - Hard (2 problems)
  // ============================================================
  {
    id: 'r-list-008',
    category: 'List Operations',
    difficulty: 'hard',
    title: 'Filter List Elements by Condition',
    text: 'Use lapply and sapply to keep only list elements with sum greater than 10.',
    setup: 'data <- list(a = c(1, 2, 3), b = c(5, 5, 5), c = c(1, 1, 1))',
    setupCode: 'data <- list(a = c(1, 2, 3), b = c(5, 5, 5), c = c(1, 1, 1))',
    expected: { b: [5, 5, 5] },
    sample: 'data[sapply(data, sum) > 10]',
    hints: ['Use sapply to get sums as vector', 'Use logical indexing on the list'],
    validPatterns: [/sapply\s*\(/, /sum/],
    tags: ['lists', 'filtering', 'sapply'],
  },
  {
    id: 'r-list-009',
    category: 'List Operations',
    difficulty: 'hard',
    title: 'Nested List Access and Modification',
    text: 'Extract the nested value "deep_value" from the complex nested list structure.',
    setup: 'nested <- list(level1 = list(level2 = list(target = "deep_value")))',
    setupCode: 'nested <- list(level1 = list(level2 = list(target = "deep_value")))',
    expected: 'deep_value',
    sample: 'nested$level1$level2$target',
    hints: ['Chain $ operators for nested access', 'Go through each level sequentially'],
    validPatterns: [/\$level1/, /\$level2/, /\$target/],
    tags: ['lists', 'nested', 'access'],
  },

  // ============================================================
  // DATA FRAME BASICS - Hard (2 problems)
  // ============================================================
  {
    id: 'r-dataframe-007',
    category: 'Data Frame Basics',
    difficulty: 'hard',
    title: 'Merge Two Data Frames',
    text: 'Merge the two data frames by the common "id" column.',
    setup:
      'df1 <- data.frame(id = 1:3, name = c("A", "B", "C"))\ndf2 <- data.frame(id = 1:3, score = c(80, 90, 85))',
    setupCode:
      'df1 <- data.frame(id = 1:3, name = c("A", "B", "C"))\ndf2 <- data.frame(id = 1:3, score = c(80, 90, 85))',
    expected: { id: [1, 2, 3], name: ['A', 'B', 'C'], score: [80, 90, 85] },
    sample: 'merge(df1, df2, by = "id")',
    hints: ['Use the merge() function', 'Specify the common column with by argument'],
    validPatterns: [/merge\s*\(/, /by\s*=/],
    tags: ['dataframes', 'merge', 'joining'],
  },
  {
    id: 'r-dataframe-008',
    category: 'Data Frame Basics',
    difficulty: 'hard',
    title: 'Subset with Multiple Conditions',
    text: 'Get rows where age > 20 AND salary > 50000.',
    setup:
      'employees <- data.frame(\n  name = c("Ann", "Bob", "Cat", "Dan"),\n  age = c(25, 19, 32, 28),\n  salary = c(55000, 45000, 72000, 48000)\n)',
    setupCode:
      'employees <- data.frame(\n  name = c("Ann", "Bob", "Cat", "Dan"),\n  age = c(25, 19, 32, 28),\n  salary = c(55000, 45000, 72000, 48000)\n)',
    expected: { name: ['Ann', 'Cat'], age: [25, 32], salary: [55000, 72000] },
    sample: 'subset(employees, age > 20 & salary > 50000)',
    hints: ['Use & for AND conditions in subset', 'Both conditions must be TRUE'],
    validPatterns: [/subset\s*\(/, /&/],
    tags: ['dataframes', 'subset', 'conditions'],
  },

  // ============================================================
  // MATH FUNCTIONS - Hard (2 problems)
  // ============================================================
  {
    id: 'r-math-005',
    category: 'Math Functions',
    difficulty: 'hard',
    title: 'Normalize Vector to 0-1 Range',
    text: 'Normalize the vector so all values fall between 0 and 1 using min-max scaling.',
    setup: 'values <- c(10, 20, 30, 40, 50)',
    setupCode: 'values <- c(10, 20, 30, 40, 50)',
    expected: [0, 0.25, 0.5, 0.75, 1],
    sample: '(values - min(values)) / (max(values) - min(values))',
    hints: ['Formula: (x - min) / (max - min)', 'Use vectorized operations'],
    validPatterns: [/min\s*\(/, /max\s*\(/],
    tags: ['math', 'normalization', 'scaling'],
  },
  {
    id: 'r-math-006',
    category: 'Math Functions',
    difficulty: 'hard',
    title: 'Calculate Compound Interest',
    text: 'Calculate the final amount after 5 years with $1000 principal at 5% annual interest compounded annually. Use: A = P * (1 + r)^t',
    setup: 'principal <- 1000\nrate <- 0.05\nyears <- 5',
    setupCode: 'principal <- 1000\nrate <- 0.05\nyears <- 5',
    expected: 1276.28,
    sample: 'round(principal * (1 + rate)^years, 2)',
    hints: ['Use ^ for exponentiation', 'Round to 2 decimal places'],
    validPatterns: [/\^/, /round\s*\(/],
    tags: ['math', 'finance', 'exponentiation'],
  },

  // ============================================================
  // ADDITIONAL MEDIUM PROBLEMS (to reach 20)
  // ============================================================
  {
    id: 'r-vector-015',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Calculate Cumulative Sum',
    text: 'Calculate the cumulative sum of the vector (running total).',
    setup: 'payments <- c(100, 200, 150, 300)',
    setupCode: 'payments <- c(100, 200, 150, 300)',
    expected: [100, 300, 450, 750],
    sample: 'cumsum(payments)',
    hints: [
      'Use the cumsum() function',
      'Each element is sum of all previous elements plus current',
    ],
    validPatterns: [/cumsum\s*\(/],
    tags: ['vectors', 'cumsum', 'cumulative'],
  },
  {
    id: 'r-math-007',
    category: 'Math Functions',
    difficulty: 'medium',
    title: 'Apply Floor Function',
    text: 'Round all numbers down to the nearest integer using floor.',
    setup: 'decimals <- c(1.9, 2.1, 3.7, 4.0, 5.5)',
    setupCode: 'decimals <- c(1.9, 2.1, 3.7, 4.0, 5.5)',
    expected: [1, 2, 3, 4, 5],
    sample: 'floor(decimals)',
    hints: ['Use the floor() function', 'It always rounds down'],
    validPatterns: [/floor\s*\(/],
    tags: ['math', 'floor', 'rounding'],
  },
  {
    id: 'r-math-008',
    category: 'Math Functions',
    difficulty: 'medium',
    title: 'Calculate Natural Logarithm',
    text: 'Calculate the natural logarithm (base e) of each element.',
    setup: 'values <- c(1, 2.718, 7.389)',
    setupCode: 'values <- c(1, 2.718, 7.389)',
    expected: [0, 1, 2],
    sample: 'round(log(values))',
    hints: ['Use the log() function for natural log', 'log(e) = 1'],
    validPatterns: [/log\s*\(/],
    tags: ['math', 'log', 'logarithm'],
  },
  {
    id: 'r-math-009',
    category: 'Math Functions',
    difficulty: 'medium',
    title: 'Calculate Exponential',
    text: 'Calculate e raised to the power of each element.',
    setup: 'powers <- c(0, 1, 2)',
    setupCode: 'powers <- c(0, 1, 2)',
    expected: [1, 2.72, 7.39],
    sample: 'round(exp(powers), 2)',
    hints: ['Use the exp() function', 'exp(1) = e â‰ˆ 2.718'],
    validPatterns: [/exp\s*\(/],
    tags: ['math', 'exp', 'exponential'],
  },

  // ============================================================
  // ADDITIONAL HARD PROBLEMS (to reach 10)
  // ============================================================
  {
    id: 'r-vector-016',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Z-Score Standardization',
    text: 'Standardize the vector using z-score: (x - mean) / sd',
    setup: 'data <- c(2, 4, 4, 4, 5, 5, 7, 9)',
    setupCode: 'data <- c(2, 4, 4, 4, 5, 5, 7, 9)',
    expected: [-1.5, -0.5, -0.5, -0.5, 0, 0, 1, 2],
    sample: '(data - mean(data)) / sd(data)',
    hints: ['Use mean() and sd() functions', 'sd() calculates standard deviation'],
    validPatterns: [/mean\s*\(/, /sd\s*\(/],
    tags: ['vectors', 'statistics', 'standardization'],
  },
  {
    id: 'r-dataframe-009',
    category: 'Data Frame Basics',
    difficulty: 'hard',
    title: 'Add Calculated Column',
    text: 'Add a new column "total" that is the sum of columns a, b, and c.',
    setup: 'df <- data.frame(a = c(1, 2, 3), b = c(4, 5, 6), c = c(7, 8, 9))',
    setupCode: 'df <- data.frame(a = c(1, 2, 3), b = c(4, 5, 6), c = c(7, 8, 9))',
    expected: { a: [1, 2, 3], b: [4, 5, 6], c: [7, 8, 9], total: [12, 15, 18] },
    sample: 'df$total <- df$a + df$b + df$c; df',
    hints: ['Create new column with $', 'Use vectorized addition'],
    validPatterns: [/\$total/, /<-/],
    tags: ['dataframes', 'columns', 'calculation'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 1: Vector Operations (30 problems)
  // ============================================================
  {
    id: 'r-vec-100',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Create Sequence with Colon',
    text: 'Create a vector containing integers from 1 to 10 using the colon operator.',
    setup: '# Create a sequence from 1 to 10',
    setupCode: '# Create a sequence from 1 to 10',
    expected: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
    sample: '1:10',
    hints: ['Use the colon operator :', 'start:end creates a sequence'],
    tags: ['vectors', 'sequence', 'colon'],
  },
  {
    id: 'r-vec-101',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Create Sequence with seq()',
    text: 'Create a sequence from 0 to 100 by increments of 10.',
    setup: '# Create sequence 0, 10, 20, ..., 100',
    setupCode: '# Create sequence 0, 10, 20, ..., 100',
    expected: [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100],
    sample: 'seq(0, 100, by = 10)',
    hints: ['Use seq() function', 'by argument sets the increment'],
    tags: ['vectors', 'seq', 'sequence'],
  },
  {
    id: 'r-vec-102',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Repeat a Value',
    text: 'Create a vector with the number 5 repeated 6 times.',
    setup: '# Repeat 5 six times',
    setupCode: '# Repeat 5 six times',
    expected: [5, 5, 5, 5, 5, 5],
    sample: 'rep(5, 6)',
    hints: ['Use rep() function', 'First arg is value, second is times'],
    tags: ['vectors', 'rep', 'repeat'],
  },
  {
    id: 'r-vec-103',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Access Element by Index',
    text: 'Get the third element from the vector.',
    setup: 'fruits <- c("apple", "banana", "cherry", "date")',
    setupCode: 'fruits <- c("apple", "banana", "cherry", "date")',
    expected: 'cherry',
    sample: 'fruits[3]',
    hints: ['Use square brackets []', 'R indexing starts at 1'],
    tags: ['vectors', 'indexing', 'access'],
  },
  {
    id: 'r-vec-104',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Access Multiple Elements',
    text: 'Get the first and fourth elements from the vector.',
    setup: 'nums <- c(10, 20, 30, 40, 50)',
    setupCode: 'nums <- c(10, 20, 30, 40, 50)',
    expected: [10, 40],
    sample: 'nums[c(1, 4)]',
    hints: ['Use c() inside brackets', 'Provide indices as a vector'],
    tags: ['vectors', 'indexing', 'subset'],
  },
  {
    id: 'r-vec-105',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Negative Indexing',
    text: 'Get all elements except the second one.',
    setup: 'letters_vec <- c("a", "b", "c", "d")',
    setupCode: 'letters_vec <- c("a", "b", "c", "d")',
    expected: ['a', 'c', 'd'],
    sample: 'letters_vec[-2]',
    hints: ['Negative index excludes elements', 'Use -2 to exclude second element'],
    tags: ['vectors', 'indexing', 'negative'],
  },
  {
    id: 'r-vec-106',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Vector Product',
    text: 'Calculate the product of all elements in the vector.',
    setup: 'factors <- c(2, 3, 4, 5)',
    setupCode: 'factors <- c(2, 3, 4, 5)',
    expected: 120,
    sample: 'prod(factors)',
    hints: ['Use prod() function', 'It multiplies all elements together'],
    tags: ['vectors', 'prod', 'aggregation'],
  },
  {
    id: 'r-vec-107',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Check for NA Values',
    text: 'Check which elements are NA in the vector.',
    setup: 'data <- c(1, NA, 3, NA, 5)',
    setupCode: 'data <- c(1, NA, 3, NA, 5)',
    expected: [false, true, false, true, false],
    sample: 'is.na(data)',
    hints: ['Use is.na() function', 'Returns TRUE for NA values'],
    tags: ['vectors', 'na', 'missing'],
  },
  {
    id: 'r-vec-108',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Count TRUE Values',
    text: 'Count how many values in the vector are greater than 50.',
    setup: 'scores <- c(45, 67, 89, 34, 56, 78)',
    setupCode: 'scores <- c(45, 67, 89, 34, 56, 78)',
    expected: 4,
    sample: 'sum(scores > 50)',
    hints: ['Comparison returns logical vector', 'sum() counts TRUE as 1'],
    tags: ['vectors', 'counting', 'logical'],
  },
  {
    id: 'r-vec-109',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Which Indices Match',
    text: 'Find the indices of elements greater than 10.',
    setup: 'vals <- c(5, 15, 8, 20, 3, 12)',
    setupCode: 'vals <- c(5, 15, 8, 20, 3, 12)',
    expected: [2, 4, 6],
    sample: 'which(vals > 10)',
    hints: ['Use which() function', 'Returns indices where condition is TRUE'],
    tags: ['vectors', 'which', 'indices'],
  },
  {
    id: 'r-vec-110',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Find Index of Maximum',
    text: 'Find the index of the maximum value in the vector.',
    setup: 'temps <- c(68, 72, 85, 79, 81)',
    setupCode: 'temps <- c(68, 72, 85, 79, 81)',
    expected: 3,
    sample: 'which.max(temps)',
    hints: ['Use which.max() function', 'Returns index of first maximum'],
    tags: ['vectors', 'which.max', 'index'],
  },
  {
    id: 'r-vec-111',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Find Index of Minimum',
    text: 'Find the index of the minimum value in the vector.',
    setup: 'prices <- c(25, 18, 32, 15, 28)',
    setupCode: 'prices <- c(25, 18, 32, 15, 28)',
    expected: 4,
    sample: 'which.min(prices)',
    hints: ['Use which.min() function', 'Returns index of first minimum'],
    tags: ['vectors', 'which.min', 'index'],
  },
  {
    id: 'r-vec-112',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Calculate Median',
    text: 'Find the median value of the vector.',
    setup: 'data <- c(3, 7, 2, 9, 5)',
    setupCode: 'data <- c(3, 7, 2, 9, 5)',
    expected: 5,
    sample: 'median(data)',
    hints: ['Use median() function', 'Middle value when sorted'],
    tags: ['vectors', 'median', 'statistics'],
  },
  {
    id: 'r-vec-113',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Calculate Variance',
    text: 'Calculate the variance of the vector.',
    setup: 'nums <- c(2, 4, 4, 4, 5, 5, 7, 9)',
    setupCode: 'nums <- c(2, 4, 4, 4, 5, 5, 7, 9)',
    expected: 4,
    sample: 'var(nums)',
    hints: ['Use var() function', 'Measures spread of data'],
    tags: ['vectors', 'var', 'statistics'],
  },
  {
    id: 'r-vec-114',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Calculate Standard Deviation',
    text: 'Calculate the standard deviation of the vector.',
    setup: 'vals <- c(2, 4, 4, 4, 5, 5, 7, 9)',
    setupCode: 'vals <- c(2, 4, 4, 4, 5, 5, 7, 9)',
    expected: 2,
    sample: 'sd(vals)',
    hints: ['Use sd() function', 'Square root of variance'],
    tags: ['vectors', 'sd', 'statistics'],
  },
  {
    id: 'r-vec-115',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Vector Element-wise Addition',
    text: 'Add 10 to each element of the vector.',
    setup: 'nums <- c(1, 2, 3, 4, 5)',
    setupCode: 'nums <- c(1, 2, 3, 4, 5)',
    expected: [11, 12, 13, 14, 15],
    sample: 'nums + 10',
    hints: ['R uses vectorized operations', 'Scalar is recycled across vector'],
    tags: ['vectors', 'arithmetic', 'vectorized'],
  },
  {
    id: 'r-vec-116',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Vector Element-wise Multiplication',
    text: 'Multiply two vectors element by element.',
    setup: 'a <- c(1, 2, 3)\nb <- c(4, 5, 6)',
    setupCode: 'a <- c(1, 2, 3)\nb <- c(4, 5, 6)',
    expected: [4, 10, 18],
    sample: 'a * b',
    hints: ['Use * for element-wise multiplication', 'Vectors must have same length'],
    tags: ['vectors', 'arithmetic', 'multiplication'],
  },
  {
    id: 'r-vec-117',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Logical AND on Vectors',
    text: 'Find elements where both conditions are true: greater than 3 AND less than 8.',
    setup: 'x <- c(1, 4, 6, 9, 2, 7)',
    setupCode: 'x <- c(1, 4, 6, 9, 2, 7)',
    expected: [4, 6, 7],
    sample: 'x[x > 3 & x < 8]',
    hints: ['Use & for element-wise AND', 'Combine conditions in brackets'],
    tags: ['vectors', 'logical', 'filtering'],
  },
  {
    id: 'r-vec-118',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Logical OR on Vectors',
    text: 'Find elements less than 3 OR greater than 7.',
    setup: 'x <- c(1, 4, 6, 9, 2, 7)',
    setupCode: 'x <- c(1, 4, 6, 9, 2, 7)',
    expected: [1, 9, 2],
    sample: 'x[x < 3 | x > 7]',
    hints: ['Use | for element-wise OR', 'Either condition can be true'],
    tags: ['vectors', 'logical', 'filtering'],
  },
  {
    id: 'r-vec-119',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Replace NA with Value',
    text: 'Replace all NA values with 0.',
    setup: 'data <- c(1, NA, 3, NA, 5)',
    setupCode: 'data <- c(1, NA, 3, NA, 5)',
    expected: [1, 0, 3, 0, 5],
    sample: 'data[is.na(data)] <- 0; data',
    hints: ['Use is.na() to find NAs', 'Assign new value to those positions'],
    tags: ['vectors', 'na', 'replacement'],
  },
  {
    id: 'r-vec-120',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Calculate Quantiles',
    text: 'Find the 25th and 75th percentiles of the vector.',
    setup: 'scores <- c(45, 55, 65, 70, 75, 80, 85, 90, 95)',
    setupCode: 'scores <- c(45, 55, 65, 70, 75, 80, 85, 90, 95)',
    expected: { '25%': 62.5, '75%': 87.5 },
    sample: 'quantile(scores, c(0.25, 0.75))',
    hints: ['Use quantile() function', 'Pass probabilities as second argument'],
    tags: ['vectors', 'quantile', 'statistics'],
  },
  {
    id: 'r-vec-121',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Running Difference',
    text: 'Calculate the difference between consecutive elements.',
    setup: 'values <- c(10, 15, 13, 20, 18)',
    setupCode: 'values <- c(10, 15, 13, 20, 18)',
    expected: [5, -2, 7, -2],
    sample: 'diff(values)',
    hints: ['Use diff() function', 'Returns vector of length n-1'],
    tags: ['vectors', 'diff', 'consecutive'],
  },
  {
    id: 'r-vec-122',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Cumulative Product',
    text: 'Calculate the cumulative product of the vector.',
    setup: 'nums <- c(1, 2, 3, 4)',
    setupCode: 'nums <- c(1, 2, 3, 4)',
    expected: [1, 2, 6, 24],
    sample: 'cumprod(nums)',
    hints: ['Use cumprod() function', 'Each element is product of all previous'],
    tags: ['vectors', 'cumprod', 'cumulative'],
  },
  {
    id: 'r-vec-123',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Cumulative Maximum',
    text: 'Calculate the cumulative maximum of the vector.',
    setup: 'data <- c(3, 1, 4, 1, 5, 9, 2)',
    setupCode: 'data <- c(3, 1, 4, 1, 5, 9, 2)',
    expected: [3, 3, 4, 4, 5, 9, 9],
    sample: 'cummax(data)',
    hints: ['Use cummax() function', 'Returns running maximum'],
    tags: ['vectors', 'cummax', 'cumulative'],
  },
  {
    id: 'r-vec-124',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Cumulative Minimum',
    text: 'Calculate the cumulative minimum of the vector.',
    setup: 'data <- c(5, 3, 7, 2, 8, 1)',
    setupCode: 'data <- c(5, 3, 7, 2, 8, 1)',
    expected: [5, 3, 3, 2, 2, 1],
    sample: 'cummin(data)',
    hints: ['Use cummin() function', 'Returns running minimum'],
    tags: ['vectors', 'cummin', 'cumulative'],
  },
  {
    id: 'r-vec-125',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Rank Values',
    text: 'Get the rank of each element in the vector.',
    setup: 'scores <- c(85, 92, 78, 92, 88)',
    setupCode: 'scores <- c(85, 92, 78, 92, 88)',
    expected: [2, 4.5, 1, 4.5, 3],
    sample: 'rank(scores)',
    hints: ['Use rank() function', 'Ties get average rank by default'],
    tags: ['vectors', 'rank', 'ordering'],
  },
  {
    id: 'r-vec-126',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Order Indices',
    text: 'Get the indices that would sort the vector in ascending order.',
    setup: 'vals <- c(30, 10, 50, 20, 40)',
    setupCode: 'vals <- c(30, 10, 50, 20, 40)',
    expected: [2, 4, 1, 5, 3],
    sample: 'order(vals)',
    hints: ['Use order() function', 'Returns permutation indices'],
    tags: ['vectors', 'order', 'sorting'],
  },
  {
    id: 'r-vec-127',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Pairwise Maximum',
    text: 'Find the element-wise maximum of two vectors.',
    setup: 'a <- c(3, 7, 2, 9)\nb <- c(5, 4, 8, 6)',
    setupCode: 'a <- c(3, 7, 2, 9)\nb <- c(5, 4, 8, 6)',
    expected: [5, 7, 8, 9],
    sample: 'pmax(a, b)',
    hints: ['Use pmax() function', 'Parallel maximum comparison'],
    tags: ['vectors', 'pmax', 'comparison'],
  },
  {
    id: 'r-vec-128',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Pairwise Minimum',
    text: 'Find the element-wise minimum of two vectors.',
    setup: 'a <- c(3, 7, 2, 9)\nb <- c(5, 4, 8, 6)',
    setupCode: 'a <- c(3, 7, 2, 9)\nb <- c(5, 4, 8, 6)',
    expected: [3, 4, 2, 6],
    sample: 'pmin(a, b)',
    hints: ['Use pmin() function', 'Parallel minimum comparison'],
    tags: ['vectors', 'pmin', 'comparison'],
  },
  {
    id: 'r-vec-129',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Create Named Vector',
    text: 'Create a named vector with names "a", "b", "c" and values 1, 2, 3.',
    setup: '# Create a named vector',
    setupCode: '# Create a named vector',
    expected: { a: 1, b: 2, c: 3 },
    sample: 'c(a = 1, b = 2, c = 3)',
    hints: ['Use name = value syntax in c()', 'Names become vector attributes'],
    tags: ['vectors', 'names', 'creation'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 2: Data Frame Operations (30 problems)
  // ============================================================
  {
    id: 'r-df-100',
    category: 'Data Frame Operations',
    difficulty: 'easy',
    title: 'Get Column Names',
    text: 'Get the names of all columns in the data frame.',
    setup: 'df <- data.frame(name = c("A", "B"), age = c(25, 30), city = c("NYC", "LA"))',
    setupCode: 'df <- data.frame(name = c("A", "B"), age = c(25, 30), city = c("NYC", "LA"))',
    expected: ['name', 'age', 'city'],
    sample: 'colnames(df)',
    hints: ['Use colnames() or names()', 'Both return column names'],
    tags: ['dataframes', 'colnames', 'attributes'],
  },
  {
    id: 'r-df-101',
    category: 'Data Frame Operations',
    difficulty: 'easy',
    title: 'Get Dimensions',
    text: 'Get the dimensions (rows and columns) of the data frame.',
    setup: 'df <- data.frame(a = 1:5, b = 6:10, c = 11:15)',
    setupCode: 'df <- data.frame(a = 1:5, b = 6:10, c = 11:15)',
    expected: [5, 3],
    sample: 'dim(df)',
    hints: ['Use dim() function', 'Returns c(nrow, ncol)'],
    tags: ['dataframes', 'dim', 'dimensions'],
  },
  {
    id: 'r-df-102',
    category: 'Data Frame Operations',
    difficulty: 'easy',
    title: 'View First Rows',
    text: 'View the first 3 rows of the data frame.',
    setup: 'df <- data.frame(x = 1:10, y = 11:20)',
    setupCode: 'df <- data.frame(x = 1:10, y = 11:20)',
    expected: { x: [1, 2, 3], y: [11, 12, 13] },
    sample: 'head(df, 3)',
    hints: ['Use head() function', 'Second argument specifies number of rows'],
    tags: ['dataframes', 'head', 'preview'],
  },
  {
    id: 'r-df-103',
    category: 'Data Frame Operations',
    difficulty: 'easy',
    title: 'View Last Rows',
    text: 'View the last 2 rows of the data frame.',
    setup: 'df <- data.frame(x = 1:5, y = c("a", "b", "c", "d", "e"))',
    setupCode: 'df <- data.frame(x = 1:5, y = c("a", "b", "c", "d", "e"))',
    expected: { x: [4, 5], y: ['d', 'e'] },
    sample: 'tail(df, 2)',
    hints: ['Use tail() function', 'Returns last n rows'],
    tags: ['dataframes', 'tail', 'preview'],
  },
  {
    id: 'r-df-104',
    category: 'Data Frame Operations',
    difficulty: 'easy',
    title: 'Access Single Cell',
    text: 'Get the value in row 2, column 3.',
    setup: 'df <- data.frame(a = 1:3, b = 4:6, c = 7:9)',
    setupCode: 'df <- data.frame(a = 1:3, b = 4:6, c = 7:9)',
    expected: 8,
    sample: 'df[2, 3]',
    hints: ['Use [row, col] notation', 'Row first, column second'],
    tags: ['dataframes', 'indexing', 'access'],
  },
  {
    id: 'r-df-105',
    category: 'Data Frame Operations',
    difficulty: 'easy',
    title: 'Access Entire Row',
    text: 'Get all values from row 2.',
    setup: 'df <- data.frame(x = c(10, 20, 30), y = c("a", "b", "c"))',
    setupCode: 'df <- data.frame(x = c(10, 20, 30), y = c("a", "b", "c"))',
    expected: { x: 20, y: 'b' },
    sample: 'df[2, ]',
    hints: ['Leave column index empty', 'Comma is still required'],
    tags: ['dataframes', 'indexing', 'rows'],
  },
  {
    id: 'r-df-106',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Row Bind Data Frames',
    text: 'Combine two data frames by stacking rows.',
    setup:
      'df1 <- data.frame(x = 1:2, y = c("a", "b"))\ndf2 <- data.frame(x = 3:4, y = c("c", "d"))',
    setupCode:
      'df1 <- data.frame(x = 1:2, y = c("a", "b"))\ndf2 <- data.frame(x = 3:4, y = c("c", "d"))',
    expected: { x: [1, 2, 3, 4], y: ['a', 'b', 'c', 'd'] },
    sample: 'rbind(df1, df2)',
    hints: ['Use rbind() for row binding', 'Column names must match'],
    tags: ['dataframes', 'rbind', 'combining'],
  },
  {
    id: 'r-df-107',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Column Bind Data Frames',
    text: 'Combine two data frames by adding columns side by side.',
    setup: 'df1 <- data.frame(a = 1:3)\ndf2 <- data.frame(b = 4:6)',
    setupCode: 'df1 <- data.frame(a = 1:3)\ndf2 <- data.frame(b = 4:6)',
    expected: { a: [1, 2, 3], b: [4, 5, 6] },
    sample: 'cbind(df1, df2)',
    hints: ['Use cbind() for column binding', 'Row counts must match'],
    tags: ['dataframes', 'cbind', 'combining'],
  },
  {
    id: 'r-df-108',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Transform Column',
    text: 'Create a new column "double_x" that is x multiplied by 2.',
    setup: 'df <- data.frame(x = c(1, 2, 3, 4))',
    setupCode: 'df <- data.frame(x = c(1, 2, 3, 4))',
    expected: { x: [1, 2, 3, 4], double_x: [2, 4, 6, 8] },
    sample: 'transform(df, double_x = x * 2)',
    hints: ['Use transform() function', 'New column name = expression'],
    tags: ['dataframes', 'transform', 'columns'],
  },
  {
    id: 'r-df-109',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Sort Data Frame by Column',
    text: 'Sort the data frame by the "score" column in ascending order.',
    setup: 'df <- data.frame(name = c("A", "B", "C"), score = c(85, 72, 91))',
    setupCode: 'df <- data.frame(name = c("A", "B", "C"), score = c(85, 72, 91))',
    expected: { name: ['B', 'A', 'C'], score: [72, 85, 91] },
    sample: 'df[order(df$score), ]',
    hints: ['Use order() to get sorting indices', 'Apply to row index'],
    tags: ['dataframes', 'order', 'sorting'],
  },
  {
    id: 'r-df-110',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Sort Descending',
    text: 'Sort the data frame by "value" in descending order.',
    setup: 'df <- data.frame(id = c(1, 2, 3), value = c(30, 50, 20))',
    setupCode: 'df <- data.frame(id = c(1, 2, 3), value = c(30, 50, 20))',
    expected: { id: [2, 1, 3], value: [50, 30, 20] },
    sample: 'df[order(df$value, decreasing = TRUE), ]',
    hints: ['Use decreasing = TRUE in order()', 'Or use -df$value'],
    tags: ['dataframes', 'order', 'sorting'],
  },
  {
    id: 'r-df-111',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Remove Column',
    text: 'Remove the "temp" column from the data frame.',
    setup: 'df <- data.frame(id = 1:3, temp = c(98, 99, 97), status = c("A", "B", "A"))',
    setupCode: 'df <- data.frame(id = 1:3, temp = c(98, 99, 97), status = c("A", "B", "A"))',
    expected: { id: [1, 2, 3], status: ['A', 'B', 'A'] },
    sample: 'df$temp <- NULL; df',
    hints: ['Assign NULL to remove column', 'Or use negative column index'],
    tags: ['dataframes', 'remove', 'columns'],
  },
  {
    id: 'r-df-112',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Rename Column',
    text: 'Rename the "old_name" column to "new_name".',
    setup: 'df <- data.frame(old_name = 1:3, other = 4:6)',
    setupCode: 'df <- data.frame(old_name = 1:3, other = 4:6)',
    expected: ['new_name', 'other'],
    sample: 'names(df)[names(df) == "old_name"] <- "new_name"; names(df)',
    hints: ['Use names() with logical indexing', 'Assign new name to matching position'],
    tags: ['dataframes', 'rename', 'columns'],
  },
  {
    id: 'r-df-113',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Filter with Multiple Columns',
    text: 'Get rows where category is "A" and value is greater than 10.',
    setup: 'df <- data.frame(category = c("A", "B", "A", "B"), value = c(15, 20, 8, 12))',
    setupCode: 'df <- data.frame(category = c("A", "B", "A", "B"), value = c(15, 20, 8, 12))',
    expected: { category: ['A'], value: [15] },
    sample: 'subset(df, category == "A" & value > 10)',
    hints: ['Use & for AND condition', 'Both conditions must be true'],
    tags: ['dataframes', 'subset', 'filtering'],
  },
  {
    id: 'r-df-114',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Check for Complete Cases',
    text: 'Get rows with no missing values.',
    setup: 'df <- data.frame(a = c(1, NA, 3), b = c(4, 5, NA))',
    setupCode: 'df <- data.frame(a = c(1, NA, 3), b = c(4, 5, NA))',
    expected: { a: [1], b: [4] },
    sample: 'df[complete.cases(df), ]',
    hints: ['Use complete.cases() function', 'Returns TRUE for rows with no NA'],
    tags: ['dataframes', 'complete.cases', 'missing'],
  },
  {
    id: 'r-df-115',
    category: 'Data Frame Operations',
    difficulty: 'hard',
    title: 'Aggregate by Group',
    text: 'Calculate the mean of "value" for each "group".',
    setup: 'df <- data.frame(group = c("A", "A", "B", "B"), value = c(10, 20, 30, 40))',
    setupCode: 'df <- data.frame(group = c("A", "A", "B", "B"), value = c(10, 20, 30, 40))',
    expected: { group: ['A', 'B'], x: [15, 35] },
    sample: 'aggregate(value ~ group, data = df, FUN = mean)',
    hints: ['Use aggregate() with formula', 'formula: value ~ group'],
    tags: ['dataframes', 'aggregate', 'grouping'],
  },
  {
    id: 'r-df-116',
    category: 'Data Frame Operations',
    difficulty: 'hard',
    title: 'Left Join',
    text: 'Perform a left join keeping all rows from df1.',
    setup:
      'df1 <- data.frame(id = 1:3, x = c("a", "b", "c"))\ndf2 <- data.frame(id = c(1, 3), y = c(10, 30))',
    setupCode:
      'df1 <- data.frame(id = 1:3, x = c("a", "b", "c"))\ndf2 <- data.frame(id = c(1, 3), y = c(10, 30))',
    expected: { id: [1, 2, 3], x: ['a', 'b', 'c'], y: [10, null, 30] },
    sample: 'merge(df1, df2, by = "id", all.x = TRUE)',
    hints: ['Use merge() with all.x = TRUE', 'Keeps all rows from first df'],
    tags: ['dataframes', 'merge', 'join'],
  },
  {
    id: 'r-df-117',
    category: 'Data Frame Operations',
    difficulty: 'hard',
    title: 'Right Join',
    text: 'Perform a right join keeping all rows from df2.',
    setup:
      'df1 <- data.frame(id = c(1, 2), x = c("a", "b"))\ndf2 <- data.frame(id = 1:3, y = c(10, 20, 30))',
    setupCode:
      'df1 <- data.frame(id = c(1, 2), x = c("a", "b"))\ndf2 <- data.frame(id = 1:3, y = c(10, 20, 30))',
    expected: { id: [1, 2, 3], x: ['a', 'b', null], y: [10, 20, 30] },
    sample: 'merge(df1, df2, by = "id", all.y = TRUE)',
    hints: ['Use merge() with all.y = TRUE', 'Keeps all rows from second df'],
    tags: ['dataframes', 'merge', 'join'],
  },
  {
    id: 'r-df-118',
    category: 'Data Frame Operations',
    difficulty: 'hard',
    title: 'Full Outer Join',
    text: 'Perform a full outer join keeping all rows from both data frames.',
    setup:
      'df1 <- data.frame(id = c(1, 2), x = c("a", "b"))\ndf2 <- data.frame(id = c(2, 3), y = c(20, 30))',
    setupCode:
      'df1 <- data.frame(id = c(1, 2), x = c("a", "b"))\ndf2 <- data.frame(id = c(2, 3), y = c(20, 30))',
    expected: { id: [1, 2, 3], x: ['a', 'b', null], y: [null, 20, 30] },
    sample: 'merge(df1, df2, by = "id", all = TRUE)',
    hints: ['Use merge() with all = TRUE', 'Keeps all rows from both'],
    tags: ['dataframes', 'merge', 'join'],
  },
  {
    id: 'r-df-119',
    category: 'Data Frame Operations',
    difficulty: 'hard',
    title: 'Apply Function to Columns',
    text: 'Calculate the mean of each numeric column.',
    setup: 'df <- data.frame(a = c(1, 2, 3), b = c(4, 5, 6), c = c(7, 8, 9))',
    setupCode: 'df <- data.frame(a = c(1, 2, 3), b = c(4, 5, 6), c = c(7, 8, 9))',
    expected: { a: 2, b: 5, c: 8 },
    sample: 'sapply(df, mean)',
    hints: ['Use sapply() on data frame', 'Applies function to each column'],
    tags: ['dataframes', 'sapply', 'apply'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 3: dplyr Verbs (35 problems)
  // ============================================================
  {
    id: 'r-dplyr-100',
    category: 'dplyr Verbs',
    difficulty: 'easy',
    title: 'Filter Rows with filter()',
    text: 'Use dplyr::filter to get rows where age is greater than 25.',
    setup: 'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C"), age = c(22, 30, 28))',
    setupCode: 'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C"), age = c(22, 30, 28))',
    expected: { name: ['B', 'C'], age: [30, 28] },
    sample: 'filter(df, age > 25)',
    hints: ['Use filter() from dplyr', 'Condition goes as second argument'],
    tags: ['dplyr', 'filter', 'rows'],
  },
  {
    id: 'r-dplyr-101',
    category: 'dplyr Verbs',
    difficulty: 'easy',
    title: 'Select Columns with select()',
    text: 'Use dplyr::select to keep only the "name" and "score" columns.',
    setup:
      'library(dplyr)\ndf <- data.frame(name = c("A", "B"), age = c(25, 30), score = c(85, 90))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(name = c("A", "B"), age = c(25, 30), score = c(85, 90))',
    expected: { name: ['A', 'B'], score: [85, 90] },
    sample: 'select(df, name, score)',
    hints: ['Use select() from dplyr', 'List column names without quotes'],
    tags: ['dplyr', 'select', 'columns'],
  },
  {
    id: 'r-dplyr-102',
    category: 'dplyr Verbs',
    difficulty: 'easy',
    title: 'Add Column with mutate()',
    text: 'Use dplyr::mutate to add a column "double" that is value * 2.',
    setup: 'library(dplyr)\ndf <- data.frame(id = 1:3, value = c(10, 20, 30))',
    setupCode: 'library(dplyr)\ndf <- data.frame(id = 1:3, value = c(10, 20, 30))',
    expected: { id: [1, 2, 3], value: [10, 20, 30], double: [20, 40, 60] },
    sample: 'mutate(df, double = value * 2)',
    hints: ['Use mutate() from dplyr', 'new_col = expression'],
    tags: ['dplyr', 'mutate', 'columns'],
  },
  {
    id: 'r-dplyr-103',
    category: 'dplyr Verbs',
    difficulty: 'easy',
    title: 'Sort with arrange()',
    text: 'Use dplyr::arrange to sort by score in ascending order.',
    setup: 'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C"), score = c(85, 72, 91))',
    setupCode: 'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C"), score = c(85, 72, 91))',
    expected: { name: ['B', 'A', 'C'], score: [72, 85, 91] },
    sample: 'arrange(df, score)',
    hints: ['Use arrange() from dplyr', 'Default is ascending order'],
    tags: ['dplyr', 'arrange', 'sorting'],
  },
  {
    id: 'r-dplyr-104',
    category: 'dplyr Verbs',
    difficulty: 'easy',
    title: 'Sort Descending with arrange()',
    text: 'Use dplyr::arrange to sort by value in descending order.',
    setup: 'library(dplyr)\ndf <- data.frame(id = 1:4, value = c(30, 50, 20, 40))',
    setupCode: 'library(dplyr)\ndf <- data.frame(id = 1:4, value = c(30, 50, 20, 40))',
    expected: { id: [2, 4, 1, 3], value: [50, 40, 30, 20] },
    sample: 'arrange(df, desc(value))',
    hints: ['Use desc() for descending', 'Wrap column in desc()'],
    tags: ['dplyr', 'arrange', 'desc'],
  },
  {
    id: 'r-dplyr-105',
    category: 'dplyr Verbs',
    difficulty: 'easy',
    title: 'Summarize with summarize()',
    text: 'Calculate the mean of the score column.',
    setup: 'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C"), score = c(80, 90, 85))',
    setupCode: 'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C"), score = c(80, 90, 85))',
    expected: { mean_score: 85 },
    sample: 'summarize(df, mean_score = mean(score))',
    hints: ['Use summarize() from dplyr', 'result_name = function(column)'],
    tags: ['dplyr', 'summarize', 'aggregation'],
  },
  {
    id: 'r-dplyr-106',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Group and Summarize',
    text: 'Calculate mean score for each group.',
    setup:
      'library(dplyr)\ndf <- data.frame(group = c("A", "A", "B", "B"), score = c(80, 90, 70, 85))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(group = c("A", "A", "B", "B"), score = c(80, 90, 70, 85))',
    expected: { group: ['A', 'B'], mean_score: [85, 77.5] },
    sample: 'df %>% group_by(group) %>% summarize(mean_score = mean(score))',
    hints: ['Use group_by() then summarize()', 'Pipe with %>%'],
    tags: ['dplyr', 'group_by', 'summarize'],
  },
  {
    id: 'r-dplyr-107',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Count by Group',
    text: 'Count the number of rows in each category.',
    setup: 'library(dplyr)\ndf <- data.frame(category = c("A", "B", "A", "B", "A"))',
    setupCode: 'library(dplyr)\ndf <- data.frame(category = c("A", "B", "A", "B", "A"))',
    expected: { category: ['A', 'B'], n: [3, 2] },
    sample: 'count(df, category)',
    hints: ['Use count() from dplyr', 'Shortcut for group_by + n()'],
    tags: ['dplyr', 'count', 'grouping'],
  },
  {
    id: 'r-dplyr-108',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Select with Exclusion',
    text: 'Select all columns except "temp".',
    setup:
      'library(dplyr)\ndf <- data.frame(id = 1:3, temp = c(98, 99, 97), status = c("A", "B", "A"))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(id = 1:3, temp = c(98, 99, 97), status = c("A", "B", "A"))',
    expected: { id: [1, 2, 3], status: ['A', 'B', 'A'] },
    sample: 'select(df, -temp)',
    hints: ['Use - to exclude columns', 'Negative selection'],
    tags: ['dplyr', 'select', 'exclude'],
  },
  {
    id: 'r-dplyr-109',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Rename Column with rename()',
    text: 'Rename the "old" column to "new".',
    setup: 'library(dplyr)\ndf <- data.frame(old = 1:3, other = 4:6)',
    setupCode: 'library(dplyr)\ndf <- data.frame(old = 1:3, other = 4:6)',
    expected: { new: [1, 2, 3], other: [4, 5, 6] },
    sample: 'rename(df, new = old)',
    hints: ['Use rename() from dplyr', 'new_name = old_name'],
    tags: ['dplyr', 'rename', 'columns'],
  },
  {
    id: 'r-dplyr-110',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Filter with Multiple Conditions',
    text: 'Get rows where age > 20 AND score >= 80.',
    setup:
      'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C", "D"), age = c(25, 18, 30, 22), score = c(85, 90, 75, 82))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C", "D"), age = c(25, 18, 30, 22), score = c(85, 90, 75, 82))',
    expected: { name: ['A', 'D'], age: [25, 22], score: [85, 82] },
    sample: 'filter(df, age > 20, score >= 80)',
    hints: ['Separate conditions with comma', 'Acts as AND'],
    tags: ['dplyr', 'filter', 'conditions'],
  },
  {
    id: 'r-dplyr-111',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Filter with OR Condition',
    text: 'Get rows where status is "A" OR value > 50.',
    setup:
      'library(dplyr)\ndf <- data.frame(id = 1:4, status = c("A", "B", "B", "A"), value = c(30, 60, 40, 20))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(id = 1:4, status = c("A", "B", "B", "A"), value = c(30, 60, 40, 20))',
    expected: { id: [1, 2, 4], status: ['A', 'B', 'A'], value: [30, 60, 20] },
    sample: 'filter(df, status == "A" | value > 50)',
    hints: ['Use | for OR condition', 'Either condition can be true'],
    tags: ['dplyr', 'filter', 'or'],
  },
  {
    id: 'r-dplyr-112',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Select Range of Columns',
    text: 'Select columns from "a" to "c" inclusive.',
    setup: 'library(dplyr)\ndf <- data.frame(a = 1:2, b = 3:4, c = 5:6, d = 7:8)',
    setupCode: 'library(dplyr)\ndf <- data.frame(a = 1:2, b = 3:4, c = 5:6, d = 7:8)',
    expected: { a: [1, 2], b: [3, 4], c: [5, 6] },
    sample: 'select(df, a:c)',
    hints: ['Use : for column range', 'Selects all columns between'],
    tags: ['dplyr', 'select', 'range'],
  },
  {
    id: 'r-dplyr-113',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Distinct Rows',
    text: 'Get unique rows based on the category column.',
    setup:
      'library(dplyr)\ndf <- data.frame(category = c("A", "B", "A", "C", "B"), value = c(1, 2, 3, 4, 5))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(category = c("A", "B", "A", "C", "B"), value = c(1, 2, 3, 4, 5))',
    expected: { category: ['A', 'B', 'C'] },
    sample: 'distinct(df, category)',
    hints: ['Use distinct() from dplyr', 'Keeps first occurrence'],
    tags: ['dplyr', 'distinct', 'unique'],
  },
  {
    id: 'r-dplyr-114',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Slice Rows',
    text: 'Get rows 2 through 4.',
    setup: 'library(dplyr)\ndf <- data.frame(x = 1:6, y = letters[1:6])',
    setupCode: 'library(dplyr)\ndf <- data.frame(x = 1:6, y = letters[1:6])',
    expected: { x: [2, 3, 4], y: ['b', 'c', 'd'] },
    sample: 'slice(df, 2:4)',
    hints: ['Use slice() for row selection', 'Provide row indices'],
    tags: ['dplyr', 'slice', 'rows'],
  },
  {
    id: 'r-dplyr-115',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Top N Rows',
    text: 'Get the top 3 rows by score.',
    setup:
      'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C", "D", "E"), score = c(85, 92, 78, 95, 88))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C", "D", "E"), score = c(85, 92, 78, 95, 88))',
    expected: { name: ['D', 'B', 'E'], score: [95, 92, 88] },
    sample: 'slice_max(df, score, n = 3)',
    hints: ['Use slice_max() from dplyr', 'n specifies how many'],
    tags: ['dplyr', 'slice_max', 'top'],
  },
  {
    id: 'r-dplyr-116',
    category: 'dplyr Verbs',
    difficulty: 'hard',
    title: 'Multiple Aggregations',
    text: 'Calculate mean, min, and max of score for each group.',
    setup:
      'library(dplyr)\ndf <- data.frame(group = c("A", "A", "B", "B"), score = c(80, 90, 70, 85))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(group = c("A", "A", "B", "B"), score = c(80, 90, 70, 85))',
    expected: { group: ['A', 'B'], avg: [85, 77.5], min_score: [80, 70], max_score: [90, 85] },
    sample:
      'df %>% group_by(group) %>% summarize(avg = mean(score), min_score = min(score), max_score = max(score))',
    hints: ['Multiple summaries in one call', 'Separate with commas'],
    tags: ['dplyr', 'summarize', 'multiple'],
  },
  {
    id: 'r-dplyr-117',
    category: 'dplyr Verbs',
    difficulty: 'hard',
    title: 'Mutate with Case When',
    text: 'Create a grade column: A if score >= 90, B if >= 80, else C.',
    setup: 'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C"), score = c(95, 85, 72))',
    setupCode: 'library(dplyr)\ndf <- data.frame(name = c("A", "B", "C"), score = c(95, 85, 72))',
    expected: { name: ['A', 'B', 'C'], score: [95, 85, 72], grade: ['A', 'B', 'C'] },
    sample: 'mutate(df, grade = case_when(score >= 90 ~ "A", score >= 80 ~ "B", TRUE ~ "C"))',
    hints: ['Use case_when() inside mutate()', 'condition ~ value syntax'],
    tags: ['dplyr', 'mutate', 'case_when'],
  },
  {
    id: 'r-dplyr-118',
    category: 'dplyr Verbs',
    difficulty: 'hard',
    title: 'Row Number within Group',
    text: 'Add row numbers within each group.',
    setup:
      'library(dplyr)\ndf <- data.frame(group = c("A", "A", "B", "B", "B"), value = c(10, 20, 30, 40, 50))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(group = c("A", "A", "B", "B", "B"), value = c(10, 20, 30, 40, 50))',
    expected: {
      group: ['A', 'A', 'B', 'B', 'B'],
      value: [10, 20, 30, 40, 50],
      row_num: [1, 2, 1, 2, 3],
    },
    sample: 'df %>% group_by(group) %>% mutate(row_num = row_number())',
    hints: ['Use row_number() in grouped mutate', 'Resets for each group'],
    tags: ['dplyr', 'row_number', 'grouped'],
  },
  {
    id: 'r-dplyr-119',
    category: 'dplyr Verbs',
    difficulty: 'hard',
    title: 'Lead and Lag',
    text: 'Add a column with the previous value (lag by 1).',
    setup: 'library(dplyr)\ndf <- data.frame(date = 1:5, value = c(10, 15, 12, 18, 20))',
    setupCode: 'library(dplyr)\ndf <- data.frame(date = 1:5, value = c(10, 15, 12, 18, 20))',
    expected: {
      date: [1, 2, 3, 4, 5],
      value: [10, 15, 12, 18, 20],
      prev_value: [null, 10, 15, 12, 18],
    },
    sample: 'mutate(df, prev_value = lag(value))',
    hints: ['Use lag() for previous value', 'First row will be NA'],
    tags: ['dplyr', 'lag', 'window'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 4: tidyr Functions (25 problems)
  // ============================================================
  {
    id: 'r-tidyr-100',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Pivot Longer',
    text: 'Convert wide format to long format using pivot_longer.',
    setup: 'library(tidyr)\ndf <- data.frame(id = 1:2, jan = c(10, 20), feb = c(15, 25))',
    setupCode: 'library(tidyr)\ndf <- data.frame(id = 1:2, jan = c(10, 20), feb = c(15, 25))',
    expected: { id: [1, 1, 2, 2], month: ['jan', 'feb', 'jan', 'feb'], value: [10, 15, 20, 25] },
    sample: 'pivot_longer(df, cols = c(jan, feb), names_to = "month", values_to = "value")',
    hints: ['Use pivot_longer() from tidyr', 'Specify cols, names_to, values_to'],
    tags: ['tidyr', 'pivot_longer', 'reshape'],
  },
  {
    id: 'r-tidyr-101',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Pivot Wider',
    text: 'Convert long format to wide format using pivot_wider.',
    setup:
      'library(tidyr)\ndf <- data.frame(id = c(1, 1, 2, 2), var = c("a", "b", "a", "b"), val = c(10, 20, 30, 40))',
    setupCode:
      'library(tidyr)\ndf <- data.frame(id = c(1, 1, 2, 2), var = c("a", "b", "a", "b"), val = c(10, 20, 30, 40))',
    expected: { id: [1, 2], a: [10, 30], b: [20, 40] },
    sample: 'pivot_wider(df, names_from = var, values_from = val)',
    hints: ['Use pivot_wider() from tidyr', 'Specify names_from and values_from'],
    tags: ['tidyr', 'pivot_wider', 'reshape'],
  },
  {
    id: 'r-tidyr-102',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Separate Column',
    text: 'Split the "name" column into "first" and "last" at the space.',
    setup: 'library(tidyr)\ndf <- data.frame(name = c("John Doe", "Jane Smith"), age = c(30, 25))',
    setupCode:
      'library(tidyr)\ndf <- data.frame(name = c("John Doe", "Jane Smith"), age = c(30, 25))',
    expected: { first: ['John', 'Jane'], last: ['Doe', 'Smith'], age: [30, 25] },
    sample: 'separate(df, name, into = c("first", "last"), sep = " ")',
    hints: ['Use separate() from tidyr', 'Specify column, into, and sep'],
    tags: ['tidyr', 'separate', 'split'],
  },
  {
    id: 'r-tidyr-103',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Unite Columns',
    text: 'Combine "year", "month", "day" into a single "date" column.',
    setup:
      'library(tidyr)\ndf <- data.frame(year = c(2023, 2023), month = c(1, 2), day = c(15, 20))',
    setupCode:
      'library(tidyr)\ndf <- data.frame(year = c(2023, 2023), month = c(1, 2), day = c(15, 20))',
    expected: { date: ['2023-1-15', '2023-2-20'] },
    sample: 'unite(df, "date", year, month, day, sep = "-")',
    hints: ['Use unite() from tidyr', 'Specify new col name and columns to combine'],
    tags: ['tidyr', 'unite', 'combine'],
  },
  {
    id: 'r-tidyr-104',
    category: 'tidyr Functions',
    difficulty: 'easy',
    title: 'Drop NA Rows',
    text: 'Remove rows with any NA values.',
    setup: 'library(tidyr)\ndf <- data.frame(a = c(1, NA, 3), b = c(4, 5, NA))',
    setupCode: 'library(tidyr)\ndf <- data.frame(a = c(1, NA, 3), b = c(4, 5, NA))',
    expected: { a: [1], b: [4] },
    sample: 'drop_na(df)',
    hints: ['Use drop_na() from tidyr', 'Removes rows with any NA'],
    tags: ['tidyr', 'drop_na', 'missing'],
  },
  {
    id: 'r-tidyr-105',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Fill Missing Values',
    text: 'Fill NA values with the previous non-NA value.',
    setup: 'library(tidyr)\ndf <- data.frame(x = c(1, NA, NA, 4, NA))',
    setupCode: 'library(tidyr)\ndf <- data.frame(x = c(1, NA, NA, 4, NA))',
    expected: { x: [1, 1, 1, 4, 4] },
    sample: 'fill(df, x)',
    hints: ['Use fill() from tidyr', 'Default fills downward'],
    tags: ['tidyr', 'fill', 'missing'],
  },
  {
    id: 'r-tidyr-106',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Replace NA with Value',
    text: 'Replace NA values in column x with 0.',
    setup: 'library(tidyr)\ndf <- data.frame(x = c(1, NA, 3, NA, 5))',
    setupCode: 'library(tidyr)\ndf <- data.frame(x = c(1, NA, 3, NA, 5))',
    expected: { x: [1, 0, 3, 0, 5] },
    sample: 'replace_na(df, list(x = 0))',
    hints: ['Use replace_na() from tidyr', 'Provide named list of replacements'],
    tags: ['tidyr', 'replace_na', 'missing'],
  },
  {
    id: 'r-tidyr-107',
    category: 'tidyr Functions',
    difficulty: 'hard',
    title: 'Nest Data',
    text: 'Nest all columns except "group" into a list column called "data".',
    setup:
      'library(tidyr)\ndf <- data.frame(group = c("A", "A", "B"), x = c(1, 2, 3), y = c(4, 5, 6))',
    setupCode:
      'library(tidyr)\ndf <- data.frame(group = c("A", "A", "B"), x = c(1, 2, 3), y = c(4, 5, 6))',
    expected: { group: ['A', 'B'] },
    sample: 'nest(df, data = c(x, y))',
    hints: ['Use nest() from tidyr', 'Creates list column'],
    tags: ['tidyr', 'nest', 'list-column'],
  },
  {
    id: 'r-tidyr-108',
    category: 'tidyr Functions',
    difficulty: 'hard',
    title: 'Unnest Data',
    text: 'Expand the nested list column back to regular columns.',
    setup:
      'library(tidyr)\ndf <- tibble(group = c("A", "B"), data = list(tibble(x = 1:2), tibble(x = 3:4)))',
    setupCode:
      'library(tidyr)\ndf <- tibble(group = c("A", "B"), data = list(tibble(x = 1:2), tibble(x = 3:4)))',
    expected: { group: ['A', 'A', 'B', 'B'], x: [1, 2, 3, 4] },
    sample: 'unnest(df, data)',
    hints: ['Use unnest() from tidyr', 'Expands list column'],
    tags: ['tidyr', 'unnest', 'expand'],
  },
  {
    id: 'r-tidyr-109',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Complete Missing Combinations',
    text: 'Add missing combinations of group and year.',
    setup:
      'library(tidyr)\ndf <- data.frame(group = c("A", "B"), year = c(2020, 2021), value = c(10, 20))',
    setupCode:
      'library(tidyr)\ndf <- data.frame(group = c("A", "B"), year = c(2020, 2021), value = c(10, 20))',
    expected: {
      group: ['A', 'A', 'B', 'B'],
      year: [2020, 2021, 2020, 2021],
      value: [10, null, null, 20],
    },
    sample: 'complete(df, group, year)',
    hints: ['Use complete() from tidyr', 'Creates all combinations'],
    tags: ['tidyr', 'complete', 'combinations'],
  },
  {
    id: 'r-tidyr-110',
    category: 'tidyr Functions',
    difficulty: 'hard',
    title: 'Separate Rows',
    text: 'Split values separated by comma into separate rows.',
    setup: 'library(tidyr)\ndf <- data.frame(id = 1:2, items = c("a,b", "c,d,e"))',
    setupCode: 'library(tidyr)\ndf <- data.frame(id = 1:2, items = c("a,b", "c,d,e"))',
    expected: { id: [1, 1, 2, 2, 2], items: ['a', 'b', 'c', 'd', 'e'] },
    sample: 'separate_rows(df, items, sep = ",")',
    hints: ['Use separate_rows() from tidyr', 'Creates new rows for each value'],
    tags: ['tidyr', 'separate_rows', 'expand'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 5: Apply Functions (30 problems)
  // ============================================================
  {
    id: 'r-apply-100',
    category: 'Apply Functions',
    difficulty: 'easy',
    title: 'Apply to Rows',
    text: 'Calculate the sum of each row in the matrix.',
    setup: 'mat <- matrix(1:9, nrow = 3)',
    setupCode: 'mat <- matrix(1:9, nrow = 3)',
    expected: [12, 15, 18],
    sample: 'apply(mat, 1, sum)',
    hints: ['Use apply() with MARGIN = 1', '1 means apply to rows'],
    tags: ['apply', 'matrix', 'rows'],
  },
  {
    id: 'r-apply-101',
    category: 'Apply Functions',
    difficulty: 'easy',
    title: 'Apply to Columns',
    text: 'Calculate the mean of each column in the matrix.',
    setup: 'mat <- matrix(c(1,2,3,4,5,6), nrow = 2)',
    setupCode: 'mat <- matrix(c(1,2,3,4,5,6), nrow = 2)',
    expected: [1.5, 3.5, 5.5],
    sample: 'apply(mat, 2, mean)',
    hints: ['Use apply() with MARGIN = 2', '2 means apply to columns'],
    tags: ['apply', 'matrix', 'columns'],
  },
  {
    id: 'r-apply-102',
    category: 'Apply Functions',
    difficulty: 'easy',
    title: 'lapply Basic',
    text: 'Apply sqrt to each element of the list.',
    setup: 'nums <- list(a = 4, b = 9, c = 16)',
    setupCode: 'nums <- list(a = 4, b = 9, c = 16)',
    expected: { a: 2, b: 3, c: 4 },
    sample: 'lapply(nums, sqrt)',
    hints: ['Use lapply() for lists', 'Returns a list'],
    tags: ['lapply', 'list', 'function'],
  },
  {
    id: 'r-apply-103',
    category: 'Apply Functions',
    difficulty: 'easy',
    title: 'sapply Basic',
    text: 'Calculate the length of each vector in the list, returning a vector.',
    setup: 'data <- list(x = 1:5, y = 1:10, z = 1:3)',
    setupCode: 'data <- list(x = 1:5, y = 1:10, z = 1:3)',
    expected: { x: 5, y: 10, z: 3 },
    sample: 'sapply(data, length)',
    hints: ['Use sapply() to simplify output', 'Returns vector when possible'],
    tags: ['sapply', 'list', 'simplify'],
  },
  {
    id: 'r-apply-104',
    category: 'Apply Functions',
    difficulty: 'medium',
    title: 'Apply with Custom Function',
    text: 'Calculate the range (max - min) for each row.',
    setup: 'mat <- matrix(c(1,5,2,8,3,7), nrow = 2)',
    setupCode: 'mat <- matrix(c(1,5,2,8,3,7), nrow = 2)',
    expected: [6, 6],
    sample: 'apply(mat, 1, function(x) max(x) - min(x))',
    hints: ['Use anonymous function in apply()', 'function(x) defines inline function'],
    tags: ['apply', 'custom', 'anonymous'],
  },
  {
    id: 'r-apply-105',
    category: 'Apply Functions',
    difficulty: 'medium',
    title: 'mapply for Multiple Arguments',
    text: 'Use mapply to add corresponding elements of two vectors.',
    setup: 'a <- c(1, 2, 3)\nb <- c(10, 20, 30)',
    setupCode: 'a <- c(1, 2, 3)\nb <- c(10, 20, 30)',
    expected: [11, 22, 33],
    sample: 'mapply(function(x, y) x + y, a, b)',
    hints: ['Use mapply() for multiple arguments', 'Function takes multiple params'],
    tags: ['mapply', 'multiple', 'parallel'],
  },
  {
    id: 'r-apply-106',
    category: 'Apply Functions',
    difficulty: 'medium',
    title: 'tapply for Grouped Operations',
    text: 'Calculate the mean of values for each group.',
    setup: 'values <- c(10, 20, 30, 40)\ngroups <- c("A", "A", "B", "B")',
    setupCode: 'values <- c(10, 20, 30, 40)\ngroups <- c("A", "A", "B", "B")',
    expected: { A: 15, B: 35 },
    sample: 'tapply(values, groups, mean)',
    hints: ['Use tapply() for grouped operations', 'Second arg is grouping factor'],
    tags: ['tapply', 'grouped', 'factor'],
  },
  {
    id: 'r-apply-107',
    category: 'Apply Functions',
    difficulty: 'medium',
    title: 'vapply with Type Specification',
    text: 'Use vapply to get lengths, specifying the return type.',
    setup: 'data <- list(a = 1:3, b = 1:5, c = 1:2)',
    setupCode: 'data <- list(a = 1:3, b = 1:5, c = 1:2)',
    expected: { a: 3, b: 5, c: 2 },
    sample: 'vapply(data, length, integer(1))',
    hints: ['Use vapply() for type-safe output', 'Third arg specifies return type'],
    tags: ['vapply', 'type-safe', 'length'],
  },
  {
    id: 'r-apply-108',
    category: 'Apply Functions',
    difficulty: 'medium',
    title: 'lapply with Index',
    text: 'Multiply each element by its index position.',
    setup: 'vals <- list(a = 10, b = 20, c = 30)',
    setupCode: 'vals <- list(a = 10, b = 20, c = 30)',
    expected: { a: 10, b: 40, c: 90 },
    sample: 'mapply(function(x, i) x * i, vals, seq_along(vals))',
    hints: ['Use mapply with seq_along()', 'seq_along gives indices'],
    tags: ['mapply', 'index', 'position'],
  },
  {
    id: 'r-apply-109',
    category: 'Apply Functions',
    difficulty: 'medium',
    title: 'Apply to Data Frame Columns',
    text: 'Calculate the sum of each numeric column.',
    setup: 'df <- data.frame(a = 1:3, b = 4:6, c = 7:9)',
    setupCode: 'df <- data.frame(a = 1:3, b = 4:6, c = 7:9)',
    expected: { a: 6, b: 15, c: 24 },
    sample: 'sapply(df, sum)',
    hints: ['sapply works on data frames', 'Treats each column as element'],
    tags: ['sapply', 'dataframe', 'columns'],
  },
  {
    id: 'r-apply-110',
    category: 'Apply Functions',
    difficulty: 'hard',
    title: 'Nested lapply',
    text: 'Square each element in each vector of the list.',
    setup: 'nested <- list(x = c(1, 2), y = c(3, 4, 5))',
    setupCode: 'nested <- list(x = c(1, 2), y = c(3, 4, 5))',
    expected: { x: [1, 4], y: [9, 16, 25] },
    sample: 'lapply(nested, function(v) v^2)',
    hints: ['Apply function to each vector', 'Vectorized operations work inside'],
    tags: ['lapply', 'nested', 'vectorized'],
  },
  {
    id: 'r-apply-111',
    category: 'Apply Functions',
    difficulty: 'hard',
    title: 'rapply for Recursive Apply',
    text: 'Double all numeric values in a nested list.',
    setup: 'nested <- list(a = 1, b = list(c = 2, d = 3))',
    setupCode: 'nested <- list(a = 1, b = list(c = 2, d = 3))',
    expected: { a: 2, b: { c: 4, d: 6 } },
    sample: 'rapply(nested, function(x) x * 2, how = "replace")',
    hints: ['Use rapply() for nested structures', 'how = "replace" keeps structure'],
    tags: ['rapply', 'recursive', 'nested'],
  },
  {
    id: 'r-apply-112',
    category: 'Apply Functions',
    difficulty: 'hard',
    title: 'Apply with Extra Arguments',
    text: 'Round each column to 1 decimal place.',
    setup: 'df <- data.frame(a = c(1.234, 2.567), b = c(3.891, 4.123))',
    setupCode: 'df <- data.frame(a = c(1.234, 2.567), b = c(3.891, 4.123))',
    expected: { a: [1.2, 2.6], b: [3.9, 4.1] },
    sample: 'sapply(df, round, digits = 1)',
    hints: ['Extra args passed after function', 'digits = 1 for one decimal'],
    tags: ['sapply', 'extra-args', 'round'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 6: String Operations (35 problems)
  // ============================================================
  {
    id: 'r-str-100',
    category: 'String Operations',
    difficulty: 'easy',
    title: 'Paste Without Separator',
    text: 'Concatenate strings without any separator.',
    setup: 'a <- "Hello"\nb <- "World"',
    setupCode: 'a <- "Hello"\nb <- "World"',
    expected: 'HelloWorld',
    sample: 'paste0(a, b)',
    hints: ['Use paste0() for no separator', 'Equivalent to paste(..., sep = "")'],
    tags: ['strings', 'paste0', 'concatenation'],
  },
  {
    id: 'r-str-101',
    category: 'String Operations',
    difficulty: 'easy',
    title: 'Trim Whitespace',
    text: 'Remove leading and trailing whitespace from the string.',
    setup: 'text <- "  hello world  "',
    setupCode: 'text <- "  hello world  "',
    expected: 'hello world',
    sample: 'trimws(text)',
    hints: ['Use trimws() function', 'Removes both leading and trailing'],
    tags: ['strings', 'trimws', 'whitespace'],
  },
  {
    id: 'r-str-102',
    category: 'String Operations',
    difficulty: 'easy',
    title: 'String Contains Check',
    text: 'Check if the string contains "data".',
    setup: 'text <- "data science is fun"',
    setupCode: 'text <- "data science is fun"',
    expected: true,
    sample: 'grepl("data", text)',
    hints: ['Use grepl() for pattern matching', 'Returns TRUE/FALSE'],
    tags: ['strings', 'grepl', 'pattern'],
  },
  {
    id: 'r-str-103',
    category: 'String Operations',
    difficulty: 'easy',
    title: 'Find Pattern Position',
    text: 'Find the starting position of "world" in the string.',
    setup: 'text <- "hello world"',
    setupCode: 'text <- "hello world"',
    expected: 7,
    sample: 'regexpr("world", text)[1]',
    hints: ['Use regexpr() for position', 'Returns match position'],
    tags: ['strings', 'regexpr', 'position'],
  },
  {
    id: 'r-str-104',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'Replace First Occurrence',
    text: 'Replace only the first "a" with "X".',
    setup: 'text <- "banana"',
    setupCode: 'text <- "banana"',
    expected: 'bXnana',
    sample: 'sub("a", "X", text)',
    hints: ['Use sub() for first match only', 'gsub() replaces all'],
    tags: ['strings', 'sub', 'replace'],
  },
  {
    id: 'r-str-105',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'Extract All Matches',
    text: 'Extract all numbers from the string.',
    setup: 'text <- "abc123def456ghi789"',
    setupCode: 'text <- "abc123def456ghi789"',
    expected: [['123', '456', '789']],
    sample: 'regmatches(text, gregexpr("[0-9]+", text))',
    hints: ['Use gregexpr() with regmatches()', 'gregexpr finds all matches'],
    tags: ['strings', 'regex', 'extract'],
  },
  {
    id: 'r-str-106',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'Pad String with Zeros',
    text: 'Pad the number with leading zeros to width 5.',
    setup: 'num <- 42',
    setupCode: 'num <- 42',
    expected: '00042',
    sample: 'sprintf("%05d", num)',
    hints: ['Use sprintf() for formatting', '%05d pads to width 5'],
    tags: ['strings', 'sprintf', 'padding'],
  },
  {
    id: 'r-str-107',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'Format Decimal Places',
    text: 'Format the number to 2 decimal places as a string.',
    setup: 'num <- 3.14159',
    setupCode: 'num <- 3.14159',
    expected: '3.14',
    sample: 'sprintf("%.2f", num)',
    hints: ['Use sprintf() with %.2f', 'f is for floating point'],
    tags: ['strings', 'sprintf', 'format'],
  },
  {
    id: 'r-str-108',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'Repeat String',
    text: 'Repeat the string "ab" three times.',
    setup: 's <- "ab"',
    setupCode: 's <- "ab"',
    expected: 'ababab',
    sample: 'paste(rep(s, 3), collapse = "")',
    hints: ['Use rep() then paste with collapse', 'collapse joins into one string'],
    tags: ['strings', 'rep', 'repeat'],
  },
  {
    id: 'r-str-109',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'Check String Start',
    text: 'Check if the string starts with "Hello".',
    setup: 'text <- "Hello World"',
    setupCode: 'text <- "Hello World"',
    expected: true,
    sample: 'startsWith(text, "Hello")',
    hints: ['Use startsWith() function', 'Returns TRUE/FALSE'],
    tags: ['strings', 'startsWith', 'check'],
  },
  {
    id: 'r-str-110',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'Check String End',
    text: 'Check if the string ends with ".csv".',
    setup: 'filename <- "data.csv"',
    setupCode: 'filename <- "data.csv"',
    expected: true,
    sample: 'endsWith(filename, ".csv")',
    hints: ['Use endsWith() function', 'Returns TRUE/FALSE'],
    tags: ['strings', 'endsWith', 'check'],
  },
  {
    id: 'r-str-111',
    category: 'String Operations',
    difficulty: 'hard',
    title: 'Extract with Regex Groups',
    text: 'Extract the area code from the phone number.',
    setup: 'phone <- "(555) 123-4567"',
    setupCode: 'phone <- "(555) 123-4567"',
    expected: '555',
    sample: 'gsub(".*\\\\(([0-9]+)\\\\).*", "\\\\1", phone)',
    hints: ['Use capturing groups in regex', 'Backreference with \\\\1'],
    tags: ['strings', 'regex', 'groups'],
  },
  {
    id: 'r-str-112',
    category: 'String Operations',
    difficulty: 'hard',
    title: 'Title Case Conversion',
    text: 'Convert the string to title case (first letter of each word capitalized).',
    setup: 'text <- "hello world"',
    setupCode: 'text <- "hello world"',
    expected: 'Hello World',
    sample: 'tools::toTitleCase(text)',
    hints: ['Use tools::toTitleCase()', 'Capitalizes first letter of words'],
    tags: ['strings', 'case', 'title'],
  },
  {
    id: 'r-str-113',
    category: 'String Operations',
    difficulty: 'hard',
    title: 'Reverse String',
    text: 'Reverse the characters in the string.',
    setup: 'text <- "hello"',
    setupCode: 'text <- "hello"',
    expected: 'olleh',
    sample: 'paste(rev(strsplit(text, "")[[1]]), collapse = "")',
    hints: ['Split into characters, reverse, rejoin', 'strsplit with "" splits each char'],
    tags: ['strings', 'reverse', 'manipulation'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 7: Date/Time (30 problems)
  // ============================================================
  {
    id: 'r-date-100',
    category: 'Date/Time',
    difficulty: 'easy',
    title: 'Create Date from String',
    text: 'Convert the string to a Date object.',
    setup: 'date_str <- "2023-06-15"',
    setupCode: 'date_str <- "2023-06-15"',
    expected: '2023-06-15',
    sample: 'as.Date(date_str)',
    hints: ['Use as.Date() function', 'Default format is YYYY-MM-DD'],
    tags: ['date', 'as.Date', 'conversion'],
  },
  {
    id: 'r-date-101',
    category: 'Date/Time',
    difficulty: 'easy',
    title: 'Get Current Date',
    text: "Get today's date.",
    setup: '# Get current date',
    setupCode: '# Get current date',
    expected: 'Date object',
    sample: 'Sys.Date()',
    hints: ['Use Sys.Date() function', 'Returns current system date'],
    tags: ['date', 'Sys.Date', 'current'],
  },
  {
    id: 'r-date-102',
    category: 'Date/Time',
    difficulty: 'easy',
    title: 'Get Current DateTime',
    text: 'Get the current date and time.',
    setup: '# Get current datetime',
    setupCode: '# Get current datetime',
    expected: 'POSIXct object',
    sample: 'Sys.time()',
    hints: ['Use Sys.time() function', 'Returns date and time'],
    tags: ['datetime', 'Sys.time', 'current'],
  },
  {
    id: 'r-date-103',
    category: 'Date/Time',
    difficulty: 'easy',
    title: 'Extract Year',
    text: 'Extract the year from the date.',
    setup: 'date <- as.Date("2023-06-15")',
    setupCode: 'date <- as.Date("2023-06-15")',
    expected: 2023,
    sample: 'as.numeric(format(date, "%Y"))',
    hints: ['Use format() with %Y', 'Or use lubridate::year()'],
    tags: ['date', 'format', 'year'],
  },
  {
    id: 'r-date-104',
    category: 'Date/Time',
    difficulty: 'easy',
    title: 'Extract Month',
    text: 'Extract the month from the date as a number.',
    setup: 'date <- as.Date("2023-06-15")',
    setupCode: 'date <- as.Date("2023-06-15")',
    expected: 6,
    sample: 'as.numeric(format(date, "%m"))',
    hints: ['Use format() with %m', '%m gives zero-padded month'],
    tags: ['date', 'format', 'month'],
  },
  {
    id: 'r-date-105',
    category: 'Date/Time',
    difficulty: 'easy',
    title: 'Extract Day',
    text: 'Extract the day of month from the date.',
    setup: 'date <- as.Date("2023-06-15")',
    setupCode: 'date <- as.Date("2023-06-15")',
    expected: 15,
    sample: 'as.numeric(format(date, "%d"))',
    hints: ['Use format() with %d', '%d gives zero-padded day'],
    tags: ['date', 'format', 'day'],
  },
  {
    id: 'r-date-106',
    category: 'Date/Time',
    difficulty: 'medium',
    title: 'Parse Custom Date Format',
    text: 'Parse the date string with format MM/DD/YYYY.',
    setup: 'date_str <- "06/15/2023"',
    setupCode: 'date_str <- "06/15/2023"',
    expected: '2023-06-15',
    sample: 'as.Date(date_str, format = "%m/%d/%Y")',
    hints: ['Specify format in as.Date()', '%m/%d/%Y for MM/DD/YYYY'],
    tags: ['date', 'format', 'parsing'],
  },
  {
    id: 'r-date-107',
    category: 'Date/Time',
    difficulty: 'medium',
    title: 'Format Date Output',
    text: 'Format the date as "June 15, 2023".',
    setup: 'date <- as.Date("2023-06-15")',
    setupCode: 'date <- as.Date("2023-06-15")',
    expected: 'June 15, 2023',
    sample: 'format(date, "%B %d, %Y")',
    hints: ['Use format() with specifiers', '%B gives full month name'],
    tags: ['date', 'format', 'output'],
  },
  {
    id: 'r-date-108',
    category: 'Date/Time',
    difficulty: 'medium',
    title: 'Add Days to Date',
    text: 'Add 30 days to the date.',
    setup: 'date <- as.Date("2023-06-15")',
    setupCode: 'date <- as.Date("2023-06-15")',
    expected: '2023-07-15',
    sample: 'date + 30',
    hints: ['Simply add number to date', 'Numbers are treated as days'],
    tags: ['date', 'arithmetic', 'days'],
  },
  {
    id: 'r-date-109',
    category: 'Date/Time',
    difficulty: 'medium',
    title: 'Calculate Days Between Dates',
    text: 'Calculate the number of days between two dates.',
    setup: 'date1 <- as.Date("2023-01-01")\ndate2 <- as.Date("2023-12-31")',
    setupCode: 'date1 <- as.Date("2023-01-01")\ndate2 <- as.Date("2023-12-31")',
    expected: 364,
    sample: 'as.numeric(date2 - date1)',
    hints: ['Subtract dates directly', 'Convert to numeric for days'],
    tags: ['date', 'difference', 'days'],
  },
  {
    id: 'r-date-110',
    category: 'Date/Time',
    difficulty: 'medium',
    title: 'Get Day of Week',
    text: 'Get the day of the week name.',
    setup: 'date <- as.Date("2023-06-15")',
    setupCode: 'date <- as.Date("2023-06-15")',
    expected: 'Thursday',
    sample: 'weekdays(date)',
    hints: ['Use weekdays() function', 'Returns full day name'],
    tags: ['date', 'weekdays', 'dayofweek'],
  },
  {
    id: 'r-date-111',
    category: 'Date/Time',
    difficulty: 'medium',
    title: 'Get Month Name',
    text: 'Get the month name from the date.',
    setup: 'date <- as.Date("2023-06-15")',
    setupCode: 'date <- as.Date("2023-06-15")',
    expected: 'June',
    sample: 'months(date)',
    hints: ['Use months() function', 'Returns full month name'],
    tags: ['date', 'months', 'name'],
  },
  {
    id: 'r-date-112',
    category: 'Date/Time',
    difficulty: 'hard',
    title: 'Create Date Sequence',
    text: 'Create a sequence of dates from Jan 1 to Jan 5, 2023.',
    setup: '# Create date sequence',
    setupCode: '# Create date sequence',
    expected: ['2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05'],
    sample: 'seq(as.Date("2023-01-01"), as.Date("2023-01-05"), by = "day")',
    hints: ['Use seq() with Date objects', 'by specifies interval'],
    tags: ['date', 'seq', 'sequence'],
  },
  {
    id: 'r-date-113',
    category: 'Date/Time',
    difficulty: 'hard',
    title: 'Monthly Sequence',
    text: 'Create a sequence of the first day of each month in 2023.',
    setup: '# Create monthly sequence',
    setupCode: '# Create monthly sequence',
    expected: 12,
    sample: 'length(seq(as.Date("2023-01-01"), as.Date("2023-12-01"), by = "month"))',
    hints: ['Use by = "month" in seq()', 'Creates monthly intervals'],
    tags: ['date', 'seq', 'monthly'],
  },
  {
    id: 'r-date-114',
    category: 'Date/Time',
    difficulty: 'hard',
    title: 'Parse DateTime',
    text: 'Parse the datetime string to POSIXct.',
    setup: 'dt_str <- "2023-06-15 14:30:00"',
    setupCode: 'dt_str <- "2023-06-15 14:30:00"',
    expected: 'POSIXct',
    sample: 'as.POSIXct(dt_str)',
    hints: ['Use as.POSIXct() for datetime', 'Includes time component'],
    tags: ['datetime', 'POSIXct', 'parsing'],
  },
  {
    id: 'r-date-115',
    category: 'Date/Time',
    difficulty: 'hard',
    title: 'Extract Hour',
    text: 'Extract the hour from the datetime.',
    setup: 'dt <- as.POSIXct("2023-06-15 14:30:00")',
    setupCode: 'dt <- as.POSIXct("2023-06-15 14:30:00")',
    expected: 14,
    sample: 'as.numeric(format(dt, "%H"))',
    hints: ['Use format() with %H', '%H gives 24-hour format'],
    tags: ['datetime', 'format', 'hour'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 8: List Operations (25 problems)
  // ============================================================
  {
    id: 'r-list-100',
    category: 'List Operations',
    difficulty: 'easy',
    title: 'Get List Length',
    text: 'Get the number of elements in the list.',
    setup: 'my_list <- list(a = 1, b = 2, c = 3, d = 4)',
    setupCode: 'my_list <- list(a = 1, b = 2, c = 3, d = 4)',
    expected: 4,
    sample: 'length(my_list)',
    hints: ['Use length() function', 'Counts top-level elements'],
    tags: ['lists', 'length', 'count'],
  },
  {
    id: 'r-list-101',
    category: 'List Operations',
    difficulty: 'easy',
    title: 'Access by Double Brackets',
    text: 'Extract the second element using [[ ]].',
    setup: 'my_list <- list(10, 20, 30)',
    setupCode: 'my_list <- list(10, 20, 30)',
    expected: 20,
    sample: 'my_list[[2]]',
    hints: ['Use [[ ]] for single element', 'Returns the element itself'],
    tags: ['lists', 'access', 'brackets'],
  },
  {
    id: 'r-list-102',
    category: 'List Operations',
    difficulty: 'easy',
    title: 'Check if Element Exists',
    text: 'Check if "name" exists as a name in the list.',
    setup: 'info <- list(name = "Alice", age = 30)',
    setupCode: 'info <- list(name = "Alice", age = 30)',
    expected: true,
    sample: '"name" %in% names(info)',
    hints: ['Use %in% operator', 'Check against names()'],
    tags: ['lists', 'exists', 'names'],
  },
  {
    id: 'r-list-103',
    category: 'List Operations',
    difficulty: 'medium',
    title: 'Append to List',
    text: 'Add element d = 4 to the list.',
    setup: 'my_list <- list(a = 1, b = 2, c = 3)',
    setupCode: 'my_list <- list(a = 1, b = 2, c = 3)',
    expected: { a: 1, b: 2, c: 3, d: 4 },
    sample: 'c(my_list, list(d = 4))',
    hints: ['Use c() to combine lists', 'Wrap new element in list()'],
    tags: ['lists', 'append', 'combine'],
  },
  {
    id: 'r-list-104',
    category: 'List Operations',
    difficulty: 'medium',
    title: 'Remove List Element',
    text: 'Remove the element named "b" from the list.',
    setup: 'my_list <- list(a = 1, b = 2, c = 3)',
    setupCode: 'my_list <- list(a = 1, b = 2, c = 3)',
    expected: { a: 1, c: 3 },
    sample: 'my_list$b <- NULL; my_list',
    hints: ['Assign NULL to remove', 'Or use negative indexing'],
    tags: ['lists', 'remove', 'null'],
  },
  {
    id: 'r-list-105',
    category: 'List Operations',
    difficulty: 'medium',
    title: 'Flatten List',
    text: 'Flatten the nested list to a single level.',
    setup: 'nested <- list(a = 1, b = list(c = 2, d = 3))',
    setupCode: 'nested <- list(a = 1, b = list(c = 2, d = 3))',
    expected: [1, 2, 3],
    sample: 'unlist(nested)',
    hints: ['Use unlist() function', 'Recursively flattens'],
    tags: ['lists', 'unlist', 'flatten'],
  },
  {
    id: 'r-list-106',
    category: 'List Operations',
    difficulty: 'medium',
    title: 'Convert List to Vector',
    text: 'Convert the list of numbers to a numeric vector.',
    setup: 'num_list <- list(1, 2, 3, 4, 5)',
    setupCode: 'num_list <- list(1, 2, 3, 4, 5)',
    expected: [1, 2, 3, 4, 5],
    sample: 'unlist(num_list)',
    hints: ['Use unlist() for simple lists', 'Returns atomic vector'],
    tags: ['lists', 'unlist', 'vector'],
  },
  {
    id: 'r-list-107',
    category: 'List Operations',
    difficulty: 'hard',
    title: 'Merge Two Lists',
    text: 'Merge two lists, with second list values overwriting on conflicts.',
    setup: 'list1 <- list(a = 1, b = 2)\nlist2 <- list(b = 20, c = 3)',
    setupCode: 'list1 <- list(a = 1, b = 2)\nlist2 <- list(b = 20, c = 3)',
    expected: { a: 1, b: 20, c: 3 },
    sample: 'modifyList(list1, list2)',
    hints: ['Use modifyList() function', 'Second list overwrites first'],
    tags: ['lists', 'merge', 'modifyList'],
  },
  {
    id: 'r-list-108',
    category: 'List Operations',
    difficulty: 'hard',
    title: 'Extract Matching Elements',
    text: 'Extract all elements where value is greater than 5.',
    setup: 'my_list <- list(a = 3, b = 8, c = 2, d = 10)',
    setupCode: 'my_list <- list(a = 3, b = 8, c = 2, d = 10)',
    expected: { b: 8, d: 10 },
    sample: 'my_list[sapply(my_list, function(x) x > 5)]',
    hints: ['Use sapply with logical condition', 'Index list with logical vector'],
    tags: ['lists', 'filter', 'sapply'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 9: Matrix Operations (30 problems)
  // ============================================================
  {
    id: 'r-mat-100',
    category: 'Matrix Operations',
    difficulty: 'easy',
    title: 'Create Matrix from Vector',
    text: 'Create a 2x3 matrix from the values 1 to 6.',
    setup: '# Create a 2x3 matrix',
    setupCode: '# Create a 2x3 matrix',
    expected: [
      [1, 3, 5],
      [2, 4, 6],
    ],
    sample: 'matrix(1:6, nrow = 2)',
    hints: ['Use matrix() function', 'Specify nrow or ncol'],
    tags: ['matrix', 'creation', 'nrow'],
  },
  {
    id: 'r-mat-101',
    category: 'Matrix Operations',
    difficulty: 'easy',
    title: 'Matrix by Row',
    text: 'Create a 2x3 matrix filling by rows instead of columns.',
    setup: '# Create matrix filling by row',
    setupCode: '# Create matrix filling by row',
    expected: [
      [1, 2, 3],
      [4, 5, 6],
    ],
    sample: 'matrix(1:6, nrow = 2, byrow = TRUE)',
    hints: ['Use byrow = TRUE', 'Default fills by column'],
    tags: ['matrix', 'byrow', 'creation'],
  },
  {
    id: 'r-mat-102',
    category: 'Matrix Operations',
    difficulty: 'easy',
    title: 'Get Matrix Dimensions',
    text: 'Get the number of rows and columns in the matrix.',
    setup: 'mat <- matrix(1:12, nrow = 3)',
    setupCode: 'mat <- matrix(1:12, nrow = 3)',
    expected: [3, 4],
    sample: 'dim(mat)',
    hints: ['Use dim() function', 'Returns c(nrow, ncol)'],
    tags: ['matrix', 'dim', 'dimensions'],
  },
  {
    id: 'r-mat-103',
    category: 'Matrix Operations',
    difficulty: 'easy',
    title: 'Access Matrix Element',
    text: 'Get the element in row 2, column 3.',
    setup: 'mat <- matrix(1:9, nrow = 3)',
    setupCode: 'mat <- matrix(1:9, nrow = 3)',
    expected: 8,
    sample: 'mat[2, 3]',
    hints: ['Use [row, col] notation', 'Row first, column second'],
    tags: ['matrix', 'indexing', 'element'],
  },
  {
    id: 'r-mat-104',
    category: 'Matrix Operations',
    difficulty: 'easy',
    title: 'Get Matrix Row',
    text: 'Extract the second row of the matrix.',
    setup: 'mat <- matrix(1:9, nrow = 3)',
    setupCode: 'mat <- matrix(1:9, nrow = 3)',
    expected: [2, 5, 8],
    sample: 'mat[2, ]',
    hints: ['Leave column empty', 'Comma is still required'],
    tags: ['matrix', 'row', 'extraction'],
  },
  {
    id: 'r-mat-105',
    category: 'Matrix Operations',
    difficulty: 'easy',
    title: 'Get Matrix Column',
    text: 'Extract the first column of the matrix.',
    setup: 'mat <- matrix(1:9, nrow = 3)',
    setupCode: 'mat <- matrix(1:9, nrow = 3)',
    expected: [1, 2, 3],
    sample: 'mat[, 1]',
    hints: ['Leave row empty', 'Column index after comma'],
    tags: ['matrix', 'column', 'extraction'],
  },
  {
    id: 'r-mat-106',
    category: 'Matrix Operations',
    difficulty: 'medium',
    title: 'Matrix Transpose',
    text: 'Transpose the matrix (swap rows and columns).',
    setup: 'mat <- matrix(1:6, nrow = 2)',
    setupCode: 'mat <- matrix(1:6, nrow = 2)',
    expected: [
      [1, 2],
      [3, 4],
      [5, 6],
    ],
    sample: 't(mat)',
    hints: ['Use t() function', 'Rows become columns'],
    tags: ['matrix', 'transpose', 't'],
  },
  {
    id: 'r-mat-107',
    category: 'Matrix Operations',
    difficulty: 'medium',
    title: 'Matrix Multiplication',
    text: 'Multiply two matrices using matrix multiplication.',
    setup: 'a <- matrix(1:4, nrow = 2)\nb <- matrix(5:8, nrow = 2)',
    setupCode: 'a <- matrix(1:4, nrow = 2)\nb <- matrix(5:8, nrow = 2)',
    expected: [
      [23, 31],
      [34, 46],
    ],
    sample: 'a %*% b',
    hints: ['Use %*% for matrix multiplication', 'Not * which is element-wise'],
    tags: ['matrix', 'multiplication', 'matmult'],
  },
  {
    id: 'r-mat-108',
    category: 'Matrix Operations',
    difficulty: 'medium',
    title: 'Row Sums',
    text: 'Calculate the sum of each row.',
    setup: 'mat <- matrix(1:9, nrow = 3)',
    setupCode: 'mat <- matrix(1:9, nrow = 3)',
    expected: [12, 15, 18],
    sample: 'rowSums(mat)',
    hints: ['Use rowSums() function', 'More efficient than apply'],
    tags: ['matrix', 'rowSums', 'aggregation'],
  },
  {
    id: 'r-mat-109',
    category: 'Matrix Operations',
    difficulty: 'medium',
    title: 'Column Sums',
    text: 'Calculate the sum of each column.',
    setup: 'mat <- matrix(1:9, nrow = 3)',
    setupCode: 'mat <- matrix(1:9, nrow = 3)',
    expected: [6, 15, 24],
    sample: 'colSums(mat)',
    hints: ['Use colSums() function', 'Returns vector of sums'],
    tags: ['matrix', 'colSums', 'aggregation'],
  },
  {
    id: 'r-mat-110',
    category: 'Matrix Operations',
    difficulty: 'medium',
    title: 'Row Means',
    text: 'Calculate the mean of each row.',
    setup: 'mat <- matrix(1:9, nrow = 3)',
    setupCode: 'mat <- matrix(1:9, nrow = 3)',
    expected: [4, 5, 6],
    sample: 'rowMeans(mat)',
    hints: ['Use rowMeans() function', 'Returns vector of means'],
    tags: ['matrix', 'rowMeans', 'aggregation'],
  },
  {
    id: 'r-mat-111',
    category: 'Matrix Operations',
    difficulty: 'medium',
    title: 'Column Means',
    text: 'Calculate the mean of each column.',
    setup: 'mat <- matrix(1:9, nrow = 3)',
    setupCode: 'mat <- matrix(1:9, nrow = 3)',
    expected: [2, 5, 8],
    sample: 'colMeans(mat)',
    hints: ['Use colMeans() function', 'Returns vector of means'],
    tags: ['matrix', 'colMeans', 'aggregation'],
  },
  {
    id: 'r-mat-112',
    category: 'Matrix Operations',
    difficulty: 'medium',
    title: 'Bind Rows to Matrix',
    text: 'Add a new row to the bottom of the matrix.',
    setup: 'mat <- matrix(1:6, nrow = 2)\nnew_row <- c(7, 8, 9)',
    setupCode: 'mat <- matrix(1:6, nrow = 2)\nnew_row <- c(7, 8, 9)',
    expected: [
      [1, 3, 5],
      [2, 4, 6],
      [7, 8, 9],
    ],
    sample: 'rbind(mat, new_row)',
    hints: ['Use rbind() for row binding', 'Vector becomes new row'],
    tags: ['matrix', 'rbind', 'binding'],
  },
  {
    id: 'r-mat-113',
    category: 'Matrix Operations',
    difficulty: 'medium',
    title: 'Bind Columns to Matrix',
    text: 'Add a new column to the right of the matrix.',
    setup: 'mat <- matrix(1:6, nrow = 3)\nnew_col <- c(7, 8, 9)',
    setupCode: 'mat <- matrix(1:6, nrow = 3)\nnew_col <- c(7, 8, 9)',
    expected: [
      [1, 4, 7],
      [2, 5, 8],
      [3, 6, 9],
    ],
    sample: 'cbind(mat, new_col)',
    hints: ['Use cbind() for column binding', 'Vector becomes new column'],
    tags: ['matrix', 'cbind', 'binding'],
  },
  {
    id: 'r-mat-114',
    category: 'Matrix Operations',
    difficulty: 'hard',
    title: 'Matrix Inverse',
    text: 'Calculate the inverse of the matrix.',
    setup: 'mat <- matrix(c(4, 7, 2, 6), nrow = 2)',
    setupCode: 'mat <- matrix(c(4, 7, 2, 6), nrow = 2)',
    expected: [
      [0.6, -0.2],
      [-0.7, 0.4],
    ],
    sample: 'solve(mat)',
    hints: ['Use solve() function', 'Matrix must be square and invertible'],
    tags: ['matrix', 'solve', 'inverse'],
  },
  {
    id: 'r-mat-115',
    category: 'Matrix Operations',
    difficulty: 'hard',
    title: 'Matrix Determinant',
    text: 'Calculate the determinant of the matrix.',
    setup: 'mat <- matrix(c(1, 2, 3, 4), nrow = 2)',
    setupCode: 'mat <- matrix(c(1, 2, 3, 4), nrow = 2)',
    expected: -2,
    sample: 'det(mat)',
    hints: ['Use det() function', 'Matrix must be square'],
    tags: ['matrix', 'det', 'determinant'],
  },
  {
    id: 'r-mat-116',
    category: 'Matrix Operations',
    difficulty: 'hard',
    title: 'Diagonal Elements',
    text: 'Extract the diagonal elements of the matrix.',
    setup: 'mat <- matrix(1:9, nrow = 3)',
    setupCode: 'mat <- matrix(1:9, nrow = 3)',
    expected: [1, 5, 9],
    sample: 'diag(mat)',
    hints: ['Use diag() function', 'Extracts main diagonal'],
    tags: ['matrix', 'diag', 'diagonal'],
  },
  {
    id: 'r-mat-117',
    category: 'Matrix Operations',
    difficulty: 'hard',
    title: 'Create Identity Matrix',
    text: 'Create a 3x3 identity matrix.',
    setup: '# Create identity matrix',
    setupCode: '# Create identity matrix',
    expected: [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1],
    ],
    sample: 'diag(3)',
    hints: ['Use diag() with single number', 'Creates identity matrix of that size'],
    tags: ['matrix', 'diag', 'identity'],
  },
  {
    id: 'r-mat-118',
    category: 'Matrix Operations',
    difficulty: 'hard',
    title: 'Solve Linear System',
    text: 'Solve the system Ax = b for x.',
    setup: 'A <- matrix(c(3, 1, 2, 4), nrow = 2)\nb <- c(5, 11)',
    setupCode: 'A <- matrix(c(3, 1, 2, 4), nrow = 2)\nb <- c(5, 11)',
    expected: [1, 2],
    sample: 'solve(A, b)',
    hints: ['Use solve(A, b)', 'Solves Ax = b for x'],
    tags: ['matrix', 'solve', 'linear'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 10: Statistical Functions (35 problems)
  // ============================================================
  {
    id: 'r-stat-100',
    category: 'Statistical Functions',
    difficulty: 'easy',
    title: 'Calculate Mean',
    text: 'Calculate the arithmetic mean of the vector.',
    setup: 'data <- c(10, 20, 30, 40, 50)',
    setupCode: 'data <- c(10, 20, 30, 40, 50)',
    expected: 30,
    sample: 'mean(data)',
    hints: ['Use mean() function', 'Sum divided by count'],
    tags: ['statistics', 'mean', 'average'],
  },
  {
    id: 'r-stat-101',
    category: 'Statistical Functions',
    difficulty: 'easy',
    title: 'Calculate Median',
    text: 'Find the median value.',
    setup: 'data <- c(1, 3, 5, 7, 9)',
    setupCode: 'data <- c(1, 3, 5, 7, 9)',
    expected: 5,
    sample: 'median(data)',
    hints: ['Use median() function', 'Middle value when sorted'],
    tags: ['statistics', 'median', 'central'],
  },
  {
    id: 'r-stat-102',
    category: 'Statistical Functions',
    difficulty: 'easy',
    title: 'Calculate Standard Deviation',
    text: 'Calculate the standard deviation.',
    setup: 'data <- c(2, 4, 4, 4, 5, 5, 7, 9)',
    setupCode: 'data <- c(2, 4, 4, 4, 5, 5, 7, 9)',
    expected: 2,
    sample: 'sd(data)',
    hints: ['Use sd() function', 'Sample standard deviation'],
    tags: ['statistics', 'sd', 'spread'],
  },
  {
    id: 'r-stat-103',
    category: 'Statistical Functions',
    difficulty: 'easy',
    title: 'Calculate Variance',
    text: 'Calculate the variance.',
    setup: 'data <- c(2, 4, 4, 4, 5, 5, 7, 9)',
    setupCode: 'data <- c(2, 4, 4, 4, 5, 5, 7, 9)',
    expected: 4,
    sample: 'var(data)',
    hints: ['Use var() function', 'sd squared'],
    tags: ['statistics', 'var', 'spread'],
  },
  {
    id: 'r-stat-104',
    category: 'Statistical Functions',
    difficulty: 'easy',
    title: 'Summary Statistics',
    text: 'Get a summary of the vector (min, quartiles, max, mean).',
    setup: 'data <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)',
    setupCode: 'data <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)',
    expected: 'summary object',
    sample: 'summary(data)',
    hints: ['Use summary() function', 'Returns 6-number summary'],
    tags: ['statistics', 'summary', 'descriptive'],
  },
  {
    id: 'r-stat-105',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Calculate Correlation',
    text: 'Calculate the Pearson correlation between two vectors.',
    setup: 'x <- c(1, 2, 3, 4, 5)\ny <- c(2, 4, 5, 4, 5)',
    setupCode: 'x <- c(1, 2, 3, 4, 5)\ny <- c(2, 4, 5, 4, 5)',
    expected: 0.83,
    sample: 'round(cor(x, y), 2)',
    hints: ['Use cor() function', 'Returns Pearson correlation'],
    tags: ['statistics', 'cor', 'correlation'],
  },
  {
    id: 'r-stat-106',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Correlation Matrix',
    text: 'Calculate the correlation matrix for the data frame.',
    setup: 'df <- data.frame(a = c(1, 2, 3), b = c(4, 5, 6), c = c(7, 8, 9))',
    setupCode: 'df <- data.frame(a = c(1, 2, 3), b = c(4, 5, 6), c = c(7, 8, 9))',
    expected: 'correlation matrix',
    sample: 'cor(df)',
    hints: ['Use cor() on data frame', 'Returns matrix of correlations'],
    tags: ['statistics', 'cor', 'matrix'],
  },
  {
    id: 'r-stat-107',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Calculate Covariance',
    text: 'Calculate the covariance between two vectors.',
    setup: 'x <- c(1, 2, 3, 4, 5)\ny <- c(5, 4, 3, 2, 1)',
    setupCode: 'x <- c(1, 2, 3, 4, 5)\ny <- c(5, 4, 3, 2, 1)',
    expected: -2.5,
    sample: 'cov(x, y)',
    hints: ['Use cov() function', 'Measures co-variation'],
    tags: ['statistics', 'cov', 'covariance'],
  },
  {
    id: 'r-stat-108',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'T-Test',
    text: 'Perform a one-sample t-test against mean = 0.',
    setup: 'data <- c(1.5, 2.0, 1.8, 2.2, 1.9)',
    setupCode: 'data <- c(1.5, 2.0, 1.8, 2.2, 1.9)',
    expected: 'htest object',
    sample: 't.test(data)',
    hints: ['Use t.test() function', 'Default tests against 0'],
    tags: ['statistics', 't.test', 'hypothesis'],
  },
  {
    id: 'r-stat-109',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Two-Sample T-Test',
    text: 'Perform a two-sample t-test.',
    setup: 'group1 <- c(5, 6, 7, 8, 9)\ngroup2 <- c(3, 4, 5, 6, 7)',
    setupCode: 'group1 <- c(5, 6, 7, 8, 9)\ngroup2 <- c(3, 4, 5, 6, 7)',
    expected: 'htest object',
    sample: 't.test(group1, group2)',
    hints: ['Provide two vectors', 'Tests if means differ'],
    tags: ['statistics', 't.test', 'two-sample'],
  },
  {
    id: 'r-stat-110',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Chi-Square Test',
    text: 'Perform a chi-square test on the contingency table.',
    setup: 'table <- matrix(c(10, 20, 30, 40), nrow = 2)',
    setupCode: 'table <- matrix(c(10, 20, 30, 40), nrow = 2)',
    expected: 'htest object',
    sample: 'chisq.test(table)',
    hints: ['Use chisq.test() function', 'Tests independence'],
    tags: ['statistics', 'chisq.test', 'chi-square'],
  },
  {
    id: 'r-stat-111',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Normal Distribution Quantile',
    text: 'Find the 95th percentile of a standard normal distribution.',
    setup: '# Find 95th percentile of N(0,1)',
    setupCode: '# Find 95th percentile of N(0,1)',
    expected: 1.64,
    sample: 'round(qnorm(0.95), 2)',
    hints: ['Use qnorm() for quantiles', 'Standard normal is default'],
    tags: ['statistics', 'qnorm', 'quantile'],
  },
  {
    id: 'r-stat-112',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Normal Distribution Probability',
    text: 'Find P(X <= 1.96) for standard normal.',
    setup: '# Find probability',
    setupCode: '# Find probability',
    expected: 0.975,
    sample: 'round(pnorm(1.96), 3)',
    hints: ['Use pnorm() for CDF', 'Returns cumulative probability'],
    tags: ['statistics', 'pnorm', 'probability'],
  },
  {
    id: 'r-stat-113',
    category: 'Statistical Functions',
    difficulty: 'hard',
    title: 'Linear Regression',
    text: 'Fit a linear regression model.',
    setup: 'x <- c(1, 2, 3, 4, 5)\ny <- c(2.1, 3.9, 6.2, 7.8, 10.1)',
    setupCode: 'x <- c(1, 2, 3, 4, 5)\ny <- c(2.1, 3.9, 6.2, 7.8, 10.1)',
    expected: 'lm object',
    sample: 'lm(y ~ x)',
    hints: ['Use lm() function', 'Formula: y ~ x'],
    tags: ['statistics', 'lm', 'regression'],
  },
  {
    id: 'r-stat-114',
    category: 'Statistical Functions',
    difficulty: 'hard',
    title: 'Get Regression Coefficients',
    text: 'Extract the coefficients from the linear model.',
    setup: 'x <- 1:5\ny <- c(2, 4, 5, 4, 5)\nmodel <- lm(y ~ x)',
    setupCode: 'x <- 1:5\ny <- c(2, 4, 5, 4, 5)\nmodel <- lm(y ~ x)',
    expected: 'named vector',
    sample: 'coef(model)',
    hints: ['Use coef() function', 'Returns intercept and slope'],
    tags: ['statistics', 'coef', 'regression'],
  },
  {
    id: 'r-stat-115',
    category: 'Statistical Functions',
    difficulty: 'hard',
    title: 'R-Squared Value',
    text: 'Get the R-squared from the model summary.',
    setup: 'x <- 1:5\ny <- c(2, 4, 5, 4, 5)\nmodel <- lm(y ~ x)',
    setupCode: 'x <- 1:5\ny <- c(2, 4, 5, 4, 5)\nmodel <- lm(y ~ x)',
    expected: 'numeric',
    sample: 'summary(model)$r.squared',
    hints: ['Use summary() then $r.squared', 'Proportion of variance explained'],
    tags: ['statistics', 'r.squared', 'regression'],
  },
  {
    id: 'r-stat-116',
    category: 'Statistical Functions',
    difficulty: 'hard',
    title: 'ANOVA',
    text: 'Perform one-way ANOVA.',
    setup:
      'values <- c(5, 6, 7, 10, 11, 12, 15, 16, 17)\ngroups <- factor(rep(c("A", "B", "C"), each = 3))',
    setupCode:
      'values <- c(5, 6, 7, 10, 11, 12, 15, 16, 17)\ngroups <- factor(rep(c("A", "B", "C"), each = 3))',
    expected: 'anova object',
    sample: 'anova(lm(values ~ groups))',
    hints: ['Use anova() on lm model', 'Or use aov() function'],
    tags: ['statistics', 'anova', 'hypothesis'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 11: ggplot2 (35 problems)
  // ============================================================
  {
    id: 'r-ggplot-100',
    category: 'ggplot2',
    difficulty: 'easy',
    title: 'Basic Scatter Plot',
    text: 'Create a basic scatter plot of x vs y.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = c(2, 4, 3, 5, 4))',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = c(2, 4, 3, 5, 4))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x = x, y = y)) + geom_point()',
    hints: ['Use ggplot() with aes()', 'Add geom_point() for scatter'],
    tags: ['ggplot2', 'geom_point', 'scatter'],
  },
  {
    id: 'r-ggplot-101',
    category: 'ggplot2',
    difficulty: 'easy',
    title: 'Line Plot',
    text: 'Create a line plot connecting the points.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = c(1, 3, 2, 4, 3))',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = c(1, 3, 2, 4, 3))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x = x, y = y)) + geom_line()',
    hints: ['Use geom_line()', 'Connects points in order'],
    tags: ['ggplot2', 'geom_line', 'line'],
  },
  {
    id: 'r-ggplot-102',
    category: 'ggplot2',
    difficulty: 'easy',
    title: 'Bar Plot',
    text: 'Create a bar plot of the categories.',
    setup: 'library(ggplot2)\ndf <- data.frame(category = c("A", "B", "C"), count = c(10, 20, 15))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(category = c("A", "B", "C"), count = c(10, 20, 15))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x = category, y = count)) + geom_bar(stat = "identity")',
    hints: ['Use geom_bar() with stat = "identity"', 'For pre-computed values'],
    tags: ['ggplot2', 'geom_bar', 'bar'],
  },
  {
    id: 'r-ggplot-103',
    category: 'ggplot2',
    difficulty: 'easy',
    title: 'Histogram',
    text: 'Create a histogram of the values.',
    setup: 'library(ggplot2)\ndf <- data.frame(value = rnorm(100))',
    setupCode: 'library(ggplot2)\ndf <- data.frame(value = rnorm(100))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x = value)) + geom_histogram()',
    hints: ['Use geom_histogram()', 'Only needs x aesthetic'],
    tags: ['ggplot2', 'geom_histogram', 'distribution'],
  },
  {
    id: 'r-ggplot-104',
    category: 'ggplot2',
    difficulty: 'easy',
    title: 'Box Plot',
    text: 'Create a box plot for each group.',
    setup:
      'library(ggplot2)\ndf <- data.frame(group = rep(c("A", "B"), each = 10), value = rnorm(20))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(group = rep(c("A", "B"), each = 10), value = rnorm(20))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x = group, y = value)) + geom_boxplot()',
    hints: ['Use geom_boxplot()', 'x is categorical, y is numeric'],
    tags: ['ggplot2', 'geom_boxplot', 'distribution'],
  },
  {
    id: 'r-ggplot-105',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Color by Group',
    text: 'Color points by the group variable.',
    setup:
      'library(ggplot2)\ndf <- data.frame(x = 1:6, y = c(1, 2, 3, 2, 3, 4), group = c("A", "A", "A", "B", "B", "B"))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(x = 1:6, y = c(1, 2, 3, 2, 3, 4), group = c("A", "A", "A", "B", "B", "B"))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x = x, y = y, color = group)) + geom_point()',
    hints: ['Add color = group in aes()', 'Automatic legend created'],
    tags: ['ggplot2', 'color', 'group'],
  },
  {
    id: 'r-ggplot-106',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Add Title',
    text: 'Add a title to the plot.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = 1:5)',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = 1:5)',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y)) + geom_point() + ggtitle("My Plot")',
    hints: ['Use ggtitle()', 'Or labs(title = "...")'],
    tags: ['ggplot2', 'ggtitle', 'labels'],
  },
  {
    id: 'r-ggplot-107',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Axis Labels',
    text: 'Add custom axis labels.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = 1:5)',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = 1:5)',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y)) + geom_point() + xlab("X Axis") + ylab("Y Axis")',
    hints: ['Use xlab() and ylab()', 'Or labs(x = "...", y = "...")'],
    tags: ['ggplot2', 'labels', 'axes'],
  },
  {
    id: 'r-ggplot-108',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Change Point Size',
    text: 'Increase the size of points to 3.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = 1:5)',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = 1:5)',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y)) + geom_point(size = 3)',
    hints: ['Set size inside geom_point()', 'Not in aes() for fixed size'],
    tags: ['ggplot2', 'size', 'geom_point'],
  },
  {
    id: 'r-ggplot-109',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Facet Wrap',
    text: 'Create separate panels for each group.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:6, y = 1:6, group = rep(c("A", "B"), 3))',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = 1:6, y = 1:6, group = rep(c("A", "B"), 3))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y)) + geom_point() + facet_wrap(~ group)',
    hints: ['Use facet_wrap(~ variable)', 'Creates separate panels'],
    tags: ['ggplot2', 'facet_wrap', 'panels'],
  },
  {
    id: 'r-ggplot-110',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Change Theme',
    text: 'Apply a minimal theme to the plot.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = 1:5)',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = 1:5, y = 1:5)',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y)) + geom_point() + theme_minimal()',
    hints: ['Add theme_minimal()', 'Other options: theme_bw(), theme_classic()'],
    tags: ['ggplot2', 'theme', 'style'],
  },
  {
    id: 'r-ggplot-111',
    category: 'ggplot2',
    difficulty: 'hard',
    title: 'Add Trend Line',
    text: 'Add a linear trend line to the scatter plot.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:10, y = c(2, 4, 3, 5, 6, 5, 7, 8, 7, 9))',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = 1:10, y = c(2, 4, 3, 5, 6, 5, 7, 8, 7, 9))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y)) + geom_point() + geom_smooth(method = "lm")',
    hints: ['Use geom_smooth(method = "lm")', 'Adds linear regression line'],
    tags: ['ggplot2', 'geom_smooth', 'trend'],
  },
  {
    id: 'r-ggplot-112',
    category: 'ggplot2',
    difficulty: 'hard',
    title: 'Flip Coordinates',
    text: 'Flip the x and y axes of a bar plot.',
    setup: 'library(ggplot2)\ndf <- data.frame(category = c("A", "B", "C"), value = c(10, 20, 15))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(category = c("A", "B", "C"), value = c(10, 20, 15))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(category, value)) + geom_bar(stat = "identity") + coord_flip()',
    hints: ['Add coord_flip()', 'Creates horizontal bars'],
    tags: ['ggplot2', 'coord_flip', 'horizontal'],
  },
  {
    id: 'r-ggplot-113',
    category: 'ggplot2',
    difficulty: 'hard',
    title: 'Custom Colors',
    text: 'Set custom colors for the groups.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:4, y = 1:4, group = c("A", "A", "B", "B"))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(x = 1:4, y = 1:4, group = c("A", "A", "B", "B"))',
    expected: 'ggplot object',
    sample:
      'ggplot(df, aes(x, y, color = group)) + geom_point() + scale_color_manual(values = c("red", "blue"))',
    hints: ['Use scale_color_manual()', 'Specify values as vector'],
    tags: ['ggplot2', 'scale_color', 'manual'],
  },
  {
    id: 'r-ggplot-114',
    category: 'ggplot2',
    difficulty: 'hard',
    title: 'Facet Grid',
    text: 'Create a grid of panels by two variables.',
    setup:
      'library(ggplot2)\ndf <- data.frame(x = 1:8, y = 1:8, row_var = rep(c("R1", "R2"), 4), col_var = rep(c("C1", "C2"), each = 4))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(x = 1:8, y = 1:8, row_var = rep(c("R1", "R2"), 4), col_var = rep(c("C1", "C2"), each = 4))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y)) + geom_point() + facet_grid(row_var ~ col_var)',
    hints: ['Use facet_grid(row ~ col)', 'Creates matrix of panels'],
    tags: ['ggplot2', 'facet_grid', 'panels'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 12: purrr (30 problems)
  // ============================================================
  {
    id: 'r-purrr-100',
    category: 'purrr',
    difficulty: 'easy',
    title: 'Map Basic',
    text: 'Use map to square each element in the list.',
    setup: 'library(purrr)\nnums <- list(1, 2, 3, 4)',
    setupCode: 'library(purrr)\nnums <- list(1, 2, 3, 4)',
    expected: [[1], [4], [9], [16]],
    sample: 'map(nums, ~ .x^2)',
    hints: ['Use map() from purrr', '~ .x creates anonymous function'],
    tags: ['purrr', 'map', 'basic'],
  },
  {
    id: 'r-purrr-101',
    category: 'purrr',
    difficulty: 'easy',
    title: 'Map to Double',
    text: 'Use map_dbl to return a numeric vector.',
    setup: 'library(purrr)\nnums <- list(1, 2, 3, 4)',
    setupCode: 'library(purrr)\nnums <- list(1, 2, 3, 4)',
    expected: [1, 4, 9, 16],
    sample: 'map_dbl(nums, ~ .x^2)',
    hints: ['Use map_dbl() for numeric vector', 'Returns atomic vector'],
    tags: ['purrr', 'map_dbl', 'typed'],
  },
  {
    id: 'r-purrr-102',
    category: 'purrr',
    difficulty: 'easy',
    title: 'Map to Character',
    text: 'Use map_chr to convert numbers to strings.',
    setup: 'library(purrr)\nnums <- list(1, 2, 3)',
    setupCode: 'library(purrr)\nnums <- list(1, 2, 3)',
    expected: ['1', '2', '3'],
    sample: 'map_chr(nums, as.character)',
    hints: ['Use map_chr() for character vector', 'Pass function directly'],
    tags: ['purrr', 'map_chr', 'typed'],
  },
  {
    id: 'r-purrr-103',
    category: 'purrr',
    difficulty: 'easy',
    title: 'Map to Logical',
    text: 'Use map_lgl to check if each number is even.',
    setup: 'library(purrr)\nnums <- list(1, 2, 3, 4)',
    setupCode: 'library(purrr)\nnums <- list(1, 2, 3, 4)',
    expected: [false, true, false, true],
    sample: 'map_lgl(nums, ~ .x %% 2 == 0)',
    hints: ['Use map_lgl() for logical vector', '%% 2 == 0 checks even'],
    tags: ['purrr', 'map_lgl', 'typed'],
  },
  {
    id: 'r-purrr-104',
    category: 'purrr',
    difficulty: 'medium',
    title: 'Map to Data Frame',
    text: 'Use map_df to combine results into a data frame.',
    setup: 'library(purrr)\ndata <- list(list(x = 1, y = 2), list(x = 3, y = 4))',
    setupCode: 'library(purrr)\ndata <- list(list(x = 1, y = 2), list(x = 3, y = 4))',
    expected: { x: [1, 3], y: [2, 4] },
    sample: 'map_df(data, ~ data.frame(x = .x$x, y = .x$y))',
    hints: ['Use map_df() or map_dfr()', 'Combines into data frame'],
    tags: ['purrr', 'map_df', 'dataframe'],
  },
  {
    id: 'r-purrr-105',
    category: 'purrr',
    difficulty: 'medium',
    title: 'Map2 for Two Inputs',
    text: 'Use map2 to add corresponding elements of two lists.',
    setup: 'library(purrr)\na <- list(1, 2, 3)\nb <- list(10, 20, 30)',
    setupCode: 'library(purrr)\na <- list(1, 2, 3)\nb <- list(10, 20, 30)',
    expected: [[11], [22], [33]],
    sample: 'map2(a, b, ~ .x + .y)',
    hints: ['Use map2() for two inputs', '.x and .y for arguments'],
    tags: ['purrr', 'map2', 'parallel'],
  },
  {
    id: 'r-purrr-106',
    category: 'purrr',
    difficulty: 'medium',
    title: 'Pmap for Multiple Inputs',
    text: 'Use pmap to combine three lists element-wise.',
    setup: 'library(purrr)\nargs <- list(a = list(1, 2), b = list(10, 20), c = list(100, 200))',
    setupCode: 'library(purrr)\nargs <- list(a = list(1, 2), b = list(10, 20), c = list(100, 200))',
    expected: [[111], [222]],
    sample: 'pmap(args, ~ ..1 + ..2 + ..3)',
    hints: ['Use pmap() for any number of inputs', '..1, ..2, etc. for arguments'],
    tags: ['purrr', 'pmap', 'multiple'],
  },
  {
    id: 'r-purrr-107',
    category: 'purrr',
    difficulty: 'medium',
    title: 'Keep Elements',
    text: 'Keep only elements greater than 5.',
    setup: 'library(purrr)\nnums <- list(3, 7, 2, 9, 4)',
    setupCode: 'library(purrr)\nnums <- list(3, 7, 2, 9, 4)',
    expected: [[7], [9]],
    sample: 'keep(nums, ~ .x > 5)',
    hints: ['Use keep() to filter', 'Returns elements where predicate is TRUE'],
    tags: ['purrr', 'keep', 'filter'],
  },
  {
    id: 'r-purrr-108',
    category: 'purrr',
    difficulty: 'medium',
    title: 'Discard Elements',
    text: 'Remove elements less than or equal to 5.',
    setup: 'library(purrr)\nnums <- list(3, 7, 2, 9, 4)',
    setupCode: 'library(purrr)\nnums <- list(3, 7, 2, 9, 4)',
    expected: [[7], [9]],
    sample: 'discard(nums, ~ .x <= 5)',
    hints: ['Use discard() to remove', 'Opposite of keep()'],
    tags: ['purrr', 'discard', 'filter'],
  },
  {
    id: 'r-purrr-109',
    category: 'purrr',
    difficulty: 'medium',
    title: 'Reduce with Sum',
    text: 'Use reduce to sum all elements.',
    setup: 'library(purrr)\nnums <- list(1, 2, 3, 4, 5)',
    setupCode: 'library(purrr)\nnums <- list(1, 2, 3, 4, 5)',
    expected: 15,
    sample: 'reduce(nums, `+`)',
    hints: ['Use reduce() with operator', 'Backticks for operators'],
    tags: ['purrr', 'reduce', 'fold'],
  },
  {
    id: 'r-purrr-110',
    category: 'purrr',
    difficulty: 'medium',
    title: 'Accumulate',
    text: 'Use accumulate to get running sums.',
    setup: 'library(purrr)\nnums <- list(1, 2, 3, 4)',
    setupCode: 'library(purrr)\nnums <- list(1, 2, 3, 4)',
    expected: [1, 3, 6, 10],
    sample: 'accumulate(nums, `+`)',
    hints: ['Use accumulate()', 'Like reduce but keeps intermediates'],
    tags: ['purrr', 'accumulate', 'cumulative'],
  },
  {
    id: 'r-purrr-111',
    category: 'purrr',
    difficulty: 'hard',
    title: 'Walk for Side Effects',
    text: 'Use walk to print each element (side effect only).',
    setup: 'library(purrr)\nmsgs <- list("Hello", "World")',
    setupCode: 'library(purrr)\nmsgs <- list("Hello", "World")',
    expected: null,
    sample: 'walk(msgs, print)',
    hints: ['Use walk() for side effects', 'Returns input invisibly'],
    tags: ['purrr', 'walk', 'side-effect'],
  },
  {
    id: 'r-purrr-112',
    category: 'purrr',
    difficulty: 'hard',
    title: 'Pluck Nested Element',
    text: 'Extract a deeply nested element.',
    setup: 'library(purrr)\ndata <- list(a = list(b = list(c = 42)))',
    setupCode: 'library(purrr)\ndata <- list(a = list(b = list(c = 42)))',
    expected: 42,
    sample: 'pluck(data, "a", "b", "c")',
    hints: ['Use pluck() for nested access', 'Chain names or indices'],
    tags: ['purrr', 'pluck', 'nested'],
  },
  {
    id: 'r-purrr-113',
    category: 'purrr',
    difficulty: 'hard',
    title: 'Possibly for Error Handling',
    text: 'Use possibly to handle errors gracefully.',
    setup: 'library(purrr)\nnums <- list(1, "a", 3)',
    setupCode: 'library(purrr)\nnums <- list(1, "a", 3)',
    expected: [1, null, 9],
    sample: 'map(nums, possibly(~ .x^2, otherwise = NULL))',
    hints: ['Use possibly() wrapper', 'otherwise sets default for errors'],
    tags: ['purrr', 'possibly', 'error'],
  },
  {
    id: 'r-purrr-114',
    category: 'purrr',
    difficulty: 'hard',
    title: 'Safely for Error Details',
    text: 'Use safely to capture both results and errors.',
    setup: 'library(purrr)\nnums <- list(1, 0)',
    setupCode: 'library(purrr)\nnums <- list(1, 0)',
    expected: 'list with result and error',
    sample: 'map(nums, safely(~ 10 / .x))',
    hints: ['Use safely() wrapper', 'Returns list with result and error'],
    tags: ['purrr', 'safely', 'error'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 13: Factors (25 problems)
  // ============================================================
  {
    id: 'r-factor-100',
    category: 'Factors',
    difficulty: 'easy',
    title: 'Create Factor',
    text: 'Convert the character vector to a factor.',
    setup: 'sizes <- c("small", "medium", "large", "medium")',
    setupCode: 'sizes <- c("small", "medium", "large", "medium")',
    expected: 'factor',
    sample: 'factor(sizes)',
    hints: ['Use factor() function', 'Creates categorical variable'],
    tags: ['factors', 'factor', 'creation'],
  },
  {
    id: 'r-factor-101',
    category: 'Factors',
    difficulty: 'easy',
    title: 'Get Factor Levels',
    text: 'Get the unique levels of the factor.',
    setup: 'f <- factor(c("a", "b", "a", "c", "b"))',
    setupCode: 'f <- factor(c("a", "b", "a", "c", "b"))',
    expected: ['a', 'b', 'c'],
    sample: 'levels(f)',
    hints: ['Use levels() function', 'Returns unique categories'],
    tags: ['factors', 'levels', 'unique'],
  },
  {
    id: 'r-factor-102',
    category: 'Factors',
    difficulty: 'easy',
    title: 'Count Factor Levels',
    text: 'Count occurrences of each level.',
    setup: 'f <- factor(c("a", "b", "a", "c", "b", "a"))',
    setupCode: 'f <- factor(c("a", "b", "a", "c", "b", "a"))',
    expected: { a: 3, b: 2, c: 1 },
    sample: 'table(f)',
    hints: ['Use table() function', 'Creates frequency table'],
    tags: ['factors', 'table', 'count'],
  },
  {
    id: 'r-factor-103',
    category: 'Factors',
    difficulty: 'medium',
    title: 'Ordered Factor',
    text: 'Create an ordered factor with levels small < medium < large.',
    setup: 'sizes <- c("medium", "small", "large")',
    setupCode: 'sizes <- c("medium", "small", "large")',
    expected: 'ordered factor',
    sample: 'factor(sizes, levels = c("small", "medium", "large"), ordered = TRUE)',
    hints: ['Set ordered = TRUE', 'Specify levels in order'],
    tags: ['factors', 'ordered', 'levels'],
  },
  {
    id: 'r-factor-104',
    category: 'Factors',
    difficulty: 'medium',
    title: 'Reorder Factor Levels',
    text: 'Reorder the levels alphabetically.',
    setup: 'f <- factor(c("c", "a", "b"), levels = c("c", "a", "b"))',
    setupCode: 'f <- factor(c("c", "a", "b"), levels = c("c", "a", "b"))',
    expected: ['a', 'b', 'c'],
    sample: 'levels(factor(f, levels = sort(levels(f))))',
    hints: ['Recreate with sorted levels', 'Or use forcats::fct_relevel()'],
    tags: ['factors', 'reorder', 'levels'],
  },
  {
    id: 'r-factor-105',
    category: 'Factors',
    difficulty: 'medium',
    title: 'Drop Unused Levels',
    text: 'Remove levels that have no occurrences.',
    setup: 'f <- factor(c("a", "b"), levels = c("a", "b", "c"))',
    setupCode: 'f <- factor(c("a", "b"), levels = c("a", "b", "c"))',
    expected: ['a', 'b'],
    sample: 'levels(droplevels(f))',
    hints: ['Use droplevels() function', 'Removes empty levels'],
    tags: ['factors', 'droplevels', 'clean'],
  },
  {
    id: 'r-factor-106',
    category: 'Factors',
    difficulty: 'medium',
    title: 'Convert Factor to Numeric',
    text: 'Convert factor to its underlying integer codes.',
    setup: 'f <- factor(c("low", "high", "medium"))',
    setupCode: 'f <- factor(c("low", "high", "medium"))',
    expected: [2, 1, 3],
    sample: 'as.numeric(f)',
    hints: ['Use as.numeric()', 'Returns integer codes'],
    tags: ['factors', 'as.numeric', 'codes'],
  },
  {
    id: 'r-factor-107',
    category: 'Factors',
    difficulty: 'medium',
    title: 'Convert Factor to Character',
    text: 'Convert factor back to character vector.',
    setup: 'f <- factor(c("apple", "banana", "cherry"))',
    setupCode: 'f <- factor(c("apple", "banana", "cherry"))',
    expected: ['apple', 'banana', 'cherry'],
    sample: 'as.character(f)',
    hints: ['Use as.character()', 'Returns original strings'],
    tags: ['factors', 'as.character', 'convert'],
  },
  {
    id: 'r-factor-108',
    category: 'Factors',
    difficulty: 'hard',
    title: 'Cut into Bins',
    text: 'Cut numeric values into factor bins.',
    setup: 'ages <- c(15, 25, 35, 45, 55)',
    setupCode: 'ages <- c(15, 25, 35, 45, 55)',
    expected: 'factor with bins',
    sample: 'cut(ages, breaks = c(0, 20, 40, 60), labels = c("young", "middle", "senior"))',
    hints: ['Use cut() function', 'breaks define bin edges'],
    tags: ['factors', 'cut', 'bins'],
  },
  {
    id: 'r-factor-109',
    category: 'Factors',
    difficulty: 'hard',
    title: 'Rename Factor Levels',
    text: 'Rename factor levels from a, b, c to A, B, C.',
    setup: 'f <- factor(c("a", "b", "c", "a"))',
    setupCode: 'f <- factor(c("a", "b", "c", "a"))',
    expected: ['A', 'B', 'C'],
    sample: 'levels(f) <- c("A", "B", "C"); levels(f)',
    hints: ['Assign new values to levels()', 'Order must match'],
    tags: ['factors', 'levels', 'rename'],
  },
  {
    id: 'r-factor-110',
    category: 'Factors',
    difficulty: 'hard',
    title: 'Combine Factor Levels',
    text: 'Combine levels "a" and "b" into "ab".',
    setup: 'f <- factor(c("a", "b", "c", "a", "b"))',
    setupCode: 'f <- factor(c("a", "b", "c", "a", "b"))',
    expected: ['ab', 'c'],
    sample: 'levels(f)[levels(f) %in% c("a", "b")] <- "ab"; levels(f)',
    hints: ['Assign same level name to multiple', 'Effectively merges them'],
    tags: ['factors', 'combine', 'levels'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 14: Regular Expressions (30 problems)
  // ============================================================
  {
    id: 'r-regex-100',
    category: 'Regular Expressions',
    difficulty: 'easy',
    title: 'Match Pattern with grep',
    text: 'Find indices of strings containing "cat".',
    setup: 'words <- c("cat", "dog", "catalog", "bird")',
    setupCode: 'words <- c("cat", "dog", "catalog", "bird")',
    expected: [1, 3],
    sample: 'grep("cat", words)',
    hints: ['Use grep() for indices', 'Returns positions of matches'],
    tags: ['regex', 'grep', 'match'],
  },
  {
    id: 'r-regex-101',
    category: 'Regular Expressions',
    difficulty: 'easy',
    title: 'Return Matching Values',
    text: 'Return the actual strings containing "cat".',
    setup: 'words <- c("cat", "dog", "catalog", "bird")',
    setupCode: 'words <- c("cat", "dog", "catalog", "bird")',
    expected: ['cat', 'catalog'],
    sample: 'grep("cat", words, value = TRUE)',
    hints: ['Use value = TRUE in grep()', 'Returns matching strings'],
    tags: ['regex', 'grep', 'value'],
  },
  {
    id: 'r-regex-102',
    category: 'Regular Expressions',
    difficulty: 'easy',
    title: 'Check Pattern Match',
    text: 'Check if each string contains a digit.',
    setup: 'strs <- c("abc", "a1b", "xyz", "123")',
    setupCode: 'strs <- c("abc", "a1b", "xyz", "123")',
    expected: [false, true, false, true],
    sample: 'grepl("[0-9]", strs)',
    hints: ['Use grepl() for logical', '[0-9] matches any digit'],
    tags: ['regex', 'grepl', 'logical'],
  },
  {
    id: 'r-regex-103',
    category: 'Regular Expressions',
    difficulty: 'easy',
    title: 'Replace First Match',
    text: 'Replace first vowel with X.',
    setup: 'text <- "hello world"',
    setupCode: 'text <- "hello world"',
    expected: 'hXllo world',
    sample: 'sub("[aeiou]", "X", text)',
    hints: ['Use sub() for first match', '[aeiou] matches any vowel'],
    tags: ['regex', 'sub', 'replace'],
  },
  {
    id: 'r-regex-104',
    category: 'Regular Expressions',
    difficulty: 'easy',
    title: 'Replace All Matches',
    text: 'Replace all vowels with X.',
    setup: 'text <- "hello world"',
    setupCode: 'text <- "hello world"',
    expected: 'hXllX wXrld',
    sample: 'gsub("[aeiou]", "X", text)',
    hints: ['Use gsub() for all matches', 'g stands for global'],
    tags: ['regex', 'gsub', 'replace'],
  },
  {
    id: 'r-regex-105',
    category: 'Regular Expressions',
    difficulty: 'medium',
    title: 'Match Start of String',
    text: 'Find strings that start with "a".',
    setup: 'words <- c("apple", "banana", "apricot", "cherry")',
    setupCode: 'words <- c("apple", "banana", "apricot", "cherry")',
    expected: ['apple', 'apricot'],
    sample: 'grep("^a", words, value = TRUE)',
    hints: ['Use ^ for start of string', 'Anchor pattern to beginning'],
    tags: ['regex', 'anchor', 'start'],
  },
  {
    id: 'r-regex-106',
    category: 'Regular Expressions',
    difficulty: 'medium',
    title: 'Match End of String',
    text: 'Find strings that end with "ing".',
    setup: 'words <- c("running", "jump", "swimming", "walk")',
    setupCode: 'words <- c("running", "jump", "swimming", "walk")',
    expected: ['running', 'swimming'],
    sample: 'grep("ing$", words, value = TRUE)',
    hints: ['Use $ for end of string', 'Anchor pattern to end'],
    tags: ['regex', 'anchor', 'end'],
  },
  {
    id: 'r-regex-107',
    category: 'Regular Expressions',
    difficulty: 'medium',
    title: 'Match Word Boundary',
    text: 'Find strings containing the whole word "cat".',
    setup: 'phrases <- c("the cat sat", "catalog", "cat", "concatenate")',
    setupCode: 'phrases <- c("the cat sat", "catalog", "cat", "concatenate")',
    expected: ['the cat sat', 'cat'],
    sample: 'grep("\\\\bcat\\\\b", phrases, value = TRUE)',
    hints: ['Use \\\\b for word boundary', 'Matches whole words only'],
    tags: ['regex', 'boundary', 'word'],
  },
  {
    id: 'r-regex-108',
    category: 'Regular Expressions',
    difficulty: 'medium',
    title: 'Match One or More',
    text: 'Match one or more digits.',
    setup: 'text <- "abc123def456"',
    setupCode: 'text <- "abc123def456"',
    expected: [['123', '456']],
    sample: 'regmatches(text, gregexpr("[0-9]+", text))',
    hints: ['Use + for one or more', 'gregexpr finds all matches'],
    tags: ['regex', 'quantifier', 'plus'],
  },
  {
    id: 'r-regex-109',
    category: 'Regular Expressions',
    difficulty: 'medium',
    title: 'Case Insensitive Match',
    text: 'Match "hello" regardless of case.',
    setup: 'texts <- c("Hello", "HELLO", "hello", "HeLLo")',
    setupCode: 'texts <- c("Hello", "HELLO", "hello", "HeLLo")',
    expected: [true, true, true, true],
    sample: 'grepl("hello", texts, ignore.case = TRUE)',
    hints: ['Use ignore.case = TRUE', 'Matches any case combination'],
    tags: ['regex', 'case', 'insensitive'],
  },
  {
    id: 'r-regex-110',
    category: 'Regular Expressions',
    difficulty: 'hard',
    title: 'Capture Groups',
    text: 'Extract the domain from email addresses.',
    setup: 'emails <- c("user@gmail.com", "test@yahoo.com")',
    setupCode: 'emails <- c("user@gmail.com", "test@yahoo.com")',
    expected: ['gmail.com', 'yahoo.com'],
    sample: 'gsub(".*@", "", emails)',
    hints: ['Use gsub to remove before @', '.*@ matches everything up to @'],
    tags: ['regex', 'capture', 'extract'],
  },
  {
    id: 'r-regex-111',
    category: 'Regular Expressions',
    difficulty: 'hard',
    title: 'Validate Email Format',
    text: 'Check if strings are valid email format.',
    setup: 'emails <- c("user@example.com", "invalid", "test@domain.org")',
    setupCode: 'emails <- c("user@example.com", "invalid", "test@domain.org")',
    expected: [true, false, true],
    sample: 'grepl("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,}$", emails)',
    hints: ['Use comprehensive email pattern', 'Check for @ and domain parts'],
    tags: ['regex', 'validation', 'email'],
  },
  {
    id: 'r-regex-112',
    category: 'Regular Expressions',
    difficulty: 'hard',
    title: 'Extract Numbers',
    text: 'Extract all numbers from the string.',
    setup: 'text <- "Order 123 has 45 items for $67.89"',
    setupCode: 'text <- "Order 123 has 45 items for $67.89"',
    expected: ['123', '45', '67', '89'],
    sample: 'unlist(regmatches(text, gregexpr("[0-9]+", text)))',
    hints: ['Use gregexpr with regmatches', 'unlist flattens the result'],
    tags: ['regex', 'extract', 'numbers'],
  },
  {
    id: 'r-regex-113',
    category: 'Regular Expressions',
    difficulty: 'hard',
    title: 'Lookahead Assertion',
    text: 'Match "a" only if followed by "b".',
    setup: 'text <- "ab ac ad ab"',
    setupCode: 'text <- "ab ac ad ab"',
    expected: 2,
    sample: 'length(gregexpr("a(?=b)", text, perl = TRUE)[[1]])',
    hints: ['Use (?=) for lookahead', 'Requires perl = TRUE'],
    tags: ['regex', 'lookahead', 'assertion'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 15: File I/O (25 problems)
  // ============================================================
  {
    id: 'r-fileio-100',
    category: 'File I/O',
    difficulty: 'easy',
    title: 'Read CSV File',
    text: 'Read a CSV file into a data frame.',
    setup: '# Assuming file "data.csv" exists',
    setupCode: '# Assuming file "data.csv" exists',
    expected: 'data.frame',
    sample: 'read.csv("data.csv")',
    hints: ['Use read.csv() function', 'Returns data frame'],
    tags: ['fileio', 'read.csv', 'import'],
  },
  {
    id: 'r-fileio-101',
    category: 'File I/O',
    difficulty: 'easy',
    title: 'Write CSV File',
    text: 'Write a data frame to a CSV file.',
    setup: 'df <- data.frame(x = 1:3, y = c("a", "b", "c"))',
    setupCode: 'df <- data.frame(x = 1:3, y = c("a", "b", "c"))',
    expected: null,
    sample: 'write.csv(df, "output.csv", row.names = FALSE)',
    hints: ['Use write.csv() function', 'row.names = FALSE omits row numbers'],
    tags: ['fileio', 'write.csv', 'export'],
  },
  {
    id: 'r-fileio-102',
    category: 'File I/O',
    difficulty: 'easy',
    title: 'Read CSV Without Header',
    text: 'Read a CSV file that has no header row.',
    setup: '# File without header',
    setupCode: '# File without header',
    expected: 'data.frame',
    sample: 'read.csv("data.csv", header = FALSE)',
    hints: ['Set header = FALSE', 'Columns named V1, V2, etc.'],
    tags: ['fileio', 'read.csv', 'header'],
  },
  {
    id: 'r-fileio-103',
    category: 'File I/O',
    difficulty: 'medium',
    title: 'Read Tab-Delimited File',
    text: 'Read a tab-delimited text file.',
    setup: '# Tab-delimited file',
    setupCode: '# Tab-delimited file',
    expected: 'data.frame',
    sample: 'read.delim("data.txt")',
    hints: ['Use read.delim() for tabs', 'Or read.table(..., sep = "\\t")'],
    tags: ['fileio', 'read.delim', 'tab'],
  },
  {
    id: 'r-fileio-104',
    category: 'File I/O',
    difficulty: 'medium',
    title: 'Save R Object',
    text: 'Save an R object to an RDS file.',
    setup: 'model <- lm(mpg ~ wt, data = mtcars)',
    setupCode: 'model <- lm(mpg ~ wt, data = mtcars)',
    expected: null,
    sample: 'saveRDS(model, "model.rds")',
    hints: ['Use saveRDS() for single object', 'Binary format, preserves structure'],
    tags: ['fileio', 'saveRDS', 'save'],
  },
  {
    id: 'r-fileio-105',
    category: 'File I/O',
    difficulty: 'medium',
    title: 'Load R Object',
    text: 'Load an R object from an RDS file.',
    setup: '# Load previously saved object',
    setupCode: '# Load previously saved object',
    expected: 'R object',
    sample: 'model <- readRDS("model.rds")',
    hints: ['Use readRDS() to load', 'Assign to variable'],
    tags: ['fileio', 'readRDS', 'load'],
  },
  {
    id: 'r-fileio-106',
    category: 'File I/O',
    difficulty: 'medium',
    title: 'Check File Exists',
    text: 'Check if a file exists.',
    setup: 'filename <- "data.csv"',
    setupCode: 'filename <- "data.csv"',
    expected: 'logical',
    sample: 'file.exists(filename)',
    hints: ['Use file.exists() function', 'Returns TRUE or FALSE'],
    tags: ['fileio', 'file.exists', 'check'],
  },
  {
    id: 'r-fileio-107',
    category: 'File I/O',
    difficulty: 'medium',
    title: 'List Files in Directory',
    text: 'List all CSV files in the current directory.',
    setup: '# List CSV files',
    setupCode: '# List CSV files',
    expected: 'character vector',
    sample: 'list.files(pattern = "\\\\.csv$")',
    hints: ['Use list.files() with pattern', 'Regex for .csv extension'],
    tags: ['fileio', 'list.files', 'directory'],
  },
  {
    id: 'r-fileio-108',
    category: 'File I/O',
    difficulty: 'hard',
    title: 'Read Multiple CSV Files',
    text: 'Read all CSV files and combine into one data frame.',
    setup: '# Multiple CSV files in directory',
    setupCode: '# Multiple CSV files in directory',
    expected: 'combined data.frame',
    sample: 'do.call(rbind, lapply(list.files(pattern = "\\\\.csv$"), read.csv))',
    hints: ['Use lapply to read each file', 'do.call(rbind, ...) combines'],
    tags: ['fileio', 'multiple', 'combine'],
  },
  {
    id: 'r-fileio-109',
    category: 'File I/O',
    difficulty: 'hard',
    title: 'Read Excel File',
    text: 'Read an Excel file using readxl package.',
    setup: 'library(readxl)',
    setupCode: 'library(readxl)',
    expected: 'tibble',
    sample: 'read_excel("data.xlsx")',
    hints: ['Use readxl::read_excel()', 'Supports .xlsx and .xls'],
    tags: ['fileio', 'excel', 'readxl'],
  },
  {
    id: 'r-fileio-110',
    category: 'File I/O',
    difficulty: 'hard',
    title: 'Read JSON File',
    text: 'Read a JSON file using jsonlite.',
    setup: 'library(jsonlite)',
    setupCode: 'library(jsonlite)',
    expected: 'R object',
    sample: 'fromJSON("data.json")',
    hints: ['Use jsonlite::fromJSON()', 'Converts JSON to R structure'],
    tags: ['fileio', 'json', 'jsonlite'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 16: Control Flow (30 problems)
  // ============================================================
  {
    id: 'r-control-100',
    category: 'Control Flow',
    difficulty: 'easy',
    title: 'Simple If Statement',
    text: 'Return "positive" if x > 0, else "non-positive".',
    setup: 'x <- 5',
    setupCode: 'x <- 5',
    expected: 'positive',
    sample: 'if (x > 0) "positive" else "non-positive"',
    hints: ['Use if-else statement', 'Condition in parentheses'],
    tags: ['control', 'if', 'condition'],
  },
  {
    id: 'r-control-101',
    category: 'Control Flow',
    difficulty: 'easy',
    title: 'ifelse Vectorized',
    text: 'Return "even" or "odd" for each number.',
    setup: 'nums <- c(1, 2, 3, 4, 5)',
    setupCode: 'nums <- c(1, 2, 3, 4, 5)',
    expected: ['odd', 'even', 'odd', 'even', 'odd'],
    sample: 'ifelse(nums %% 2 == 0, "even", "odd")',
    hints: ['Use ifelse() for vectors', 'Works element-wise'],
    tags: ['control', 'ifelse', 'vectorized'],
  },
  {
    id: 'r-control-102',
    category: 'Control Flow',
    difficulty: 'easy',
    title: 'For Loop',
    text: 'Calculate the sum using a for loop.',
    setup: 'nums <- c(1, 2, 3, 4, 5)',
    setupCode: 'nums <- c(1, 2, 3, 4, 5)',
    expected: 15,
    sample: 'total <- 0; for (n in nums) total <- total + n; total',
    hints: ['Use for (item in vector)', 'Accumulate in variable'],
    tags: ['control', 'for', 'loop'],
  },
  {
    id: 'r-control-103',
    category: 'Control Flow',
    difficulty: 'easy',
    title: 'While Loop',
    text: 'Count down from 5 to 1 using while loop.',
    setup: 'n <- 5\nresult <- c()',
    setupCode: 'n <- 5\nresult <- c()',
    expected: [5, 4, 3, 2, 1],
    sample: 'while (n > 0) { result <- c(result, n); n <- n - 1 }; result',
    hints: ['Use while (condition)', 'Remember to update counter'],
    tags: ['control', 'while', 'loop'],
  },
  {
    id: 'r-control-104',
    category: 'Control Flow',
    difficulty: 'medium',
    title: 'Break Statement',
    text: 'Stop loop when value exceeds 3.',
    setup: 'nums <- 1:10\nresult <- c()',
    setupCode: 'nums <- 1:10\nresult <- c()',
    expected: [1, 2, 3],
    sample: 'for (n in nums) { if (n > 3) break; result <- c(result, n) }; result',
    hints: ['Use break to exit loop', 'Stops iteration entirely'],
    tags: ['control', 'break', 'loop'],
  },
  {
    id: 'r-control-105',
    category: 'Control Flow',
    difficulty: 'medium',
    title: 'Next Statement',
    text: 'Skip even numbers in the loop.',
    setup: 'nums <- 1:6\nresult <- c()',
    setupCode: 'nums <- 1:6\nresult <- c()',
    expected: [1, 3, 5],
    sample: 'for (n in nums) { if (n %% 2 == 0) next; result <- c(result, n) }; result',
    hints: ['Use next to skip iteration', 'Continues to next item'],
    tags: ['control', 'next', 'loop'],
  },
  {
    id: 'r-control-106',
    category: 'Control Flow',
    difficulty: 'medium',
    title: 'Nested If-Else',
    text: 'Categorize score: A >= 90, B >= 80, C >= 70, else F.',
    setup: 'score <- 85',
    setupCode: 'score <- 85',
    expected: 'B',
    sample: 'if (score >= 90) "A" else if (score >= 80) "B" else if (score >= 70) "C" else "F"',
    hints: ['Chain else if statements', 'Order matters'],
    tags: ['control', 'if', 'nested'],
  },
  {
    id: 'r-control-107',
    category: 'Control Flow',
    difficulty: 'medium',
    title: 'Switch Statement',
    text: 'Return day name based on number (1=Mon, 2=Tue, etc.).',
    setup: 'day_num <- 3',
    setupCode: 'day_num <- 3',
    expected: 'Wednesday',
    sample: 'switch(day_num, "Monday", "Tuesday", "Wednesday", "Thursday", "Friday")',
    hints: ['Use switch() for multiple cases', 'Numeric index selects'],
    tags: ['control', 'switch', 'case'],
  },
  {
    id: 'r-control-108',
    category: 'Control Flow',
    difficulty: 'medium',
    title: 'Repeat Loop',
    text: 'Double value until it exceeds 100.',
    setup: 'x <- 1\nsteps <- 0',
    setupCode: 'x <- 1\nsteps <- 0',
    expected: 7,
    sample: 'repeat { x <- x * 2; steps <- steps + 1; if (x > 100) break }; steps',
    hints: ['Use repeat with break', 'Infinite loop needs break'],
    tags: ['control', 'repeat', 'loop'],
  },
  {
    id: 'r-control-109',
    category: 'Control Flow',
    difficulty: 'hard',
    title: 'tryCatch Basic',
    text: 'Handle division by zero error.',
    setup: 'x <- 10\ny <- 0',
    setupCode: 'x <- 10\ny <- 0',
    expected: 'Error: division by zero',
    sample: 'tryCatch(x / y, error = function(e) "Error: division by zero")',
    hints: ['Use tryCatch() for errors', 'error handler is function'],
    tags: ['control', 'tryCatch', 'error'],
  },
  {
    id: 'r-control-110',
    category: 'Control Flow',
    difficulty: 'hard',
    title: 'tryCatch with Warning',
    text: 'Catch warnings from log of negative number.',
    setup: 'x <- -1',
    setupCode: 'x <- -1',
    expected: 'Warning caught',
    sample: 'tryCatch(log(x), warning = function(w) "Warning caught")',
    hints: ['Use warning handler', 'Separate from error handler'],
    tags: ['control', 'tryCatch', 'warning'],
  },
  {
    id: 'r-control-111',
    category: 'Control Flow',
    difficulty: 'hard',
    title: 'tryCatch with Finally',
    text: 'Execute cleanup code regardless of error.',
    setup: 'cleanup_ran <- FALSE',
    setupCode: 'cleanup_ran <- FALSE',
    expected: true,
    sample:
      'tryCatch(stop("error"), error = function(e) NULL, finally = { cleanup_ran <<- TRUE }); cleanup_ran',
    hints: ['Use finally for cleanup', 'Always executes'],
    tags: ['control', 'tryCatch', 'finally'],
  },
  {
    id: 'r-control-112',
    category: 'Control Flow',
    difficulty: 'hard',
    title: 'Custom Error Handling',
    text: 'Create function that returns NA on error.',
    setup: 'safe_div <- function(a, b) tryCatch(a / b, error = function(e) NA)',
    setupCode: 'safe_div <- function(a, b) tryCatch(a / b, error = function(e) NA)',
    expected: 'function',
    sample: 'safe_div(10, 0)',
    hints: ['Wrap operation in tryCatch', 'Return NA on error'],
    tags: ['control', 'error', 'function'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 17: Additional Vector Operations (30 problems)
  // ============================================================
  {
    id: 'r-vec-200',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Sequence with Length',
    text: 'Create a sequence of 5 evenly spaced values from 0 to 1.',
    setup: '# Create sequence from 0 to 1',
    setupCode: '# Create sequence from 0 to 1',
    expected: [0, 0.25, 0.5, 0.75, 1],
    sample: 'seq(0, 1, length.out = 5)',
    hints: ['Use seq() with length.out', 'Specifies number of values'],
    tags: ['vectors', 'seq', 'length'],
  },
  {
    id: 'r-vec-201',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Repeat Pattern',
    text: 'Repeat the pattern c(1, 2, 3) twice.',
    setup: '# Repeat pattern',
    setupCode: '# Repeat pattern',
    expected: [1, 2, 3, 1, 2, 3],
    sample: 'rep(c(1, 2, 3), times = 2)',
    hints: ['Use rep() with times', 'Repeats entire vector'],
    tags: ['vectors', 'rep', 'pattern'],
  },
  {
    id: 'r-vec-202',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Repeat Each Element',
    text: 'Repeat each element of c(1, 2, 3) twice.',
    setup: '# Repeat each element',
    setupCode: '# Repeat each element',
    expected: [1, 1, 2, 2, 3, 3],
    sample: 'rep(c(1, 2, 3), each = 2)',
    hints: ['Use rep() with each', 'Repeats each element'],
    tags: ['vectors', 'rep', 'each'],
  },
  {
    id: 'r-vec-203',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Set Intersection',
    text: 'Find common elements in two vectors.',
    setup: 'a <- c(1, 2, 3, 4, 5)\nb <- c(3, 4, 5, 6, 7)',
    setupCode: 'a <- c(1, 2, 3, 4, 5)\nb <- c(3, 4, 5, 6, 7)',
    expected: [3, 4, 5],
    sample: 'intersect(a, b)',
    hints: ['Use intersect() function', 'Returns common elements'],
    tags: ['vectors', 'intersect', 'sets'],
  },
  {
    id: 'r-vec-204',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Set Union',
    text: 'Combine two vectors keeping unique values.',
    setup: 'a <- c(1, 2, 3)\nb <- c(3, 4, 5)',
    setupCode: 'a <- c(1, 2, 3)\nb <- c(3, 4, 5)',
    expected: [1, 2, 3, 4, 5],
    sample: 'union(a, b)',
    hints: ['Use union() function', 'Combines and removes duplicates'],
    tags: ['vectors', 'union', 'sets'],
  },
  {
    id: 'r-vec-205',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Set Difference',
    text: 'Find elements in a but not in b.',
    setup: 'a <- c(1, 2, 3, 4, 5)\nb <- c(3, 4, 5, 6, 7)',
    setupCode: 'a <- c(1, 2, 3, 4, 5)\nb <- c(3, 4, 5, 6, 7)',
    expected: [1, 2],
    sample: 'setdiff(a, b)',
    hints: ['Use setdiff() function', 'Elements in first not in second'],
    tags: ['vectors', 'setdiff', 'sets'],
  },
  {
    id: 'r-vec-206',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Check Set Equality',
    text: 'Check if two vectors have the same elements.',
    setup: 'a <- c(1, 2, 3)\nb <- c(3, 2, 1)',
    setupCode: 'a <- c(1, 2, 3)\nb <- c(3, 2, 1)',
    expected: true,
    sample: 'setequal(a, b)',
    hints: ['Use setequal() function', 'Ignores order and duplicates'],
    tags: ['vectors', 'setequal', 'sets'],
  },
  {
    id: 'r-vec-207',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Check Element Membership',
    text: 'Check which elements of a are in b.',
    setup: 'a <- c(1, 2, 3, 4, 5)\nb <- c(2, 4, 6)',
    setupCode: 'a <- c(1, 2, 3, 4, 5)\nb <- c(2, 4, 6)',
    expected: [false, true, false, true, false],
    sample: 'a %in% b',
    hints: ['Use %in% operator', 'Returns logical vector'],
    tags: ['vectors', 'in', 'membership'],
  },
  {
    id: 'r-vec-208',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Find Duplicated Elements',
    text: 'Identify which elements are duplicates.',
    setup: 'x <- c(1, 2, 2, 3, 3, 3)',
    setupCode: 'x <- c(1, 2, 2, 3, 3, 3)',
    expected: [false, false, true, false, true, true],
    sample: 'duplicated(x)',
    hints: ['Use duplicated() function', 'TRUE for second and later occurrences'],
    tags: ['vectors', 'duplicated', 'detection'],
  },
  {
    id: 'r-vec-209',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Remove All Duplicates',
    text: 'Keep only elements that appear exactly once.',
    setup: 'x <- c(1, 2, 2, 3, 3, 3, 4)',
    setupCode: 'x <- c(1, 2, 2, 3, 3, 3, 4)',
    expected: [1, 4],
    sample: 'x[!(duplicated(x) | duplicated(x, fromLast = TRUE))]',
    hints: ['Check duplicates from both ends', 'Remove all occurrences'],
    tags: ['vectors', 'duplicated', 'unique'],
  },
  {
    id: 'r-vec-210',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Rolling Mean',
    text: 'Calculate 3-period rolling mean.',
    setup: 'x <- c(1, 2, 3, 4, 5, 6)',
    setupCode: 'x <- c(1, 2, 3, 4, 5, 6)',
    expected: [2, 3, 4, 5],
    sample: 'sapply(1:(length(x)-2), function(i) mean(x[i:(i+2)]))',
    hints: ['Use window of size 3', 'Apply mean to each window'],
    tags: ['vectors', 'rolling', 'mean'],
  },
  {
    id: 'r-vec-211',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Lag Vector',
    text: 'Shift vector values by 2 positions.',
    setup: 'x <- c(1, 2, 3, 4, 5)',
    setupCode: 'x <- c(1, 2, 3, 4, 5)',
    expected: [null, null, 1, 2, 3],
    sample: 'c(rep(NA, 2), head(x, -2))',
    hints: ['Pad with NA at beginning', 'Remove from end'],
    tags: ['vectors', 'lag', 'shift'],
  },
  {
    id: 'r-vec-212',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Lead Vector',
    text: 'Shift vector values backward by 1 position.',
    setup: 'x <- c(1, 2, 3, 4, 5)',
    setupCode: 'x <- c(1, 2, 3, 4, 5)',
    expected: [2, 3, 4, 5, null],
    sample: 'c(tail(x, -1), NA)',
    hints: ['Remove from beginning', 'Pad with NA at end'],
    tags: ['vectors', 'lead', 'shift'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 18: Additional dplyr (30 problems)
  // ============================================================
  {
    id: 'r-dplyr-200',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Select with Helper Functions',
    text: 'Select columns that start with "col".',
    setup: 'library(dplyr)\ndf <- data.frame(col_a = 1, col_b = 2, other = 3)',
    setupCode: 'library(dplyr)\ndf <- data.frame(col_a = 1, col_b = 2, other = 3)',
    expected: { col_a: [1], col_b: [2] },
    sample: 'select(df, starts_with("col"))',
    hints: ['Use starts_with() helper', 'Part of tidyselect'],
    tags: ['dplyr', 'select', 'helpers'],
  },
  {
    id: 'r-dplyr-201',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Select Ends With',
    text: 'Select columns ending with "_id".',
    setup: 'library(dplyr)\ndf <- data.frame(user_id = 1, order_id = 2, name = "A")',
    setupCode: 'library(dplyr)\ndf <- data.frame(user_id = 1, order_id = 2, name = "A")',
    expected: { user_id: [1], order_id: [2] },
    sample: 'select(df, ends_with("_id"))',
    hints: ['Use ends_with() helper', 'Matches column name suffix'],
    tags: ['dplyr', 'select', 'ends_with'],
  },
  {
    id: 'r-dplyr-202',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Select Contains',
    text: 'Select columns containing "val".',
    setup: 'library(dplyr)\ndf <- data.frame(value1 = 1, value2 = 2, name = "A")',
    setupCode: 'library(dplyr)\ndf <- data.frame(value1 = 1, value2 = 2, name = "A")',
    expected: { value1: [1], value2: [2] },
    sample: 'select(df, contains("val"))',
    hints: ['Use contains() helper', 'Matches anywhere in name'],
    tags: ['dplyr', 'select', 'contains'],
  },
  {
    id: 'r-dplyr-203',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Select Numeric Columns',
    text: 'Select only numeric columns.',
    setup: 'library(dplyr)\ndf <- data.frame(a = 1:3, b = c("x", "y", "z"), c = 4:6)',
    setupCode: 'library(dplyr)\ndf <- data.frame(a = 1:3, b = c("x", "y", "z"), c = 4:6)',
    expected: { a: [1, 2, 3], c: [4, 5, 6] },
    sample: 'select(df, where(is.numeric))',
    hints: ['Use where() with predicate', 'is.numeric checks type'],
    tags: ['dplyr', 'select', 'where'],
  },
  {
    id: 'r-dplyr-204',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Relocate Columns',
    text: 'Move column "z" to the first position.',
    setup: 'library(dplyr)\ndf <- data.frame(x = 1, y = 2, z = 3)',
    setupCode: 'library(dplyr)\ndf <- data.frame(x = 1, y = 2, z = 3)',
    expected: { z: [3], x: [1], y: [2] },
    sample: 'relocate(df, z)',
    hints: ['Use relocate() from dplyr', 'Default moves to first'],
    tags: ['dplyr', 'relocate', 'order'],
  },
  {
    id: 'r-dplyr-205',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Rowwise Operations',
    text: 'Calculate row maximum using rowwise.',
    setup: 'library(dplyr)\ndf <- data.frame(a = c(1, 5, 3), b = c(4, 2, 6))',
    setupCode: 'library(dplyr)\ndf <- data.frame(a = c(1, 5, 3), b = c(4, 2, 6))',
    expected: { a: [1, 5, 3], b: [4, 2, 6], max_val: [4, 5, 6] },
    sample: 'df %>% rowwise() %>% mutate(max_val = max(a, b))',
    hints: ['Use rowwise() before mutate', 'Operations apply per row'],
    tags: ['dplyr', 'rowwise', 'row'],
  },
  {
    id: 'r-dplyr-206',
    category: 'dplyr Verbs',
    difficulty: 'medium',
    title: 'Cross Join',
    text: 'Create all combinations of two data frames.',
    setup: 'library(dplyr)\ndf1 <- data.frame(x = 1:2)\ndf2 <- data.frame(y = c("a", "b"))',
    setupCode: 'library(dplyr)\ndf1 <- data.frame(x = 1:2)\ndf2 <- data.frame(y = c("a", "b"))',
    expected: { x: [1, 1, 2, 2], y: ['a', 'b', 'a', 'b'] },
    sample: 'crossing(df1, df2)',
    hints: ['Use crossing() from tidyr', 'Creates Cartesian product'],
    tags: ['dplyr', 'crossing', 'join'],
  },
  {
    id: 'r-dplyr-207',
    category: 'dplyr Verbs',
    difficulty: 'hard',
    title: 'Across Multiple Columns',
    text: 'Apply mean to all numeric columns.',
    setup: 'library(dplyr)\ndf <- data.frame(a = c(1, 2, 3), b = c(4, 5, 6), c = c("x", "y", "z"))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(a = c(1, 2, 3), b = c(4, 5, 6), c = c("x", "y", "z"))',
    expected: { a: 2, b: 5 },
    sample: 'summarize(df, across(where(is.numeric), mean))',
    hints: ['Use across() in summarize', 'Apply function to multiple columns'],
    tags: ['dplyr', 'across', 'multiple'],
  },
  {
    id: 'r-dplyr-208',
    category: 'dplyr Verbs',
    difficulty: 'hard',
    title: 'Across with Multiple Functions',
    text: 'Calculate mean and sd for all numeric columns.',
    setup: 'library(dplyr)\ndf <- data.frame(x = c(1, 2, 3), y = c(4, 5, 6))',
    setupCode: 'library(dplyr)\ndf <- data.frame(x = c(1, 2, 3), y = c(4, 5, 6))',
    expected: 'summary with mean and sd',
    sample: 'summarize(df, across(everything(), list(mean = mean, sd = sd)))',
    hints: ['Pass named list of functions', 'Creates multiple summary columns'],
    tags: ['dplyr', 'across', 'functions'],
  },
  {
    id: 'r-dplyr-209',
    category: 'dplyr Verbs',
    difficulty: 'hard',
    title: 'N Distinct',
    text: 'Count unique values in each group.',
    setup: 'library(dplyr)\ndf <- data.frame(group = c("A", "A", "B"), value = c(1, 1, 2))',
    setupCode: 'library(dplyr)\ndf <- data.frame(group = c("A", "A", "B"), value = c(1, 1, 2))',
    expected: { group: ['A', 'B'], n_unique: [1, 1] },
    sample: 'df %>% group_by(group) %>% summarize(n_unique = n_distinct(value))',
    hints: ['Use n_distinct() function', 'Counts unique values'],
    tags: ['dplyr', 'n_distinct', 'count'],
  },
  {
    id: 'r-dplyr-210',
    category: 'dplyr Verbs',
    difficulty: 'hard',
    title: 'Cumulative Operations in Groups',
    text: 'Calculate cumulative sum within groups.',
    setup: 'library(dplyr)\ndf <- data.frame(group = c("A", "A", "B", "B"), value = c(1, 2, 3, 4))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(group = c("A", "A", "B", "B"), value = c(1, 2, 3, 4))',
    expected: { group: ['A', 'A', 'B', 'B'], value: [1, 2, 3, 4], cum_sum: [1, 3, 3, 7] },
    sample: 'df %>% group_by(group) %>% mutate(cum_sum = cumsum(value))',
    hints: ['Use cumsum() in grouped mutate', 'Resets for each group'],
    tags: ['dplyr', 'cumsum', 'grouped'],
  },
  {
    id: 'r-dplyr-211',
    category: 'dplyr Verbs',
    difficulty: 'hard',
    title: 'Dense Rank',
    text: 'Rank values within groups with no gaps.',
    setup: 'library(dplyr)\ndf <- data.frame(group = c("A", "A", "A"), value = c(10, 30, 10))',
    setupCode: 'library(dplyr)\ndf <- data.frame(group = c("A", "A", "A"), value = c(10, 30, 10))',
    expected: { group: ['A', 'A', 'A'], value: [10, 30, 10], rank: [1, 2, 1] },
    sample: 'df %>% group_by(group) %>% mutate(rank = dense_rank(value))',
    hints: ['Use dense_rank() function', 'No gaps in ranking'],
    tags: ['dplyr', 'dense_rank', 'ranking'],
  },
  {
    id: 'r-dplyr-212',
    category: 'dplyr Verbs',
    difficulty: 'hard',
    title: 'Percent Rank',
    text: 'Calculate percentile rank within groups.',
    setup: 'library(dplyr)\ndf <- data.frame(group = c("A", "A", "A", "A"), value = c(1, 2, 3, 4))',
    setupCode:
      'library(dplyr)\ndf <- data.frame(group = c("A", "A", "A", "A"), value = c(1, 2, 3, 4))',
    expected: { group: ['A', 'A', 'A', 'A'], value: [1, 2, 3, 4], pct: [0, 0.33, 0.67, 1] },
    sample: 'df %>% group_by(group) %>% mutate(pct = round(percent_rank(value), 2))',
    hints: ['Use percent_rank() function', 'Scales from 0 to 1'],
    tags: ['dplyr', 'percent_rank', 'percentile'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 19: Additional tidyr (25 problems)
  // ============================================================
  {
    id: 'r-tidyr-200',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Expand Grid',
    text: 'Create all combinations of year and month.',
    setup: 'library(tidyr)\nyears <- 2020:2021\nmonths <- 1:3',
    setupCode: 'library(tidyr)\nyears <- 2020:2021\nmonths <- 1:3',
    expected: { year: [2020, 2020, 2020, 2021, 2021, 2021], month: [1, 2, 3, 1, 2, 3] },
    sample: 'expand_grid(year = years, month = months)',
    hints: ['Use expand_grid() function', 'Creates all combinations'],
    tags: ['tidyr', 'expand_grid', 'combinations'],
  },
  {
    id: 'r-tidyr-201',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Hoist Nested Data',
    text: 'Extract specific elements from nested lists.',
    setup:
      'library(tidyr)\ndf <- tibble(id = 1:2, data = list(list(a = 1, b = 2), list(a = 3, b = 4)))',
    setupCode:
      'library(tidyr)\ndf <- tibble(id = 1:2, data = list(list(a = 1, b = 2), list(a = 3, b = 4)))',
    expected: { id: [1, 2], a: [1, 3] },
    sample: 'hoist(df, data, a = "a")',
    hints: ['Use hoist() for selective extraction', 'Specify elements to extract'],
    tags: ['tidyr', 'hoist', 'nested'],
  },
  {
    id: 'r-tidyr-202',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Unchop Lists',
    text: 'Expand list column into rows.',
    setup: 'library(tidyr)\ndf <- tibble(id = 1:2, values = list(c(1, 2), c(3, 4, 5)))',
    setupCode: 'library(tidyr)\ndf <- tibble(id = 1:2, values = list(c(1, 2), c(3, 4, 5)))',
    expected: { id: [1, 1, 2, 2, 2], values: [1, 2, 3, 4, 5] },
    sample: 'unchop(df, values)',
    hints: ['Use unchop() for list expansion', 'Similar to unnest'],
    tags: ['tidyr', 'unchop', 'lists'],
  },
  {
    id: 'r-tidyr-203',
    category: 'tidyr Functions',
    difficulty: 'medium',
    title: 'Chop into Lists',
    text: 'Collapse rows into list column.',
    setup: 'library(tidyr)\ndf <- tibble(id = c(1, 1, 2), value = c("a", "b", "c"))',
    setupCode: 'library(tidyr)\ndf <- tibble(id = c(1, 1, 2), value = c("a", "b", "c"))',
    expected: { id: [1, 2] },
    sample: 'chop(df, value)',
    hints: ['Use chop() to create list columns', 'Groups by non-selected columns'],
    tags: ['tidyr', 'chop', 'lists'],
  },
  {
    id: 'r-tidyr-204',
    category: 'tidyr Functions',
    difficulty: 'hard',
    title: 'Pivot Longer with Names Pattern',
    text: 'Pivot with structured column names like "q1_2020".',
    setup: 'library(tidyr)\ndf <- data.frame(id = 1, q1_2020 = 10, q2_2020 = 20)',
    setupCode: 'library(tidyr)\ndf <- data.frame(id = 1, q1_2020 = 10, q2_2020 = 20)',
    expected: { id: [1, 1], quarter: ['q1', 'q2'], year: ['2020', '2020'], value: [10, 20] },
    sample: 'pivot_longer(df, -id, names_pattern = "(.*)_(.*)", names_to = c("quarter", "year"))',
    hints: ['Use names_pattern with regex', 'Capture groups become columns'],
    tags: ['tidyr', 'pivot_longer', 'pattern'],
  },
  {
    id: 'r-tidyr-205',
    category: 'tidyr Functions',
    difficulty: 'hard',
    title: 'Pack Related Columns',
    text: 'Pack related columns into a data frame column.',
    setup: 'library(tidyr)\ndf <- data.frame(id = 1, x1 = 10, x2 = 20, y1 = 30)',
    setupCode: 'library(tidyr)\ndf <- data.frame(id = 1, x1 = 10, x2 = 20, y1 = 30)',
    expected: 'packed data frame',
    sample: 'pack(df, x = starts_with("x"))',
    hints: ['Use pack() to group columns', 'Creates nested data frame column'],
    tags: ['tidyr', 'pack', 'nested'],
  },
  {
    id: 'r-tidyr-206',
    category: 'tidyr Functions',
    difficulty: 'hard',
    title: 'Unpack Columns',
    text: 'Unpack a data frame column into separate columns.',
    setup: 'library(tidyr)\ndf <- tibble(id = 1, data = tibble(a = 10, b = 20))',
    setupCode: 'library(tidyr)\ndf <- tibble(id = 1, data = tibble(a = 10, b = 20))',
    expected: { id: [1], a: [10], b: [20] },
    sample: 'unpack(df, data)',
    hints: ['Use unpack() for nested data frames', 'Expands to regular columns'],
    tags: ['tidyr', 'unpack', 'nested'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 20: Additional String Operations (25 problems)
  // ============================================================
  {
    id: 'r-str-200',
    category: 'String Operations',
    difficulty: 'easy',
    title: 'String Wrap',
    text: 'Wrap long text at 20 characters.',
    setup: 'text <- "This is a very long string that needs wrapping"',
    setupCode: 'text <- "This is a very long string that needs wrapping"',
    expected: 'wrapped text',
    sample: 'strwrap(text, width = 20)',
    hints: ['Use strwrap() function', 'Breaks at word boundaries'],
    tags: ['strings', 'strwrap', 'format'],
  },
  {
    id: 'r-str-201',
    category: 'String Operations',
    difficulty: 'easy',
    title: 'Abbreviate String',
    text: 'Abbreviate string to max 5 characters.',
    setup: 'text <- "California"',
    setupCode: 'text <- "California"',
    expected: 'Clfr',
    sample: 'abbreviate(text, minlength = 5)',
    hints: ['Use abbreviate() function', 'minlength sets minimum'],
    tags: ['strings', 'abbreviate', 'shorten'],
  },
  {
    id: 'r-str-202',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'Format Number as String',
    text: 'Format number with thousands separator.',
    setup: 'num <- 1234567.89',
    setupCode: 'num <- 1234567.89',
    expected: '1,234,567.89',
    sample: 'format(num, big.mark = ",", scientific = FALSE)',
    hints: ['Use format() with big.mark', 'Adds thousands separator'],
    tags: ['strings', 'format', 'number'],
  },
  {
    id: 'r-str-203',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'String Detect with stringr',
    text: 'Check if string contains pattern using stringr.',
    setup: 'library(stringr)\ntext <- "Hello World"',
    setupCode: 'library(stringr)\ntext <- "Hello World"',
    expected: true,
    sample: 'str_detect(text, "World")',
    hints: ['Use str_detect() from stringr', 'Returns TRUE/FALSE'],
    tags: ['strings', 'stringr', 'detect'],
  },
  {
    id: 'r-str-204',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'String Extract',
    text: 'Extract first number from string.',
    setup: 'library(stringr)\ntext <- "Order 123 item"',
    setupCode: 'library(stringr)\ntext <- "Order 123 item"',
    expected: '123',
    sample: 'str_extract(text, "[0-9]+")',
    hints: ['Use str_extract() from stringr', 'Returns first match'],
    tags: ['strings', 'stringr', 'extract'],
  },
  {
    id: 'r-str-205',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'String Extract All',
    text: 'Extract all numbers from string.',
    setup: 'library(stringr)\ntext <- "abc 123 def 456"',
    setupCode: 'library(stringr)\ntext <- "abc 123 def 456"',
    expected: [['123', '456']],
    sample: 'str_extract_all(text, "[0-9]+")',
    hints: ['Use str_extract_all()', 'Returns list of all matches'],
    tags: ['strings', 'stringr', 'extract_all'],
  },
  {
    id: 'r-str-206',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'String Replace with stringr',
    text: 'Replace all spaces with underscores.',
    setup: 'library(stringr)\ntext <- "hello world"',
    setupCode: 'library(stringr)\ntext <- "hello world"',
    expected: 'hello_world',
    sample: 'str_replace_all(text, " ", "_")',
    hints: ['Use str_replace_all()', 'Replaces all occurrences'],
    tags: ['strings', 'stringr', 'replace'],
  },
  {
    id: 'r-str-207',
    category: 'String Operations',
    difficulty: 'hard',
    title: 'String Locate',
    text: 'Find position of pattern in string.',
    setup: 'library(stringr)\ntext <- "hello world"',
    setupCode: 'library(stringr)\ntext <- "hello world"',
    expected: { start: 7, end: 11 },
    sample: 'str_locate(text, "world")',
    hints: ['Use str_locate()', 'Returns start and end positions'],
    tags: ['strings', 'stringr', 'locate'],
  },
  {
    id: 'r-str-208',
    category: 'String Operations',
    difficulty: 'hard',
    title: 'String Pad',
    text: 'Pad string to width 10 with zeros on left.',
    setup: 'library(stringr)\ntext <- "42"',
    setupCode: 'library(stringr)\ntext <- "42"',
    expected: '0000000042',
    sample: 'str_pad(text, width = 10, side = "left", pad = "0")',
    hints: ['Use str_pad() from stringr', 'Specify side and pad character'],
    tags: ['strings', 'stringr', 'pad'],
  },
  {
    id: 'r-str-209',
    category: 'String Operations',
    difficulty: 'hard',
    title: 'String Truncate',
    text: 'Truncate string to 10 characters with ellipsis.',
    setup: 'library(stringr)\ntext <- "This is a very long string"',
    setupCode: 'library(stringr)\ntext <- "This is a very long string"',
    expected: 'This is...',
    sample: 'str_trunc(text, 10)',
    hints: ['Use str_trunc() from stringr', 'Adds ellipsis by default'],
    tags: ['strings', 'stringr', 'truncate'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 21: Additional Statistical Functions (25 problems)
  // ============================================================
  {
    id: 'r-stat-200',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Spearman Correlation',
    text: 'Calculate Spearman rank correlation.',
    setup: 'x <- c(1, 2, 3, 4, 5)\ny <- c(5, 6, 7, 8, 9)',
    setupCode: 'x <- c(1, 2, 3, 4, 5)\ny <- c(5, 6, 7, 8, 9)',
    expected: 1,
    sample: 'cor(x, y, method = "spearman")',
    hints: ['Use method = "spearman"', 'Rank-based correlation'],
    tags: ['statistics', 'cor', 'spearman'],
  },
  {
    id: 'r-stat-201',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Kendall Correlation',
    text: 'Calculate Kendall tau correlation.',
    setup: 'x <- c(1, 2, 3, 4, 5)\ny <- c(2, 3, 1, 5, 4)',
    setupCode: 'x <- c(1, 2, 3, 4, 5)\ny <- c(2, 3, 1, 5, 4)',
    expected: 0.6,
    sample: 'cor(x, y, method = "kendall")',
    hints: ['Use method = "kendall"', 'Based on concordant pairs'],
    tags: ['statistics', 'cor', 'kendall'],
  },
  {
    id: 'r-stat-202',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Confidence Interval',
    text: 'Get 95% confidence interval from t-test.',
    setup: 'data <- c(5, 6, 7, 8, 9)',
    setupCode: 'data <- c(5, 6, 7, 8, 9)',
    expected: 'confidence interval',
    sample: 't.test(data)$conf.int',
    hints: ['Access $conf.int from t.test', 'Returns lower and upper bounds'],
    tags: ['statistics', 't.test', 'confidence'],
  },
  {
    id: 'r-stat-203',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Paired T-Test',
    text: 'Perform paired t-test.',
    setup: 'before <- c(5, 6, 7, 8, 9)\nafter <- c(6, 7, 8, 9, 10)',
    setupCode: 'before <- c(5, 6, 7, 8, 9)\nafter <- c(6, 7, 8, 9, 10)',
    expected: 'htest object',
    sample: 't.test(before, after, paired = TRUE)',
    hints: ['Use paired = TRUE', 'For matched samples'],
    tags: ['statistics', 't.test', 'paired'],
  },
  {
    id: 'r-stat-204',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Wilcoxon Test',
    text: 'Perform non-parametric Wilcoxon signed-rank test.',
    setup: 'data <- c(1, 2, 3, 4, 5)',
    setupCode: 'data <- c(1, 2, 3, 4, 5)',
    expected: 'htest object',
    sample: 'wilcox.test(data, mu = 0)',
    hints: ['Use wilcox.test() function', 'Non-parametric alternative to t-test'],
    tags: ['statistics', 'wilcox.test', 'nonparametric'],
  },
  {
    id: 'r-stat-205',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Shapiro-Wilk Normality Test',
    text: 'Test if data follows normal distribution.',
    setup: 'data <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)',
    setupCode: 'data <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)',
    expected: 'htest object',
    sample: 'shapiro.test(data)',
    hints: ['Use shapiro.test() function', 'p > 0.05 suggests normality'],
    tags: ['statistics', 'shapiro.test', 'normality'],
  },
  {
    id: 'r-stat-206',
    category: 'Statistical Functions',
    difficulty: 'hard',
    title: 'Multiple Regression',
    text: 'Fit multiple linear regression.',
    setup: 'df <- data.frame(y = c(1,2,3,4,5), x1 = c(1,2,1,3,2), x2 = c(2,3,4,5,6))',
    setupCode: 'df <- data.frame(y = c(1,2,3,4,5), x1 = c(1,2,1,3,2), x2 = c(2,3,4,5,6))',
    expected: 'lm object',
    sample: 'lm(y ~ x1 + x2, data = df)',
    hints: ['Use + for multiple predictors', 'formula: y ~ x1 + x2'],
    tags: ['statistics', 'lm', 'multiple'],
  },
  {
    id: 'r-stat-207',
    category: 'Statistical Functions',
    difficulty: 'hard',
    title: 'Interaction Terms',
    text: 'Fit regression with interaction term.',
    setup: 'df <- data.frame(y = 1:5, x1 = c(1,2,1,3,2), x2 = c(2,3,4,5,6))',
    setupCode: 'df <- data.frame(y = 1:5, x1 = c(1,2,1,3,2), x2 = c(2,3,4,5,6))',
    expected: 'lm object',
    sample: 'lm(y ~ x1 * x2, data = df)',
    hints: ['Use * for interaction', 'Includes main effects and interaction'],
    tags: ['statistics', 'lm', 'interaction'],
  },
  {
    id: 'r-stat-208',
    category: 'Statistical Functions',
    difficulty: 'hard',
    title: 'Predict from Model',
    text: 'Make predictions from linear model.',
    setup: 'model <- lm(mpg ~ wt, data = mtcars)\nnew_data <- data.frame(wt = c(3, 4, 5))',
    setupCode: 'model <- lm(mpg ~ wt, data = mtcars)\nnew_data <- data.frame(wt = c(3, 4, 5))',
    expected: 'numeric vector',
    sample: 'predict(model, newdata = new_data)',
    hints: ['Use predict() function', 'newdata must have predictor columns'],
    tags: ['statistics', 'predict', 'lm'],
  },
  {
    id: 'r-stat-209',
    category: 'Statistical Functions',
    difficulty: 'hard',
    title: 'Binomial Test',
    text: 'Test if proportion differs from 0.5.',
    setup: 'successes <- 65\ntrials <- 100',
    setupCode: 'successes <- 65\ntrials <- 100',
    expected: 'htest object',
    sample: 'binom.test(successes, trials, p = 0.5)',
    hints: ['Use binom.test() function', 'Tests binomial proportion'],
    tags: ['statistics', 'binom.test', 'proportion'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 22: Additional ggplot2 (25 problems)
  // ============================================================
  {
    id: 'r-ggplot-200',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Density Plot',
    text: 'Create a density plot of the distribution.',
    setup: 'library(ggplot2)\ndf <- data.frame(value = rnorm(1000))',
    setupCode: 'library(ggplot2)\ndf <- data.frame(value = rnorm(1000))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x = value)) + geom_density()',
    hints: ['Use geom_density()', 'Smooth version of histogram'],
    tags: ['ggplot2', 'geom_density', 'distribution'],
  },
  {
    id: 'r-ggplot-201',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Violin Plot',
    text: 'Create a violin plot by group.',
    setup:
      'library(ggplot2)\ndf <- data.frame(group = rep(c("A", "B"), each = 50), value = rnorm(100))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(group = rep(c("A", "B"), each = 50), value = rnorm(100))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x = group, y = value)) + geom_violin()',
    hints: ['Use geom_violin()', 'Shows distribution shape'],
    tags: ['ggplot2', 'geom_violin', 'distribution'],
  },
  {
    id: 'r-ggplot-202',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Area Plot',
    text: 'Create a stacked area plot.',
    setup:
      'library(ggplot2)\ndf <- data.frame(x = rep(1:5, 2), y = c(1,2,3,2,1,2,3,4,3,2), group = rep(c("A","B"), each=5))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(x = rep(1:5, 2), y = c(1,2,3,2,1,2,3,4,3,2), group = rep(c("A","B"), each=5))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y, fill = group)) + geom_area()',
    hints: ['Use geom_area()', 'fill for stacking colors'],
    tags: ['ggplot2', 'geom_area', 'stacked'],
  },
  {
    id: 'r-ggplot-203',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Error Bars',
    text: 'Add error bars to a bar plot.',
    setup:
      'library(ggplot2)\ndf <- data.frame(group = c("A", "B"), mean = c(10, 15), se = c(1, 2))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(group = c("A", "B"), mean = c(10, 15), se = c(1, 2))',
    expected: 'ggplot object',
    sample:
      'ggplot(df, aes(group, mean)) + geom_bar(stat = "identity") + geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2)',
    hints: ['Use geom_errorbar()', 'Specify ymin and ymax'],
    tags: ['ggplot2', 'geom_errorbar', 'error'],
  },
  {
    id: 'r-ggplot-204',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Text Labels',
    text: 'Add text labels to points.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:3, y = 1:3, label = c("A", "B", "C"))',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = 1:3, y = 1:3, label = c("A", "B", "C"))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y, label = label)) + geom_point() + geom_text()',
    hints: ['Use geom_text()', 'label aesthetic required'],
    tags: ['ggplot2', 'geom_text', 'labels'],
  },
  {
    id: 'r-ggplot-205',
    category: 'ggplot2',
    difficulty: 'hard',
    title: 'Heatmap',
    text: 'Create a heatmap with geom_tile.',
    setup: 'library(ggplot2)\ndf <- expand.grid(x = 1:3, y = 1:3)\ndf$value <- 1:9',
    setupCode: 'library(ggplot2)\ndf <- expand.grid(x = 1:3, y = 1:3)\ndf$value <- 1:9',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y, fill = value)) + geom_tile()',
    hints: ['Use geom_tile()', 'fill controls color'],
    tags: ['ggplot2', 'geom_tile', 'heatmap'],
  },
  {
    id: 'r-ggplot-206',
    category: 'ggplot2',
    difficulty: 'hard',
    title: 'Contour Plot',
    text: 'Create a contour plot of 2D density.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = rnorm(1000), y = rnorm(1000))',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = rnorm(1000), y = rnorm(1000))',
    expected: 'ggplot object',
    sample: 'ggplot(df, aes(x, y)) + geom_density_2d()',
    hints: ['Use geom_density_2d()', 'Shows 2D density contours'],
    tags: ['ggplot2', 'geom_density_2d', 'contour'],
  },
  {
    id: 'r-ggplot-207',
    category: 'ggplot2',
    difficulty: 'hard',
    title: 'Polar Coordinates',
    text: 'Create a pie chart using polar coordinates.',
    setup: 'library(ggplot2)\ndf <- data.frame(category = c("A", "B", "C"), value = c(30, 50, 20))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(category = c("A", "B", "C"), value = c(30, 50, 20))',
    expected: 'ggplot object',
    sample:
      'ggplot(df, aes(x = "", y = value, fill = category)) + geom_bar(stat = "identity") + coord_polar("y")',
    hints: ['Use coord_polar("y")', 'Start with bar chart'],
    tags: ['ggplot2', 'coord_polar', 'pie'],
  },
  {
    id: 'r-ggplot-208',
    category: 'ggplot2',
    difficulty: 'hard',
    title: 'Secondary Y-Axis',
    text: 'Add a secondary y-axis with different scale.',
    setup:
      'library(ggplot2)\ndf <- data.frame(x = 1:5, y1 = c(1,2,3,4,5), y2 = c(100,200,300,400,500))',
    setupCode:
      'library(ggplot2)\ndf <- data.frame(x = 1:5, y1 = c(1,2,3,4,5), y2 = c(100,200,300,400,500))',
    expected: 'ggplot object',
    sample:
      'ggplot(df, aes(x)) + geom_line(aes(y = y1)) + geom_line(aes(y = y2/100), color = "red") + scale_y_continuous(sec.axis = sec_axis(~.*100))',
    hints: ['Use sec_axis in scale_y_continuous', 'Transform data to match'],
    tags: ['ggplot2', 'sec_axis', 'dual'],
  },
  {
    id: 'r-ggplot-209',
    category: 'ggplot2',
    difficulty: 'hard',
    title: 'Annotation Layer',
    text: 'Add rectangle annotation to highlight region.',
    setup: 'library(ggplot2)\ndf <- data.frame(x = 1:10, y = 1:10)',
    setupCode: 'library(ggplot2)\ndf <- data.frame(x = 1:10, y = 1:10)',
    expected: 'ggplot object',
    sample:
      'ggplot(df, aes(x, y)) + geom_point() + annotate("rect", xmin = 3, xmax = 7, ymin = 3, ymax = 7, alpha = 0.2)',
    hints: ['Use annotate() function', 'Specify geometry type and coordinates'],
    tags: ['ggplot2', 'annotate', 'highlight'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 23: Additional Apply Functions (20 problems)
  // ============================================================
  {
    id: 'r-apply-200',
    category: 'Apply Functions',
    difficulty: 'medium',
    title: 'Apply with Anonymous Function',
    text: 'Calculate coefficient of variation for each column.',
    setup: 'df <- data.frame(a = c(1, 2, 3), b = c(10, 20, 30))',
    setupCode: 'df <- data.frame(a = c(1, 2, 3), b = c(10, 20, 30))',
    expected: { a: 0.5, b: 0.5 },
    sample: 'sapply(df, function(x) sd(x) / mean(x))',
    hints: ['CV = sd / mean', 'Use anonymous function'],
    tags: ['apply', 'sapply', 'cv'],
  },
  {
    id: 'r-apply-201',
    category: 'Apply Functions',
    difficulty: 'medium',
    title: 'Apply with Simplify False',
    text: 'Keep list output from sapply.',
    setup: 'data <- list(a = 1:3, b = 1:5)',
    setupCode: 'data <- list(a = 1:3, b = 1:5)',
    expected: { a: [1, 2, 3], b: [1, 2, 3, 4, 5] },
    sample: 'sapply(data, identity, simplify = FALSE)',
    hints: ['Use simplify = FALSE', 'Prevents vector conversion'],
    tags: ['apply', 'sapply', 'simplify'],
  },
  {
    id: 'r-apply-202',
    category: 'Apply Functions',
    difficulty: 'hard',
    title: 'Apply with Error Handling',
    text: 'Apply function that may fail, returning NA on error.',
    setup: 'values <- list(4, -1, 9, "a")',
    setupCode: 'values <- list(4, -1, 9, "a")',
    expected: [2, null, 3, null],
    sample:
      'sapply(values, function(x) tryCatch(sqrt(x), error = function(e) NA, warning = function(w) NA))',
    hints: ['Wrap in tryCatch', 'Handle both errors and warnings'],
    tags: ['apply', 'tryCatch', 'error'],
  },
  {
    id: 'r-apply-203',
    category: 'Apply Functions',
    difficulty: 'hard',
    title: 'Apply to Matrix Margins',
    text: 'Apply function to both rows and columns.',
    setup: 'mat <- matrix(1:6, nrow = 2)',
    setupCode: 'mat <- matrix(1:6, nrow = 2)',
    expected: { rows: [9, 12], cols: [3, 7, 11] },
    sample: 'list(rows = apply(mat, 1, sum), cols = apply(mat, 2, sum))',
    hints: ['MARGIN 1 for rows, 2 for columns', 'Can apply to both'],
    tags: ['apply', 'matrix', 'margins'],
  },
  {
    id: 'r-apply-204',
    category: 'Apply Functions',
    difficulty: 'hard',
    title: 'eapply for Environments',
    text: 'Apply function to all variables in environment.',
    setup: 'env <- new.env()\nenv$a <- 1\nenv$b <- 2\nenv$c <- 3',
    setupCode: 'env <- new.env()\nenv$a <- 1\nenv$b <- 2\nenv$c <- 3',
    expected: { a: 2, b: 4, c: 6 },
    sample: 'eapply(env, function(x) x * 2)',
    hints: ['Use eapply() for environments', 'Works like lapply on env'],
    tags: ['apply', 'eapply', 'environment'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 24: Additional Matrix Operations (20 problems)
  // ============================================================
  {
    id: 'r-mat-200',
    category: 'Matrix Operations',
    difficulty: 'medium',
    title: 'Matrix Crossprod',
    text: 'Calculate t(A) %*% A efficiently.',
    setup: 'A <- matrix(1:6, nrow = 3)',
    setupCode: 'A <- matrix(1:6, nrow = 3)',
    expected: [
      [14, 32],
      [32, 77],
    ],
    sample: 'crossprod(A)',
    hints: ['Use crossprod() function', 'More efficient than t(A) %*% A'],
    tags: ['matrix', 'crossprod', 'efficient'],
  },
  {
    id: 'r-mat-201',
    category: 'Matrix Operations',
    difficulty: 'medium',
    title: 'Outer Product',
    text: 'Calculate outer product of two vectors.',
    setup: 'a <- c(1, 2, 3)\nb <- c(4, 5)',
    setupCode: 'a <- c(1, 2, 3)\nb <- c(4, 5)',
    expected: [
      [4, 5],
      [8, 10],
      [12, 15],
    ],
    sample: 'outer(a, b)',
    hints: ['Use outer() function', 'Creates matrix of all products'],
    tags: ['matrix', 'outer', 'product'],
  },
  {
    id: 'r-mat-202',
    category: 'Matrix Operations',
    difficulty: 'hard',
    title: 'Eigenvalues',
    text: 'Calculate eigenvalues of a matrix.',
    setup: 'mat <- matrix(c(4, 1, 2, 3), nrow = 2)',
    setupCode: 'mat <- matrix(c(4, 1, 2, 3), nrow = 2)',
    expected: 'eigenvalues',
    sample: 'eigen(mat)$values',
    hints: ['Use eigen() function', 'Access $values for eigenvalues'],
    tags: ['matrix', 'eigen', 'values'],
  },
  {
    id: 'r-mat-203',
    category: 'Matrix Operations',
    difficulty: 'hard',
    title: 'Singular Value Decomposition',
    text: 'Perform SVD on a matrix.',
    setup: 'mat <- matrix(1:6, nrow = 2)',
    setupCode: 'mat <- matrix(1:6, nrow = 2)',
    expected: 'svd object',
    sample: 'svd(mat)',
    hints: ['Use svd() function', 'Returns d, u, v components'],
    tags: ['matrix', 'svd', 'decomposition'],
  },
  {
    id: 'r-mat-204',
    category: 'Matrix Operations',
    difficulty: 'hard',
    title: 'QR Decomposition',
    text: 'Perform QR decomposition.',
    setup: 'mat <- matrix(c(1, 2, 3, 4), nrow = 2)',
    setupCode: 'mat <- matrix(c(1, 2, 3, 4), nrow = 2)',
    expected: 'qr object',
    sample: 'qr(mat)',
    hints: ['Use qr() function', 'Returns Q and R factors'],
    tags: ['matrix', 'qr', 'decomposition'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 25: Additional purrr (20 problems)
  // ============================================================
  {
    id: 'r-purrr-200',
    category: 'purrr',
    difficulty: 'medium',
    title: 'Map with Index',
    text: 'Map over elements with their indices.',
    setup: 'library(purrr)\nletters_list <- list("a", "b", "c")',
    setupCode: 'library(purrr)\nletters_list <- list("a", "b", "c")',
    expected: ['1: a', '2: b', '3: c'],
    sample: 'imap_chr(letters_list, ~ paste(.y, .x, sep = ": "))',
    hints: ['Use imap_chr() for indexed map', '.y is the index/name'],
    tags: ['purrr', 'imap', 'index'],
  },
  {
    id: 'r-purrr-201',
    category: 'purrr',
    difficulty: 'medium',
    title: 'Modify Elements',
    text: 'Double only numeric elements in list.',
    setup: 'library(purrr)\ndata <- list(a = 1, b = "text", c = 3)',
    setupCode: 'library(purrr)\ndata <- list(a = 1, b = "text", c = 3)',
    expected: { a: 2, b: 'text', c: 6 },
    sample: 'modify_if(data, is.numeric, ~ .x * 2)',
    hints: ['Use modify_if()', 'Only modifies matching elements'],
    tags: ['purrr', 'modify_if', 'conditional'],
  },
  {
    id: 'r-purrr-202',
    category: 'purrr',
    difficulty: 'medium',
    title: 'Flatten List',
    text: 'Flatten nested list to single level.',
    setup: 'library(purrr)\nnested <- list(list(1, 2), list(3, 4))',
    setupCode: 'library(purrr)\nnested <- list(list(1, 2), list(3, 4))',
    expected: [[1], [2], [3], [4]],
    sample: 'flatten(nested)',
    hints: ['Use flatten() from purrr', 'Removes one level of nesting'],
    tags: ['purrr', 'flatten', 'nested'],
  },
  {
    id: 'r-purrr-203',
    category: 'purrr',
    difficulty: 'hard',
    title: 'Compose Functions',
    text: 'Create a composed function that squares then adds 1.',
    setup: 'library(purrr)\nsquare <- function(x) x^2\nadd_one <- function(x) x + 1',
    setupCode: 'library(purrr)\nsquare <- function(x) x^2\nadd_one <- function(x) x + 1',
    expected: 10,
    sample: 'composed <- compose(add_one, square); composed(3)',
    hints: ['Use compose() from purrr', 'Functions applied right to left'],
    tags: ['purrr', 'compose', 'functional'],
  },
  {
    id: 'r-purrr-204',
    category: 'purrr',
    difficulty: 'hard',
    title: 'Partial Application',
    text: 'Create function with pre-filled argument.',
    setup: 'library(purrr)\nmultiply <- function(x, y) x * y',
    setupCode: 'library(purrr)\nmultiply <- function(x, y) x * y',
    expected: 15,
    sample: 'times_three <- partial(multiply, y = 3); times_three(5)',
    hints: ['Use partial() from purrr', 'Pre-fills specified arguments'],
    tags: ['purrr', 'partial', 'functional'],
  },
  {
    id: 'r-purrr-205',
    category: 'purrr',
    difficulty: 'hard',
    title: 'Reduce with Init',
    text: 'Reduce with initial value.',
    setup: 'library(purrr)\nnums <- list(1, 2, 3)',
    setupCode: 'library(purrr)\nnums <- list(1, 2, 3)',
    expected: 106,
    sample: 'reduce(nums, `+`, .init = 100)',
    hints: ['Use .init argument', 'Starts reduction with initial value'],
    tags: ['purrr', 'reduce', 'init'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 26: Additional Date/Time (20 problems)
  // ============================================================
  {
    id: 'r-date-200',
    category: 'Date/Time',
    difficulty: 'medium',
    title: 'Get Quarter',
    text: 'Extract the quarter from a date.',
    setup: 'date <- as.Date("2023-08-15")',
    setupCode: 'date <- as.Date("2023-08-15")',
    expected: 3,
    sample: 'as.numeric(format(date, "%q"))',
    hints: ['Use format with %q', 'Or use quarters() function'],
    tags: ['date', 'quarter', 'extract'],
  },
  {
    id: 'r-date-201',
    category: 'Date/Time',
    difficulty: 'medium',
    title: 'Week of Year',
    text: 'Get the week number of the year.',
    setup: 'date <- as.Date("2023-03-15")',
    setupCode: 'date <- as.Date("2023-03-15")',
    expected: 11,
    sample: 'as.numeric(format(date, "%V"))',
    hints: ['Use format with %V', 'ISO week number'],
    tags: ['date', 'week', 'extract'],
  },
  {
    id: 'r-date-202',
    category: 'Date/Time',
    difficulty: 'medium',
    title: 'Day of Year',
    text: 'Get the day number of the year (1-365).',
    setup: 'date <- as.Date("2023-03-01")',
    setupCode: 'date <- as.Date("2023-03-01")',
    expected: 60,
    sample: 'as.numeric(format(date, "%j"))',
    hints: ['Use format with %j', 'Returns day of year'],
    tags: ['date', 'day', 'extract'],
  },
  {
    id: 'r-date-203',
    category: 'Date/Time',
    difficulty: 'hard',
    title: 'Add Months',
    text: 'Add 3 months to the date.',
    setup: 'date <- as.Date("2023-01-31")',
    setupCode: 'date <- as.Date("2023-01-31")',
    expected: 'date object',
    sample: 'seq(date, by = "3 months", length.out = 2)[2]',
    hints: ['Use seq with month increment', 'Or use lubridate'],
    tags: ['date', 'arithmetic', 'months'],
  },
  {
    id: 'r-date-204',
    category: 'Date/Time',
    difficulty: 'hard',
    title: 'Business Days Between',
    text: 'Calculate business days between two dates (excluding weekends).',
    setup: 'start <- as.Date("2023-01-01")\nend <- as.Date("2023-01-10")',
    setupCode: 'start <- as.Date("2023-01-01")\nend <- as.Date("2023-01-10")',
    expected: 6,
    sample: 'sum(!weekdays(seq(start, end, by = "day")) %in% c("Saturday", "Sunday"))',
    hints: ['Generate date sequence', 'Filter out weekends'],
    tags: ['date', 'business', 'weekdays'],
  },
  {
    id: 'r-date-205',
    category: 'Date/Time',
    difficulty: 'hard',
    title: 'First Day of Month',
    text: 'Get the first day of the month for a date.',
    setup: 'date <- as.Date("2023-06-15")',
    setupCode: 'date <- as.Date("2023-06-15")',
    expected: '2023-06-01',
    sample: 'as.Date(paste0(format(date, "%Y-%m"), "-01"))',
    hints: ['Extract year-month and append 01', 'Or use lubridate floor_date'],
    tags: ['date', 'first', 'month'],
  },
  {
    id: 'r-date-206',
    category: 'Date/Time',
    difficulty: 'hard',
    title: 'Last Day of Month',
    text: 'Get the last day of the month.',
    setup: 'date <- as.Date("2023-02-15")',
    setupCode: 'date <- as.Date("2023-02-15")',
    expected: '2023-02-28',
    sample: 'as.Date(paste0(format(date, "%Y-%m"), "-01")) + months(1) - 1',
    hints: ['Go to first of next month minus 1', 'Handles varying month lengths'],
    tags: ['date', 'last', 'month'],
  },

  // ============================================================
  // NEW PROBLEMS - BATCH 27: Final Batch - Mixed Topics (30 problems)
  // ============================================================
  {
    id: 'r-misc-100',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Sample Without Replacement',
    text: 'Randomly sample 3 elements from the vector.',
    setup: 'set.seed(42)\nx <- 1:10',
    setupCode: 'set.seed(42)\nx <- 1:10',
    expected: [1, 5, 10],
    sample: 'sample(x, 3)',
    hints: ['Use sample() function', 'Default is without replacement'],
    tags: ['vectors', 'sample', 'random'],
  },
  {
    id: 'r-misc-101',
    category: 'Vector Operations',
    difficulty: 'medium',
    title: 'Sample With Replacement',
    text: 'Sample 5 elements allowing repeats.',
    setup: 'set.seed(42)\nx <- 1:3',
    setupCode: 'set.seed(42)\nx <- 1:3',
    expected: [1, 1, 3, 2, 3],
    sample: 'sample(x, 5, replace = TRUE)',
    hints: ['Use replace = TRUE', 'Allows same element multiple times'],
    tags: ['vectors', 'sample', 'replacement'],
  },
  {
    id: 'r-misc-102',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Random Rows Sample',
    text: 'Sample 2 random rows from the data frame.',
    setup: 'set.seed(42)\ndf <- data.frame(x = 1:5, y = letters[1:5])',
    setupCode: 'set.seed(42)\ndf <- data.frame(x = 1:5, y = letters[1:5])',
    expected: { x: [1, 5], y: ['a', 'e'] },
    sample: 'df[sample(nrow(df), 2), ]',
    hints: ['Sample row indices', 'Use in row subscript'],
    tags: ['dataframes', 'sample', 'rows'],
  },
  {
    id: 'r-misc-103',
    category: 'Statistical Functions',
    difficulty: 'easy',
    title: 'Generate Random Normal',
    text: 'Generate 5 random numbers from N(mean=10, sd=2).',
    setup: 'set.seed(42)',
    setupCode: 'set.seed(42)',
    expected: 'numeric vector',
    sample: 'rnorm(5, mean = 10, sd = 2)',
    hints: ['Use rnorm() function', 'Specify mean and sd'],
    tags: ['statistics', 'rnorm', 'random'],
  },
  {
    id: 'r-misc-104',
    category: 'Statistical Functions',
    difficulty: 'easy',
    title: 'Generate Random Uniform',
    text: 'Generate 5 random numbers between 0 and 1.',
    setup: 'set.seed(42)',
    setupCode: 'set.seed(42)',
    expected: 'numeric vector',
    sample: 'runif(5)',
    hints: ['Use runif() function', 'Default is 0 to 1'],
    tags: ['statistics', 'runif', 'random'],
  },
  {
    id: 'r-misc-105',
    category: 'Control Flow',
    difficulty: 'easy',
    title: 'Any True Check',
    text: 'Check if any element is greater than 10.',
    setup: 'x <- c(3, 5, 8, 12, 6)',
    setupCode: 'x <- c(3, 5, 8, 12, 6)',
    expected: true,
    sample: 'any(x > 10)',
    hints: ['Use any() function', 'Returns TRUE if any match'],
    tags: ['control', 'any', 'logical'],
  },
  {
    id: 'r-misc-106',
    category: 'Control Flow',
    difficulty: 'easy',
    title: 'All True Check',
    text: 'Check if all elements are positive.',
    setup: 'x <- c(1, 2, 3, -1, 5)',
    setupCode: 'x <- c(1, 2, 3, -1, 5)',
    expected: false,
    sample: 'all(x > 0)',
    hints: ['Use all() function', 'Returns TRUE only if all match'],
    tags: ['control', 'all', 'logical'],
  },
  {
    id: 'r-misc-107',
    category: 'String Operations',
    difficulty: 'medium',
    title: 'String Interpolation with glue',
    text: 'Create string with variable interpolation.',
    setup: 'library(glue)\nname <- "Alice"\nage <- 30',
    setupCode: 'library(glue)\nname <- "Alice"\nage <- 30',
    expected: 'Alice is 30 years old',
    sample: 'glue("{name} is {age} years old")',
    hints: ['Use glue() from glue package', 'Variables in curly braces'],
    tags: ['strings', 'glue', 'interpolation'],
  },
  {
    id: 'r-misc-108',
    category: 'Data Frame Operations',
    difficulty: 'hard',
    title: 'Reshape Long to Wide',
    text: 'Convert long format data to wide format.',
    setup: 'df <- data.frame(id = c(1,1,2,2), var = c("a","b","a","b"), val = 1:4)',
    setupCode: 'df <- data.frame(id = c(1,1,2,2), var = c("a","b","a","b"), val = 1:4)',
    expected: { id: [1, 2], a: [1, 3], b: [2, 4] },
    sample: 'reshape(df, idvar = "id", timevar = "var", direction = "wide")',
    hints: ['Use reshape() function', 'Or tidyr::pivot_wider'],
    tags: ['dataframes', 'reshape', 'wide'],
  },
  {
    id: 'r-misc-109',
    category: 'List Operations',
    difficulty: 'medium',
    title: 'Split Vector by Factor',
    text: 'Split vector into groups by factor.',
    setup: 'values <- 1:6\ngroups <- factor(c("A","A","B","B","C","C"))',
    setupCode: 'values <- 1:6\ngroups <- factor(c("A","A","B","B","C","C"))',
    expected: { A: [1, 2], B: [3, 4], C: [5, 6] },
    sample: 'split(values, groups)',
    hints: ['Use split() function', 'Returns list by group'],
    tags: ['lists', 'split', 'grouping'],
  },
  {
    id: 'r-misc-110',
    category: 'Vector Operations',
    difficulty: 'hard',
    title: 'Running Window Calculation',
    text: 'Calculate 3-element rolling sum.',
    setup: 'x <- c(1, 2, 3, 4, 5, 6)',
    setupCode: 'x <- c(1, 2, 3, 4, 5, 6)',
    expected: [6, 9, 12, 15],
    sample: 'sapply(1:(length(x)-2), function(i) sum(x[i:(i+2)]))',
    hints: ['Use sliding window approach', 'Apply sum to each window'],
    tags: ['vectors', 'rolling', 'window'],
  },
  {
    id: 'r-misc-111',
    category: 'Statistical Functions',
    difficulty: 'medium',
    title: 'Scale and Center',
    text: 'Standardize the vector (z-score normalization).',
    setup: 'x <- c(10, 20, 30, 40, 50)',
    setupCode: 'x <- c(10, 20, 30, 40, 50)',
    expected: 'scaled vector',
    sample: 'scale(x)',
    hints: ['Use scale() function', 'Centers and scales'],
    tags: ['statistics', 'scale', 'normalize'],
  },
  {
    id: 'r-misc-112',
    category: 'Control Flow',
    difficulty: 'medium',
    title: 'Stopifnot Assertion',
    text: 'Assert that all values are positive.',
    setup: 'x <- c(1, 2, 3, 4, 5)',
    setupCode: 'x <- c(1, 2, 3, 4, 5)',
    expected: null,
    sample: 'stopifnot(all(x > 0))',
    hints: ['Use stopifnot() for assertions', 'Stops if condition is FALSE'],
    tags: ['control', 'stopifnot', 'assertion'],
  },
  {
    id: 'r-misc-113',
    category: 'Data Frame Operations',
    difficulty: 'easy',
    title: 'Check Column Types',
    text: 'Get the class of each column.',
    setup: 'df <- data.frame(a = 1:3, b = c("x","y","z"), c = c(TRUE, FALSE, TRUE))',
    setupCode: 'df <- data.frame(a = 1:3, b = c("x","y","z"), c = c(TRUE, FALSE, TRUE))',
    expected: { a: 'integer', b: 'character', c: 'logical' },
    sample: 'sapply(df, class)',
    hints: ['Use sapply with class', 'Returns class of each column'],
    tags: ['dataframes', 'class', 'types'],
  },
  {
    id: 'r-misc-114',
    category: 'File I/O',
    difficulty: 'medium',
    title: 'Get Working Directory',
    text: 'Get the current working directory.',
    setup: '# Get current directory',
    setupCode: '# Get current directory',
    expected: 'directory path',
    sample: 'getwd()',
    hints: ['Use getwd() function', 'Returns current path'],
    tags: ['fileio', 'getwd', 'directory'],
  },
  {
    id: 'r-misc-115',
    category: 'File I/O',
    difficulty: 'medium',
    title: 'Create Directory',
    text: 'Create a new directory if it does not exist.',
    setup: 'dir_name <- "new_folder"',
    setupCode: 'dir_name <- "new_folder"',
    expected: true,
    sample: 'dir.create(dir_name, showWarnings = FALSE)',
    hints: ['Use dir.create() function', 'showWarnings = FALSE suppresses existing dir warning'],
    tags: ['fileio', 'dir.create', 'directory'],
  },
  {
    id: 'r-misc-116',
    category: 'Vector Operations',
    difficulty: 'easy',
    title: 'Check Empty Vector',
    text: 'Check if the vector has length zero.',
    setup: 'x <- c()',
    setupCode: 'x <- c()',
    expected: true,
    sample: 'length(x) == 0',
    hints: ['Check length equals zero', 'Or use identical(x, c())'],
    tags: ['vectors', 'empty', 'check'],
  },
  {
    id: 'r-misc-117',
    category: 'Statistical Functions',
    difficulty: 'hard',
    title: 'Bootstrap Mean',
    text: 'Calculate bootstrap mean estimate (1000 samples).',
    setup: 'set.seed(42)\ndata <- c(5, 6, 7, 8, 9)',
    setupCode: 'set.seed(42)\ndata <- c(5, 6, 7, 8, 9)',
    expected: 7,
    sample: 'mean(replicate(1000, mean(sample(data, replace = TRUE))))',
    hints: ['Use replicate for bootstrap', 'Sample with replacement'],
    tags: ['statistics', 'bootstrap', 'mean'],
  },
  {
    id: 'r-misc-118',
    category: 'ggplot2',
    difficulty: 'medium',
    title: 'Save Plot',
    text: 'Save a ggplot to a PNG file.',
    setup: 'library(ggplot2)\np <- ggplot(data.frame(x=1:5, y=1:5), aes(x,y)) + geom_point()',
    setupCode: 'library(ggplot2)\np <- ggplot(data.frame(x=1:5, y=1:5), aes(x,y)) + geom_point()',
    expected: null,
    sample: 'ggsave("plot.png", p, width = 6, height = 4)',
    hints: ['Use ggsave() function', 'Specify filename and dimensions'],
    tags: ['ggplot2', 'ggsave', 'export'],
  },
  {
    id: 'r-misc-119',
    category: 'dplyr Verbs',
    difficulty: 'easy',
    title: 'Glimpse Data',
    text: 'Get a quick overview of the data frame structure.',
    setup: 'library(dplyr)\ndf <- data.frame(a = 1:3, b = c("x","y","z"))',
    setupCode: 'library(dplyr)\ndf <- data.frame(a = 1:3, b = c("x","y","z"))',
    expected: 'structure output',
    sample: 'glimpse(df)',
    hints: ['Use glimpse() from dplyr', 'Transposed view of data'],
    tags: ['dplyr', 'glimpse', 'structure'],
  },
  {
    id: 'r-misc-120',
    category: 'Data Frame Operations',
    difficulty: 'medium',
    title: 'Column to Row Names',
    text: 'Set a column as row names.',
    setup: 'df <- data.frame(id = c("A", "B", "C"), value = 1:3)',
    setupCode: 'df <- data.frame(id = c("A", "B", "C"), value = 1:3)',
    expected: { value: [1, 2, 3] },
    sample: 'rownames(df) <- df$id; df$id <- NULL; df',
    hints: ['Assign to rownames()', 'Remove original column'],
    tags: ['dataframes', 'rownames', 'index'],
  },

  // ========================================
  // BEGINNER FUNDAMENTALS
  // ========================================
  {
    id: 'r-beginner-loop-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Sum Numbers with For Loop',
    text: 'Use a for loop to sum all numbers from 1 to 10.',
    setup: '',
    setupCode: '',
    expected: 55,
    sample: 'total <- 0; for (i in 1:10) { total <- total + i }; total',
    hints: ['Initialize total to 0', 'Use 1:10 for sequence', 'Add each i to total'],
    tags: ['beginner', 'for-loop', 'sum'],
  },
  {
    id: 'r-beginner-loop-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Count Even Numbers',
    text: 'Use a for loop to count how many even numbers are between 1 and 20.',
    setup: '',
    setupCode: '',
    expected: 10,
    sample: 'count <- 0; for (i in 1:20) { if (i %% 2 == 0) count <- count + 1 }; count',
    hints: ['Initialize count to 0', 'Use %% for modulo', 'Even numbers: i %% 2 == 0'],
    tags: ['beginner', 'for-loop', 'conditionals'],
  },
  {
    id: 'r-beginner-loop-003',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Build a String with Loop',
    text: 'Use a for loop to build a string "123456789" by concatenating numbers 1 through 9.',
    setup: '',
    setupCode: '',
    expected: '123456789',
    sample: 's <- ""; for (i in 1:9) { s <- paste0(s, i) }; s',
    hints: ['Start with empty string', 'Use paste0() for concatenation', 'paste0 has no separator'],
    tags: ['beginner', 'for-loop', 'strings'],
  },
  {
    id: 'r-beginner-cond-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Check Positive or Negative',
    text: 'Use if/else to return "positive" if number is greater than 0, "negative" if less than 0, or "zero".',
    setup: 'number <- 5',
    setupCode: 'number <- 5',
    expected: 'positive',
    sample: 'if (number > 0) { "positive" } else if (number < 0) { "negative" } else { "zero" }',
    hints: ['Use if/else if/else chain', 'Check > 0 first', 'Use curly braces for blocks'],
    tags: ['beginner', 'if-else', 'conditionals'],
  },
  {
    id: 'r-beginner-cond-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Find Maximum of Two',
    text: 'Use if/else to return the larger of two numbers.',
    setup: 'a <- 15; b <- 8',
    setupCode: 'a <- 15; b <- 8',
    expected: 15,
    sample: 'if (a > b) a else b',
    hints: ['Compare a and b', 'Return larger value', 'Or use max(a, b)'],
    tags: ['beginner', 'if-else', 'comparison'],
  },
  {
    id: 'r-beginner-cond-003',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Grade Calculator',
    text: 'Return letter grade: A for score >= 90, B for >= 80, C for >= 70, D for >= 60, F otherwise.',
    setup: 'score <- 85',
    setupCode: 'score <- 85',
    expected: 'B',
    sample:
      'if (score >= 90) "A" else if (score >= 80) "B" else if (score >= 70) "C" else if (score >= 60) "D" else "F"',
    hints: ['Check from highest to lowest', 'Use if/else if chain', 'Return grade letter'],
    tags: ['beginner', 'if-else', 'grades'],
  },
  {
    id: 'r-beginner-vector-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Create and Sum Vector',
    text: 'Create a vector with values 1, 2, 3, 4, 5 and sum all elements.',
    setup: '',
    setupCode: '',
    expected: 15,
    sample: 'sum(c(1, 2, 3, 4, 5))',
    hints: ['Use c() to create vector', 'Use sum() to add elements', 'Or use 1:5 shorthand'],
    tags: ['beginner', 'vector', 'sum'],
  },
  {
    id: 'r-beginner-vector-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Append and Get Length',
    text: 'Create vector c(10, 20), append 30, and return its length.',
    setup: '',
    setupCode: '',
    expected: 3,
    sample: 'v <- c(10, 20); v <- c(v, 30); length(v)',
    hints: ['Use c() to append', 'Reassign to same variable', 'Use length() for size'],
    tags: ['beginner', 'vector', 'append', 'length'],
  },
  {
    id: 'r-beginner-list-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Create and Access List',
    text: 'Create a named list with apple=3 and return the value for "apple".',
    setup: '',
    setupCode: '',
    expected: 3,
    sample: 'lst <- list(apple = 3); lst$apple',
    hints: ['Use list() with named elements', 'Access with $ operator', 'Or use lst[["apple"]]'],
    tags: ['beginner', 'list', 'access'],
  },
  {
    id: 'r-beginner-list-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Count List Elements',
    text: 'Create a list with 3 named fruit entries and return its length.',
    setup: '',
    setupCode: '',
    expected: 3,
    sample: 'lst <- list(apple = 1, banana = 2, cherry = 3); length(lst)',
    hints: [
      'Create list with multiple items',
      'Use length() for count',
      'Each name=value is one element',
    ],
    tags: ['beginner', 'list', 'length'],
  },
  {
    id: 'r-beginner-string-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'String Concatenation with paste',
    text: 'Use paste() to concatenate "Hello" and "World" with a space separator.',
    setup: '',
    setupCode: '',
    expected: 'Hello World',
    sample: 'paste("Hello", "World")',
    hints: [
      'paste() joins strings with space by default',
      'Use sep="" for no separator',
      'paste0() has no separator by default',
    ],
    tags: ['beginner', 'string', 'paste', 'concatenation'],
  },
  {
    id: 'r-beginner-string-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'String Length with nchar',
    text: 'Return the number of characters in the string "R language".',
    setup: '',
    setupCode: '',
    expected: 10,
    sample: 'nchar("R language")',
    hints: [
      'Use nchar() for character count',
      'Includes spaces in count',
      'length() counts vector elements, not chars',
    ],
    tags: ['beginner', 'string', 'nchar', 'length'],
  },
  {
    id: 'r-beginner-while-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Basic While Loop',
    text: 'Use a while loop to sum numbers from 1 to 5 and return the total.',
    setup: '',
    setupCode: '',
    expected: 15,
    sample: 'sum <- 0; i <- 1; while (i <= 5) { sum <- sum + i; i <- i + 1 }; sum',
    hints: ['Use <- for assignment', 'while (condition) { body }', 'Increment counter inside loop'],
    tags: ['beginner', 'while', 'loop', 'sum'],
  },
  {
    id: 'r-beginner-vector-adv-001',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Vector Max',
    text: 'Find the maximum value in c(3, 7, 2, 9, 4).',
    setup: '',
    setupCode: '',
    expected: 9,
    sample: 'max(c(3, 7, 2, 9, 4))',
    hints: ['Use max() function', 'Works on vectors directly', 'min() finds minimum'],
    tags: ['beginner', 'vector', 'max'],
  },
  {
    id: 'r-beginner-vector-adv-002',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Find Index with which',
    text: 'Find the index of the first element greater than 5 in c(2, 4, 6, 8, 10).',
    setup: '',
    setupCode: '',
    expected: 3,
    sample: 'which(c(2, 4, 6, 8, 10) > 5)[1]',
    hints: [
      'which() returns indices where TRUE',
      'Returns vector of all matches',
      '[1] gets first match',
    ],
    tags: ['beginner', 'vector', 'which', 'index'],
  },
  {
    id: 'r-beginner-vector-adv-003',
    category: 'Beginner Fundamentals',
    difficulty: 'easy',
    title: 'Check Element with %in%',
    text: 'Check if 30 is in the vector c(10, 20, 30, 40).',
    setup: '',
    setupCode: '',
    expected: true,
    sample: '30 %in% c(10, 20, 30, 40)',
    hints: ['Use %in% operator', 'Returns TRUE or FALSE', 'Value on left, vector on right'],
    tags: ['beginner', 'vector', 'in', 'membership'],
  },
];
